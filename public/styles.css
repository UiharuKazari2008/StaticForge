/* CSS Variables for Design System */
:root {
    /* Primary Colors */
    --primary-color: #ff4500;
    --primary-color-light: #ff6347;
    --primary-color-dark: #e63900;
    --primary-gradient: linear-gradient(45deg, #ff4500, #ff6347);
    --primary-glass-color: #c33500b8;
    --primary-glass-border: rgb(209 77 28 / 58%);
    
    /* Secondary Colors */
    --secondary-color: #6c757d;
    --secondary-color-light: #5a6268;
    --secondary-color-dark: #495057;
    --secondary-gradient: linear-gradient(45deg, #6c757d, #5a6268);
    
    /* Background Colors */
    --bg-primary: #000000;
    --bg-secondary: #1a1a1a;
    --bg-tertiary: #2a2a2a;
    --bg-quaternary: #333333;
    --bg-overlay: rgba(0, 0, 0, 0.9);
    --bg-toolbar: rgba(0, 0, 0, 0.5);
    --bg-modal: rgba(26, 26, 26, 0.95);
    
    /* Text Colors */
    --text-primary: #ffffff;
    --text-secondary: #cccccc;
    --text-muted: #888888;
    --text-accent: #ff4500;
    
    /* Border Colors */
    --border-primary: #ff4500;
    --border-secondary: #444444;
    --border-tertiary: #555555;
    --border-light: rgba(255, 255, 255, 0.2);
    
    /* Status Colors */
    --success-color: #28a745;
    --success-color-light: #20c997;
    --success-gradient: linear-gradient(45deg, #28a745, #20c997);
    
    --danger-color: #dc3545;
    --danger-color-light: #c82333;
    --danger-gradient: linear-gradient(45deg, #dc3545, #c82333);
    
    --warning-color: #ffc107;
    --warning-color-light: #e0a800;
    --warning-gradient: linear-gradient(45deg, #ffc107, #e0a800);
    
    --info-color: #17a2b8;
    --info-color-light: #20c997;
    --info-gradient: linear-gradient(45deg, #17a2b8, #20c997);
    
    /* Special Colors */
    --variety-color: #8500ff;
    --variety-color-light: #4755ff;
    --variety-gradient: linear-gradient(45deg, #8500ff, #4755ff);
    
    --balance-color: #28a745;
    --balance-color-light: #20c997;
    --balance-gradient: linear-gradient(45deg, #28a745, #20c997);
    
    --price-color: #ffb84f;
    --price-color-free: #4caf50;
    
    /* Shadow Colors */
    --shadow-primary: rgba(255, 69, 0, 0.3);
    --shadow-secondary: rgba(0, 0, 0, 0.3);
    --shadow-danger: rgba(220, 53, 69, 0.3);
    --shadow-success: rgba(40, 167, 69, 0.3);
    --shadow-info: rgba(23, 162, 184, 0.3);
    --shadow-variety: rgba(27, 0, 255, 0.53);
    
    /* Spacing */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 12px;
    --spacing-lg: 16px;
    --spacing-xl: 20px;
    --spacing-xxl: 30px;
    
    /* Border Radius */
    --border-radius-sm: 2px;
    --border-radius-md: 3px;
    --border-radius-lg: 6px;
    --border-radius-xl: 8px;
    --border-radius-xxl: 12px;
    
    /* Transitions */
    --transition-fast: 0.2s ease;
    --transition-normal: 0.3s ease;
    --transition-slow: 0.5s ease;
    
    /* Z-index layers */
    --z-dropdown: 1000;
    --z-modal: 1000;
    --z-lightbox: 1000;
    --z-overlay: 1001;
    --z-loading: 5000;
    --z-dialog: 2000;
    
    /* Background image */
    --background-image: none;
}

/* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: black;
    background: black;
    color: var(--text-primary);
    line-height: 1.25;
    overflow-x: hidden; 
    min-height: 100vh;
    position: relative;
}

body.modal-open {
    overflow: hidden;
}

/* Dynamic background image */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: var(--background-image, none);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    z-index: -2;
    transition: all 3s ease;
}

/* Semi-transparent gradient overlay */
body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(rgb(0 0 0 / 0%), rgb(0 0 0));
    z-index: -1;
    transition: all 3s ease;
}

body.dialog-open {
    overflow: clip;
}

/* Container */
.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: var(--spacing-xl);
    min-height: 100vh;
    position: relative;
    z-index: 1;
    overflow: visible !important;
}

/* Header */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 0 var(--spacing-xxl) 0 var(--spacing-xxl);
    padding: var(--spacing-md);
    border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
    background: var(--glass-layer-dark-5);
    backdrop-filter: blur(var(--glass-blur-2));
    border: 1px solid var(--glass-border-2);
    box-shadow: var(--glass-shadow-2);
    position: sticky;
    top: 0;
    z-index: 2;
    border-top: none;
}

.header h1 {
    font-size: 2.5rem;
    font-weight: bold;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Controls Container */
.controls-container {
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-xxl);
    box-shadow: var(--glass-shadow-3);
    position: relative;
    z-index: var(--z-layer-3);
    overflow: visible !important;
}

.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-xl);
    flex-wrap: wrap;
}

.controls-left {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
    flex-wrap: wrap;
}

.controls-right {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
}

.control-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    min-width: 150px;
}

.control-group label {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.9rem;
    text-transform: uppercase;
}

.select-control {
    padding: 0.6em;
    border: 1px solid var(--border-secondary);
    background: transparent;
    color: var(--text-primary);
    font-size: 1rem;
    cursor: pointer;
    transition: all var(--transition-normal);
    border-radius: var(--border-radius-md);
    min-height: 32px;
    box-sizing: border-box;
}

.select-control:hover,
.select-control:focus,
.select-control:active {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
}

.select-control option {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

/* Toggle Button Styling */
.toggle-btn {
    position: relative;
    transition: all var(--transition-normal);
    box-shadow: 0 8px 20px rgba(255, 255, 255, 0);
    min-width: 120px;
}

/* Toggle Buttons - Layer-Aware */
.toggle-btn,
.toggle-btn[data-state="off"],
.tab-btn {
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    color: #ffffff;
    font-weight: 600;
    z-index: var(--z-layer-3);
}


.toggle-btn[data-state="on"],
.tab-btn.active {
    background: rgb(255 133 47 / 52%);
    color: var(--text-primary);
    border: 1px solid var(--glass-border-3);
    box-shadow: inset 0 2px 4px rgb(62 24 0 / 58%), inset 0 0 8px rgb(83 38 0 / 19%), 0 0 0 1px rgb(0 0 0 / 32%);
    font-weight: 600;
    z-index: var(--z-layer-1);
    transform: translateY(1px);
    position: relative;
}

.toggle-btn[data-state="on"]::before,
.tab-btn.active::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 69, 0, 0.15) 0%, transparent 50%, rgba(0, 0, 0, 0.15) 100%);
    border-radius: var(--border-radius-md);
    pointer-events: none;
    z-index: 1;
}

.toggle-btn:hover:not(:disabled),
.tab-btn:hover:not(:disabled) {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
    box-shadow: 0 8px 20px rgba(255, 255, 255, 0.12);
    transition: all var(--transition-normal);
}

.toggle-btn[data-state="on"]:hover:not(:disabled),
.tab-btn.active:hover:not(:disabled) {
    background: rgb(255 154 83 / 52%);
    border: 1px solid var(--glass-border-4);
    color: var(--text-primary);
    z-index: var(--z-layer-1);
    box-shadow: inset 0 2px 4px rgb(62 24 0 / 58%), inset 0 0 8px rgb(83 38 0 / 19%), 0 0 0 1px rgb(0 0 0 / 32%);
}

.toggle-btn[data-state="off"]:hover,
.tab-btn:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
}

/* UC Boxes for UC Preset Button */
.uc-boxes {
    display: flex;
    gap: 3px;
    align-items: center;
    justify-content: center;
}

.uc-box {
    width: 8px;
    height: 8px;
    border: 1px solid var(--glass-border-3);
    background: transparent;
    border-radius: 2px;
    transition: background-color 0.2s ease;
}

/* UC Box States - Based on UC Preset Level */
.uc-boxes[data-uc-level="0"] .uc-box {
    background: transparent;
}

.uc-boxes[data-uc-level="1"] .uc-box[data-level="1"],
.uc-boxes[data-uc-level="2"] .uc-box[data-level="1"],
.uc-boxes[data-uc-level="2"] .uc-box[data-level="2"],
.uc-boxes[data-uc-level="3"] .uc-box[data-level="1"],
.uc-boxes[data-uc-level="3"] .uc-box[data-level="2"],
.uc-boxes[data-uc-level="3"] .uc-box[data-level="3"] {
    background: #ffffff;
    box-shadow: 0 0 5px 0px rgb(255 170 54);
}

/* UC Boxes in hover state */
.toggle-btn:hover .uc-box {
    border-color: var(--glass-border-4);
}

/* Dataset Bias Controls */
.dataset-bias-container {
    padding: var(--spacing-sm);
    border: 1px solid var(--glass-border-5);
    background: var(--glass-layer-dark-5);
    border-radius: var(--border-radius-lg);
}
.prompt-tabs:not(.show-both) .dataset-bias-container {
    min-height: 250px;
}

.dataset-bias-group {
    margin-bottom: var(--spacing-sm);
}

.dataset-bias-group .form-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.dataset-bias-group input[type="number"] {
    width: 80px;
    flex-shrink: 0;
}

.dataset-bias-group .toggle-btn {
    min-width: 60px;
    padding: 0.25rem 0.5rem;
    font-size: 0.85rem;
}

button#datasetDropdownBtn {
    gap: 5px;
}
span#datasetSelected {
    background: white;
    border-radius: 0.3em;
    color: #a6653b;
    padding: 0.0em 0.45em;
    margin: 0;
}
/* Special case for variety button */
button#varietyBtn {
    padding: 0.5em;
    min-width: 2.25em;
}

button#clearSeedBtn,
button#manualUpscale,
button#vibeNormalizeToggle,
button#paidRequestToggle,
button#imageBiasAdjustBtn,
button#editSeedBtn {
    min-width: 35px;
    padding: 0.5em;
}

/* Checkbox Styling */
.checkbox-label {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    font-weight: 600;
    color: var(--primary-color);
}

.checkbox-label input[type="checkbox"] {
    display: none;
}

.checkmark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
}

.checkbox-label input[type="checkbox"]:checked + .checkmark {
    background: var(--primary-color);
}

.checkbox-label input[type="checkbox"]:checked + .checkmark::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    color: var(--text-primary);
    font-size: 12px;
    font-weight: bold;
}

/* Layered Glass Design System */
:root {
    /* Glass Layer Depths */
    --glass-layer-1: rgba(255, 255, 255, 0.05);
    --glass-layer-2: rgba(255, 255, 255, 0.1);
    --glass-layer-3: rgba(255, 255, 255, 0.2);
    --glass-layer-4: rgba(255, 255, 255, 0.3);
    --glass-layer-5: rgba(255, 255, 255, 0.4);
    
    --glass-layer-dark-1: rgb(69 69 69 / 13%);
    --glass-layer-dark-2: rgb(69 69 69 / 22%);
    --glass-layer-dark-3: rgb(69 69 69 / 33%);
    --glass-layer-dark-4: rgb(69 69 69 / 44%);
    --glass-layer-dark-5: rgb(69 69 69 / 66%);
    
    /* Glass Borders */
    --glass-border-1: rgba(255, 255, 255, 0.1);
    --glass-border-2: rgba(255, 255, 255, 0.15);
    --glass-border-3: rgba(255, 255, 255, 0.2);
    --glass-border-4: rgba(255, 255, 255, 0.25);
    --glass-border-5: rgba(255, 255, 255, 0.3);
    
    /* Glass Blur Levels */
    --glass-blur-1: 5px;
    --glass-blur-2: 10px;
    --glass-blur-3: 15px;
    --glass-blur-4: 20px;
    --glass-blur-5: 25px;
    
    /* Glass Shadows */
    --glass-shadow-1: 0 2px 8px rgba(0, 0, 0, 0.1);
    --glass-shadow-2: 0 4px 16px rgba(0, 0, 0, 0.15);
    --glass-shadow-3: 0 8px 24px rgba(0, 0, 0, 0.2);
    --glass-shadow-4: 0 12px 32px rgba(0, 0, 0, 0.25);
    --glass-shadow-5: 0 16px 40px rgba(0, 0, 0, 0.3);
    
    /* Glass Inset Backgrounds */
    --glass-inset-bg-1: rgba(255, 255, 255, 0.05);
    --glass-inset-bg-2: rgba(255, 255, 255, 0.08);
    --glass-inset-bg-3: rgba(255, 255, 255, 0.12);
    --glass-inset-bg-4: rgba(255, 255, 255, 0.15);
    --glass-inset-bg-5: rgba(255, 255, 255, 0.2);
    
    /* Z-index layers for stacking */
    --z-layer-1: 1;
    --z-layer-2: 2;
    --z-layer-3: 3;
    --z-layer-4: 4;
    --z-layer-5: 5;
    --z-layer-6: 6;
    --z-layer-7: 7;
    --z-layer-8: 8;
    --z-layer-9: 9;
    --z-layer-10: 10;
}

/* Base Glass Panel */
.glass-panel {
    background: var(--glass-layer-1);
    backdrop-filter: blur(var(--glass-blur-1));
    border: 1px solid var(--glass-border-1);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--glass-shadow-1);
    transition: all var(--transition-normal);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-panel:hover {
    background: var(--glass-layer-2);
    border-color: var(--glass-border-2);
    box-shadow: var(--glass-shadow-2);
}

/* Glass Panel Layers */
.glass-panel.layer-1 {
    background: var(--glass-layer-1);
    backdrop-filter: blur(var(--glass-blur-1));
    border: 1px solid var(--glass-border-1);
    box-shadow: var(--glass-shadow-1);
    z-index: var(--z-layer-1);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-panel.layer-2 {
    background: var(--glass-layer-2);
    backdrop-filter: blur(var(--glass-blur-2));
    border: 1px solid var(--glass-border-2);
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-panel.layer-3 {
    background: var(--glass-layer-3);
    backdrop-filter: blur(var(--glass-blur-3));
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    z-index: var(--z-layer-3);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-panel.layer-4 {
    background: var(--glass-layer-4);
    backdrop-filter: blur(var(--glass-blur-4));
    border: 1px solid var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    z-index: var(--z-layer-4);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-panel.layer-5 {
    background: var(--glass-layer-5);
    backdrop-filter: blur(var(--glass-blur-5));
    border: 1px solid var(--glass-border-5);
    box-shadow: var(--glass-shadow-5);
    z-index: var(--z-layer-5);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Buttons - Layer-Aware Design System */
.btn-primary, .btn-secondary, .btn-danger {
    padding: 0.5em 1em;
    border-radius: var(--border-radius-md);
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    text-decoration: none;
    min-height: 32px;
    min-width: 45px;
    white-space: nowrap;
    position: relative;
    border: 1px solid transparent;
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
    letter-spacing: 0.3px;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.blur {
    backdrop-filter: blur(var(--glass-blur-2));
}

/* Base button layer awareness */
.btn-primary, .btn-secondary, .btn-danger {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    color: var(--text-primary);
}

/* Button hover states with layer elevation */
.btn-secondary:hover:not(:disabled) {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    z-index: var(--z-layer-4);
    box-shadow: 0 8px 20px rgb(255 255 255 / 12%);
    transition: all var(--transition-normal);
}


/* Primary Button - High Contrast */
.btn-primary {
    background: var(--primary-glass-color);
    color: #ffffff;
    border-color: var(--primary-glass-border);
    box-shadow: var(--glass-shadow-3), 0 2px 8px var(--shadow-primary);
    font-weight: 700;
}

.btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    background: var(--glass-layer-1);
    border-color: var(--glass-border-1);
    color: var(--text-muted);
    box-shadow: var(--glass-shadow-1);
}

.btn-primary:hover:not(:disabled) {
    background: #ff5415d6;
    border-color: var(--primary-color-light);
    box-shadow: var(--glass-shadow-3), 0 2px 16px rgb(255 69 0 / 89%);
    color: #ffffff;
}

/* Secondary Button - Medium Contrast */
.btn-secondary {
    background: var(--glass-layer-3);
    color: #ffffff;
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    font-weight: 600;
}

.btn-secondary:hover:not(:disabled) {
    background: var(--glass-layer-4);
    color: #ffffff;
    border-color: var(--glass-border-4);
}

.btn-secondary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    background: var(--glass-layer-1);
    border-color: var(--glass-border-1);
    color: var(--text-muted);
    box-shadow: var(--glass-shadow-1);
}

/* Danger Button - High Contrast */
.btn-danger {
    background: linear-gradient(135deg, var(--danger-color), var(--danger-color-light));
    color: #ffffff;
    border-color: var(--danger-color);
    box-shadow: var(--glass-shadow-3), 0 2px 8px var(--shadow-danger);
    font-weight: 700;
}

.btn-danger:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--danger-color-light), var(--danger-color));
    border-color: var(--danger-color-light);
    color: #ffffff;
}

.btn-danger:hover:not(:disabled) {
    /* Hover state handled by main btn-danger:hover rule */
}


.lightbox-controls .btn-danger:hover:not(:disabled) {
    /* Hover state handled by main lightbox-controls rule */
}

.btn-danger:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

/* Layer-Aware Button Variants */

/* Generate Button - Prominent */
.generate-btn {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-color-light));
    color: #ffffff;
    border-color: var(--primary-color);
    box-shadow: var(--glass-shadow-4), 0 4px 12px var(--shadow-primary);
    font-weight: 700;
    font-size: 16px;
    padding: 0.6em 1.2em;
    min-height: 44px;
    z-index: var(--z-layer-4);
}

.generate-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--primary-color-light), var(--primary-color));
    border-color: var(--primary-color-light);
    color: #ffffff;
    z-index: var(--z-layer-5);
}

.generate-btn .badge {
    background: white;
    color: #ff4705;
    border-radius: 3px;
    padding: 4px 10px;
    display: inline-flex;
    flex-direction: row;
    align-items: center;
    gap: 6px;
    margin: 0;
}

/* Small and Icon-Only Button Variants */
.btn-small {
    padding: 6px 12px;
    font-size: 12px;
    min-height: 28px;
    min-width: 50px;
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    color: #ffffff;
    font-weight: 600;
    z-index: var(--z-layer-3);
}

.btn-small:hover:not(:disabled) {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}

/* Compact button groups */
.btn-group-compact .btn-primary,
.btn-group-compact .btn-secondary,
.btn-group-compact .btn-danger {
    padding: 6px 12px;
    font-size: 13px;
    min-height: 32px;
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    color: #ffffff;
    z-index: var(--z-layer-3);
}

.btn-group-compact .btn-primary:hover:not(:disabled),
.btn-group-compact .btn-secondary:hover:not(:disabled),
.btn-group-compact .btn-danger:hover:not(:disabled) {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}

/* Button groups with consistent spacing */
.btn-group {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    flex-wrap: wrap;
}

.btn-group-compact {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
    flex-wrap: wrap;
}

/* Button utility classes for layer awareness */
.btn-layer-1 {
    background: var(--glass-layer-1);
    border-color: var(--glass-border-1);
    box-shadow: var(--glass-shadow-1);
    color: var(--text-muted);
    z-index: var(--z-layer-1);
}

.btn-layer-2 {
    background: var(--glass-layer-2);
    border-color: var(--glass-border-2);
    box-shadow: var(--glass-shadow-2);
    color: #cccccc;
    z-index: var(--z-layer-2);
}

.btn-layer-3 {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    color: #ffffff;
    z-index: var(--z-layer-3);
}

.btn-layer-4 {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}

.btn-layer-5 {
    background: var(--glass-layer-5);
    border-color: var(--glass-border-5);
    box-shadow: var(--glass-shadow-5);
    color: #ffffff;
    z-index: var(--z-layer-5);
}

/* Enhanced disabled states */
.btn-primary:disabled,
.btn-secondary:disabled,
.btn-danger:disabled,
.toggle-btn:disabled,
.btn-small:disabled,
.btn-icon-only:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
    background: var(--glass-layer-1);
    border-color: var(--glass-border-1);
    color: var(--text-muted);
    box-shadow: var(--glass-shadow-1);
    z-index: var(--z-layer-1);
}

/* Active button states - only for text inputs */
input[type="text"]:active,
input[type="number"]:active,
input[type="email"]:active,
input[type="password"]:active,
input[type="search"]:active,
input[type="tel"]:active,
input[type="url"]:active,
textarea:active {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    z-index: var(--z-layer-4);
}

.gallery-controls {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: var(--spacing-lg);
    gap: var(--spacing-md);
}

.gallery-controls .toggle-btn {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    color: var(--text-primary);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-lg);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 0.9rem;
    font-weight: 500;
}

.gallery-controls .toggle-btn:hover {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.gallery-controls .toggle-btn[data-state="scraps"] {
    background: var(--glass-layer-3);
    border-color: var(--primary-color);
    color: var(--primary-color);
}

.gallery-controls .toggle-btn[data-state="scraps"]:hover {
    background: var(--primary-color);
    color: var(--text-primary);
}

.gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: var(--spacing-xl);
    margin-bottom: var(--spacing-xxl);
    width: 100%;
    max-width: 100%;
}

.gallery-item {
    position: relative;
    overflow: hidden;
    cursor: pointer;
    aspect-ratio: 1;
    transition: all var(--transition-normal);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-xl);
    background: var(--glass-layer-2);
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
}

.gallery-item:hover {
    transform: translateY(-5px);
    border-color: var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    background: var(--glass-layer-4);
    z-index: var(--z-layer-4);
}

.gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    color: var(--text-primary);
    padding: 15px;
    opacity: 0;
    transition: opacity var(--transition-normal);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.gallery-item:hover .gallery-item-overlay {
    opacity: 1;
}

.gallery-item-title {
    color: var(--text-primary);
    font-weight: 600;
    margin-bottom: 5px;
}

.gallery-item-info {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* Gallery actions - using standardized button system */
.gallery-actions {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    gap: var(--spacing-sm);
    opacity: 0;
    transition: opacity var(--transition-normal);
    z-index: 10;
    width: 50%;
    flex-wrap: wrap;
    justify-content: flex-end;
    align-items: flex-start;
}

.gallery-item:hover .gallery-actions {
    opacity: 1;
}

/* Gallery info - moved to bottom left */
.gallery-item-info-container {
    position: absolute;
    bottom: 15px;
    left: 15px;
    right: 15px;
    margin-bottom: 0;
}

.gallery-info-row {
    color: var(--text-primary);
    font-size: 0.85rem;
    margin-bottom: 2px;
}

.gallery-info-row:first-child {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--primary-color);
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: var(--z-modal);
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: transparent;
    overflow: hidden;
}

.modal-content {
    background: var(--glass-layer-dark-5);
    backdrop-filter: blur(var(--glass-blur-5));
    border: 1px solid var(--glass-border-5);
    margin: 5% auto;
    padding: var(--spacing-xl);
    width: 96%;
    height: fit-content;
    max-width: 600px;
    position: relative;
    animation: modalSlideIn 0.3s ease-out;
    max-height: 90vh;
    overflow-y: auto;
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-5);
    z-index: var(--z-layer-5);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Gallery Action Buttons - Medium Layer */
.round-button {
    padding: 9px;
    font-size: 18px;
    width: 45px;
    height: 45px;
    border-radius: 45px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    box-shadow: 0 2px 8px var(--shadow-secondary);
    align-items: center;
    background: #0000005c;
    border-color: var(--glass-border-3);
    color: #ffffff;
    z-index: var(--z-layer-3);
}

.round-button:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}

.round-button.btn-primary:hover:not(:disabled) {
    background: #000000bd;
    border-color: #ffffff57;
    color: #ffffff;
}

.round-button.btn-danger {
    color: #ffdadacf;
    border-color: #ff000030;
    background: #4700005c;
}

.round-button.btn-danger:hover:not(:disabled) {
    background: #ff353580;
    border-color: #ff48284f;
    color: #ffdfdf;
}

.round-button-group {
    font-size: 18px;
    height: 45px;
    border-radius: 45px;
    cursor: pointer;
    display: flex;
    box-shadow: 0 2px 8px var(--shadow-secondary);
    align-items: center;
    border: none;
    color: #ffffff;
    z-index: var(--z-layer-3);
    padding: 0;
    background: transparent;
    backdrop-filter: blur(var(--glass-blur-2));
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.round-button-group .round-button {
    backdrop-filter: none;
    box-shadow: none;
}

.round-button-group .round-button:first-child {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.round-button-group .round-button:last-child {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}

.round-button-group .round-button:not(:first-child):not(:last-child) {
    border-radius: 0;
}

span#manualPreviewSeedNumber {
    font-family: 'Oxanium';
    line-height: 1;
}


.modal-content.center {
    margin: auto;
}

/* Manual Modal Specific Styles */
.manual-modal-content {
    max-width: 650px;
    max-height: calc(100vh - 6em);
    padding: 0;
    margin: 4.5em auto 1.5em auto;
}
    
.manual-modal-split {
    display: flex;
    gap: 0;
    height: calc(calc(100vh - 7.5em) - 2px);
    position: relative;
    flex-flow: column-reverse;
}

.manual-modal-form-section {
    width: 100%;
    height: 100%;
}

.workspace-tabs {
    display: none;
}


    
.manual-modal-preview-section {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
}


.manual-preview-container {
    background: var(--glass-layer-5);
    border-left: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-xl);
    height: 100%;
    display: flex;
    flex-direction: column;
    box-shadow: var(--glass-shadow-2);
    position: relative;
}

.manual-preview-header {
    margin-bottom: var(--spacing-lg);
}

.manual-preview-header h3 {
    color: var(--primary-color);
    font-size: 1.2rem;
    font-weight: 600;
    text-transform: uppercase;
    margin: 0;
}

.manual-preview-content {
    display: flex;
    position: relative;
    height: 100%;
    overflow: hidden;
}

.manual-preview-image-container {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    padding: var(--spacing-xxl);
    border-radius: var(--border-radius-xl);
    height: 100%;
}

.manual-preview-image-container img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    box-shadow: var(--glass-shadow-4);
    transition: transform 0.1s ease-out;
    transform-origin: center;
    user-select: none;
    pointer-events: none;
}

.manual-preview-image-container.zoomed {
    cursor: grab;
}

.manual-preview-image-container.zoomed:active {
    cursor: grabbing;
}

.manual-preview-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    text-align: center;
    padding: var(--spacing-xl);
}

.manual-preview-placeholder i {
    font-size: 3rem;
    margin-bottom: var(--spacing-md);
    opacity: 0.5;
}

.manual-preview-placeholder p {
    margin: 0;
    font-size: 0.9rem;
}

.manual-preview-controls {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: center;
    flex-wrap: wrap;
    position: absolute;
    bottom: 0;
    padding-bottom: var(--spacing-xxl);
    width: 100%;
}
.manual-preview-controls-right {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-end;
    flex-wrap: wrap;
    position: absolute;
    bottom: 0;
    right: 0;
    padding-bottom: var(--spacing-xxl);
    width: 250px;
    align-items: center;
    padding-right: var(--spacing-xxl);
}
.manual-preview-controls-left {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-start;
    flex-wrap: wrap;
    position: absolute;
    bottom: 0;
    left: 0;
    padding-bottom: var(--spacing-xxl);
    width: 250px;
    align-items: center;
    padding-left: var(--spacing-xxl);
}
.manual-preview-controls-top-right {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-end;
    flex-wrap: wrap;
    position: absolute;
    top: 0;
    right: 0;
    padding-top: var(--spacing-lg);
    width: 150px;
    align-items: center;
    padding-right: var(--spacing-lg);
}

.manual-preview-handle-inner {
    display: flex;
    width: 64px;
    height: 30px;
    background: var(--glass-layer-2);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--glass-border-1);
    box-shadow: var(--glass-shadow-2);
    margin-top: -5px;
    padding-top: 5px;
    align-items: center;
    justify-content: center;
    cursor: grab;
    pointer-events: auto;
    z-index: 25;
}


/* Manual Modal Split Layout for Wide Viewports */
@media (min-width: 1400px) {
    #manualPreviewSeedBtn {
        width: unset;
        padding: 9px 20px;
        font-size: 18px;
        height: 45px;
        border-radius: 45px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        box-shadow: 0 2px 8px var(--shadow-secondary);
        flex-direction: row;
        flex-wrap: nowrap;
        gap: 0.4em;
        align-items: center;
        border: 1px solid var(--glass-border-3);
        background: #0000005c;
        color: #ffffff;
        text-decoration: none;
        min-height: 32px;
        min-width: 45px;
        white-space: nowrap;
        position: relative;
        transform: translateZ(0);
        will-change: backdrop-filter;
        backdrop-filter: blur(var(--glass-blur-2));
    }

    .manual-modal-split {
        flex-flow: row;
    }
    .gallery-container {
        margin-top: 40px;
    }

    div#manualModal {
        position: fixed;
        box-shadow: none;
        justify-content: center;
    }

    .manual-modal-content {
        max-width: 2000px;
        width: calc(100% - calc(var(--spacing-xxl) * 2));
        margin: 4.5em var(--spacing-xxl) 1.5em var(--spacing-xxl);
        max-height: calc(100vh - 7.5em);
    }
    
    .manual-modal-form-section {
        width: unset;
        flex: 1;
        min-width: 0;
        overflow: auto;
        max-width: 650px;
    }

    .workspace-controls .btn-secondary:nth-child(2) {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
        border-top-left-radius: var(--border-radius-md)!important;
        border-bottom-left-radius: var(--border-radius-md)!important;
    }

    #closeManualBtn {
        display: none;
    }
    
    /* Desktop Workspace Layout */
    #workspaceDropdown {
        display: none;
    }
    
    .workspace-tabs {
        position: fixed;
        bottom: -25px;
        left: 0;
        right: 0;
        width: min-content;
        background: transparent;
        padding: 0 var(--spacing-lg);
        z-index: 999;
        display: flex;
        gap: var(--spacing-xs);
        align-items: flex-end;
        justify-content: flex-start;
        flex-wrap: nowrap;
        padding-top: 20px;
        transition: all 0.2s ease;
    }

    .workspace-tabs.inactive {
        bottom: -55px;
    }
    
    .workspace-tabs:hover:not(.inactive) {
        bottom: -5px;
    }
    
    .workspace-tab {
        border-radius: var(--border-radius-md);
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        backdrop-filter: blur(var(--glass-blur-2));
        box-shadow: var(--glass-shadow-2);
        padding: var(--spacing-xs) var(--spacing-sm) var(--spacing-lg) var(--spacing-sm);
        min-width: 150px;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        justify-content: center;
        overflow: hidden;
        margin-bottom: -2px;
        background: var(--glass-layer-3);
        color: var(--text-color);
        border: 1px solid var(--glass-border-3);
        box-shadow: 0px -2px 20px #ffffff26;
        font-weight: 100;
        transform: translateZ(0);
        will-change: backdrop-filter;
    }
    
    .workspace-tabs:not(:hover) .workspace-tab.active {
        margin-bottom: 10px;
        bottom: 0;
    }

    .workspace-tab.active {
        margin-bottom: -1px;
        font-weight: 600;
    }
    .workspace-tab::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        opacity: 0;
        transition: opacity 0.2s ease;
    }
    
    .workspace-tab:hover::before {
        opacity: 1;
    }
    
    .workspace-tab:hover {
        transform: translateY(-1px);
        box-shadow: 0px -2px 20px #ffffff43;
    }
    
    .workspace-tab.active {
        border-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0px -2px 20px #ffffff1d;
        transform: translateY(-2px);
    }
    
    .workspace-tab.active::before {
        opacity: 0.2;
    }
    
    /* Animation for workspace tab transitions */
    .workspace-tab {
        animation: tabSlideIn 0.3s ease-out;
    }
    
    @keyframes tabSlideIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .workspace-tab .workspace-color-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        flex-shrink: 0;
    }
    
    .workspace-tab .workspace-name {
        font-weight: 600;
    }
    
    .workspace-tab .workspace-counts {
        font-size: 0.8rem;
        opacity: 0.7;
    }
    
    /* Adjust container to account for fixed tabs */
    .container {
        padding-bottom: 80px;
    }
    
    /* Responsive adjustments for workspace tabs */
    @media (max-width: 1600px) {
        .workspace-tabs {
            padding: var(--spacing-sm) var(--spacing-md);
        }
        
        .workspace-tab {
            min-width: 100px;
            padding: var(--spacing-xs) var(--spacing-sm) var(--spacing-sm) var(--spacing-sm);    
            font-size: 0.85rem;
        }
    }
    
    @media (max-width: 1500px) {
        .workspace-tab {
            min-width: 90px;
            font-size: 0.8rem;
        }
        
        .workspace-tab .workspace-counts {
            display: none;
        }
    }
    .manual-preview-handle {
        display: none;
    }
}

/* Mobile/Tablet styles - hide preview section */
@media (max-width: 1399px) {
    .manual-preview-image-container {
        border-bottom: 1px solid var(--glass-border-5);
    }
    .manual-preview-controls-left, .manual-preview-controls-right {
        width: auto;
    }
    .manual-preview-handle {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: flex-start;
        overflow: hidden;
        padding-bottom: 15px;
        pointer-events: none;
    }
    #manualPreviewSeedNumber {
        display: none;
    }
    .manual-modal-preview-section {
        display: none;
        position: absolute;
        top: -100%;
        left: 0;
        z-index: 105;
        opacity: 0;
        width: 100%;
        height: min(1024px, 95%);
        margin-bottom: 5%;
        backdrop-filter: blur(var(--glass-blur-1));
        transform: translateZ(0);
        will-change: backdrop-filter, opacity, top;
        transition: opacity 0.2s ease, top 0.5s ease;
    }
    .manual-modal-preview-section.show {
        display: flex;
    }
    .manual-modal-preview-section.active {
        top: 0;
        opacity: 1;
        transform: translateZ(0);
        will-change: backdrop-filter, opacity, top;
        transition: opacity 0.2s ease, top 0.5s ease;
    }
    .manual-preview-container {
        background: rgb(197 197 197 / 88%);
    }
}

.manual-modal-content h2 {
    color: var(--primary-color);
    margin-bottom: 25px;
    text-align: center;
    text-transform: uppercase;
}

#manualForm {
    display: flex;
    flex-direction: column;
    gap: 0;
    overflow: hidden;
    padding: 0;
    height: 100%;
    justify-content: space-between;
}
.form-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
    padding: var(--spacing-lg);
}
.form-section-scroll {
    overflow: auto;
    height: 100%;
}

.form-section.model-control {
    padding-top: 0;
    gap: var(--spacing-sm);
}

.form-section.model-control .form-row:nth-child(1) {
    border-top: 1px solid var(--glass-border-1);
    padding-top: var(--spacing-md);
}

.form-section::-webkit-scrollbar {
    width: 8px;
}

.form-section::-webkit-scrollbar-track {
    background: var(--bg-tertiary);
    border-radius: 4px;
}

.form-section::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}
.form-section::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.form-group label {
    text-transform: uppercase;
    color: var(--primary-color);
    font-weight: 600;
    font-size: 0.75rem;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 4px;
}

/* Form Controls - Layered Glass System */
.form-control {
    border: 1px solid var(--glass-border-2);
    background: var(--glass-layer-2);
    color: var(--text-primary);
    font-size: 1rem;
    transition: all var(--transition-normal);
    padding: 0.6em;
    min-height: 32px;
    box-sizing: border-box;
    border-radius: var(--border-radius-md);
    box-shadow: var(--glass-shadow-2);
    position: relative;
    z-index: var(--z-layer-2);
}

.form-control:hover {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
}

.hover-show,
.modal-content .hover-show,
.custom-dropdown-btn.hover-show,
.form-control.hover-show {
    border: 1px solid transparent;
    background: transparent;
    color: var(--text-primary);
    padding: 0.35em 1.2em 0.35em 0;
    transition: all var(--transition-normal);
    backdrop-filter: none;
    box-shadow: none;
    display: flex;
    justify-content: flex-start;
    gap: var(--spacing-xs);
    align-items: center;
}

.hover-show:hover,
.modal-content .hover-show:hover,
.modal-content .hover-show:focus,
.custom-dropdown-btn.hover-show:hover,
.form-control.hover-show:hover {
    color: var(--text-primary);
    background: var(--glass-layer-3);
    padding: 0.35em 0.6em;
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 20px rgb(255 255 255 / 12%);
    z-index: var(--z-layer-3);
}

.hover-show.right:hover {
    padding: 0.35em 0.6em 0.35em 0.6em;
}



.form-control::placeholder {
    color: var(--text-muted);
}

.form-control option {
    background: var(--bg-quaternary);
    color: var(--text-primary);
}

/* Prompt textarea container and background */
.prompt-textarea-container {
    position: relative;
    width: 100%;
    height: auto;
    min-height: 80px;
}

.prompt-textarea-background,
.character-prompt-textarea-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgb(0 0 0 / 28%);
    border: 1px solid var(--glass-inset-bg-5);
    border-radius: var(--border-radius-md);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    z-index: 1;
    transition: all var(--transition-normal);
}

.prompt-textarea-container:focus-within .prompt-textarea-background, 
.character-prompt-textarea-container:focus-within .character-prompt-textarea-background {
    background: rgb(32 32 32 / 69%);
    border: 1px solid rgba(255, 255, 255, 1);
    box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.4);
}

/* Prompt textarea specific height */
.prompt-textarea,
.character-prompt-textarea {
    width: 100%;
    height: auto;
    resize: none;
    min-height: 80px;
    border: 1px solid transparent;
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 1em;
    padding: 0.6em;
    border-radius: var(--border-radius-md);
    transition: all var(--transition-normal);
    line-height: 1.5;
    line-break: anywhere;
    background: transparent;
    position: relative;
    z-index: 2;
    overflow: hidden;
}

#manualPrompt {
    backdrop-filter: none !important;
}

.prompt-textarea:hover,
.prompt-textarea:focus,
.prompt-textarea:active,
.character-prompt-textarea:hover,
.character-prompt-textarea:focus,
.character-prompt-textarea:active {
    background: rgba(255, 255, 255, 0.25);
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid rgba(255, 255, 255, 1);
}

div#characterPromptsContainer {
    padding-top: var(--spacing-lg);
}

/* Inset textarea styling */
.textarea-inset,
.textarea-inset:hover  {
    background: #ffffff1f;
    border: 1px solid var(--glass-inset-bg-5);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    transition: all var(--transition-normal);
    position: relative;
}

.textarea-inset::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, transparent 50%, rgba(0, 0, 0, 0.1) 100%);
    border-radius: var(--border-radius-md);
    pointer-events: none;
    z-index: 1;
}

.textarea-inset:focus {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.4);
    outline: none;
}

.textarea-inset textarea {
    background: transparent;
    border: none;
    color: var(--text-primary);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    width: 100%;
    height: 100%;
    resize: none;
    outline: none;
    position: relative;
    z-index: 2;
}

.textarea-inset textarea::placeholder {
    color: var(--text-muted);
}

/* Resolution group with upscale toggle */
.resolution-group {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.resolution-group .form-control {
    flex: 1;
}

/* Custom resolution inputs */
.custom-resolution-inputs {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
    flex: auto;
}

.custom-resolution-inputs input[type="number"] {
    text-align: center;
    padding: 0.35em 0.6em;
    font-size: 1em;
    font-family: 'Oxanium', 'Courier New', monospace;
    flex: auto;
    color: #ff8153;
    background: transparent;
    font-weight: 400;
}

.custom-resolution-inputs #manualHeight:not(:hover) {
    padding: 0.35em 1.2em 0.35em 0em;
}
.custom-resolution-inputs #manualWidth:not(:hover) {
    padding: 0.35em 0em 0.35em 1.2em;
}

.custom-resolution-inputs input[type="number"]::-webkit-outer-spin-button,
.custom-resolution-inputs input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.custom-resolution-inputs input[type="number"] {
    -moz-appearance: textfield;
}

/* Seed input group with clear button and layer1 seed toggle */
.seed-input-group {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.seed-input-group .form-control {
    flex: 1;
}

/* Icon-only toggle buttons */
.toggle-btn.icon-only {
    min-width: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-normal);
}


/* Form row layout updates */
.form-row {
    display: flex;
    gap: 10px;
    align-items: flex-end;
}

.form-col {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.form-col .form-row {
    margin-bottom: 0;
}
.form-row.separator {
    border-top: 2px solid #413e3e;
    padding-top: 10px;
}

.form-row .form-group {
    flex: 1;
    min-width: 0;
}

/* Ensure form controls have consistent sizing */
.form-row .form-control {
    width: 100%;
    box-sizing: border-box;
}


.modal-actions.btn-group {
    justify-content: flex-end;
}

/* Transformation section state classes */
#transformationSection.hidden {
    display: none;
}

#transformationRow:not(.display-image) #transformationSection {
    display: none;
}

#transformationRow:not(.display-vibe) #vibeReferencesContainer {
    display: none;
}

#transformationRow.display-vibe:not(.display-image) .vibe-references-container {
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-areas: ". . .";
}

#transformationRow:not(.display-image):not(.display-vibe) {
    display: none;
}

#transformationDropdown.disabled {
    opacity: 0.5;
    pointer-events: none;
}

#transformationDropdown.disabled button {
    cursor: not-allowed;
}

/* Remove the old layer1 seed toggle group styles since it's now integrated */
#layer1SeedToggleGroup {
    display: none;
}

#layer1SeedToggleGroup.show {
    display: block;
}

.form-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-md);
    padding-top: var(--spacing-lg);
}

/* Responsive adjustments for manual modal */
@media (max-width: 768px) {
    .manual-modal-content {
        margin: 2% auto;
        width: 95%;
    }
    
    /* Stack all form rows on mobile */
    .form-row {
        flex-direction: column !important;
        gap: 15px;
    }
    
    .form-row .form-group {
        flex: none;
        width: 100%;
    }

    
    .resolution-group .form-control,
    .seed-input-group .form-control {
        width: 100%;
    }
    
    .form-actions {
        align-items: center;
    }
    
    .form-actions button {
        width: 100%;
        max-width: 200px;
    }
}

@media (max-width: 480px) {
    .manual-modal-content {
        margin: 1% auto;
    }
    
    .form-group label {
        font-size: 0.9rem;
    }
    
    .form-control {
        padding: 10px;
        font-size: 0.95rem;
    }
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-content h2 {
    color: #ff4500;
    margin-bottom: 15px;
    text-align: center;
}

.modal-content p {
    margin-bottom: 20px;
    text-align: center;
    color: #cccccc;
}

.modal-content input {
    width: 100%;
    border: none;
    background: #333333;
    color: #ffffff;
    font-size: 1rem;
}

.modal-content input:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
}

/* Lightbox Styles */
.lightbox-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.75);
    z-index: 1000;
    overflow: hidden;
}

/* Close button overlay */
.lightbox-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: none!important;
    color: white;
    font-size: 1.5rem;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 1001;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.lightbox-close-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
}

/* Move close button when prompt panel is open */
.lightbox-close-btn.prompt-panel-open {
    right: 420px; /* 400px panel width + 20px margin */
}

.lightbox-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100%;
}

/* Main content area with image and prompt panel side by side */
.lightbox-main-content {
    display: flex;
    flex: 1;
    min-height: 0;
}

/* Image and controls section */
.lightbox-image-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
}

/* Image container */
.lightbox-image-container {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 0;
    overflow: visible;
    cursor: default;
    user-select: none;
}

/* Image Section */
.lightbox-image-section {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 0;
    overflow: visible;
}

.lightbox-image-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: default;
    user-select: none;
}

.lightbox-image-container.zoomed {
    cursor: grab;
}

.lightbox-image-container.zoomed:active {
    cursor: grabbing;
}

#lightboxImage {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7);
    transition: transform 0.1s ease-out;
    transform-origin: center;
    user-select: none;
    pointer-events: none;
}

/* Metadata Section */
.lightbox-metadata-section {
    background: #1a1a1abd;
    backdrop-filter: blur(10px);
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    min-height: 200px;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Metadata Table Styles */
.metadata-grid {
    display: flex;
    flex-direction: column;
    gap: 16px;
    width: 100%;
}

.metadata-row {
    display: flex;
    gap: 16px;
    width: 100%;
    flex-wrap: wrap;
}

.metadata-cell {
    display: flex;
    flex-direction: column;
    padding: 12px 16px;
    background: rgba(255, 255, 255, 0.05);
    min-height: 80px;
    flex: 1 0 auto;
    min-width: 120px;
}

.metadata-cell.metadata-model-cell {
    flex: auto;
    min-width: 200px;
}

.metadata-model-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex: 1;
    gap: 12px;
}

.metadata-model-content .metadata-value {
    flex: 1;
    margin: 0;
}

.metadata-buttons {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    flex-shrink: 0;
}

.metadata-cell.metadata-small {
    min-width: 200px;
    flex: 0 1 auto;
}

.metadata-cell.metadata-very-small {
    min-width: 100px;
    flex: 0 1 auto;
}

.metadata-label {
    color: #ff6b35;
    font-weight: 600;
    font-size: 0.8em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 6px;
}

.metadata-value {
    color: white;
    font-size: 0.95em;
    word-break: break-word;
    flex: 1;
    display: flex;
    align-items: center;
}

.metadata-btn {
    background: #ff6b35;
    color: white;
    border: none;
    padding: 6px 12px;
    font-size: 0.8em;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
    min-width: 100px;
    font-weight: bold;
    border-radius: 2px;
}

.metadata-btn:hover {
    background: #e55a2b;
}

.metadata-btn:active {
    background: #d14a1f;
}

/* Expandable sections */
.metadata-expanded {
    margin-top: 16px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    overflow: hidden;
}

.metadata-expanded-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: rgba(255, 107, 53, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    color: #ff6b35;
    font-weight: 600;
}

.close-expanded {
    background: none;
    border: none;
    color: #ff6b35;
    font-size: 1.2em;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.close-expanded:hover {
    background: rgba(255, 107, 53, 0.2);
}

.metadata-expanded-content {
    padding: 16px;
    color: white;
    font-size: 0.9em;
    line-height: 1.5;
    max-height: 300px;
    overflow-y: auto;
    white-space: pre-wrap;
    word-break: break-word;
}

/* Controls Section */
.lightbox-controls-section {
    display: flex;
    justify-content: center;
    flex-shrink: 0;
}

.lightbox-controls {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 800px;
}

/* Metadata Dialog (Mobile Only) */
.metadata-dialog {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    overflow-y: auto;
}

.metadata-dialog-content {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    margin: 20px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    overflow: hidden;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.metadata-dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.metadata-dialog-header h3 {
    color: white;
    margin: 0;
    font-size: 1.2em;
}

.close-dialog {
    background: none;
    border: none;
    color: white;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.close-dialog:hover {
    background: rgba(255, 255, 255, 0.2);
}

.metadata-dialog-body {
    padding: 20px;
    max-height: 70vh;
    overflow-y: auto;
}

/* Prompt Panel Styles */
.prompt-panel {
    width: 400px;
    background: transparent;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transform: translateX(100%);
    transition: transform var(--transition-normal);
}

.prompt-panel.show {
    transform: translateX(0);
}

/* Ensure prompt panel takes full height of main content */
.prompt-panel {
    height: 100%;
}

.prompt-panel.hidden {
    display: none;
}

.prompt-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg) var(--spacing-xl);
    background: var(--primary-gradient);
    color: var(--text-primary);
    border-bottom: 1px solid var(--border-secondary);
}

.prompt-panel-header h3 {
    margin: 0;
    font-size: 1.2rem;
    font-weight: 600;
}

.close-panel-btn {
    background: none;
    border: none;
    color: var(--text-primary);
    font-size: 1.2rem;
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: 50%;
    transition: background-color var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
}

.close-panel-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.prompt-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-lg);
}

.prompt-section {
    margin-bottom: var(--spacing-xl);
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
}

.prompt-section:last-child {
    margin-bottom: 0;
}

.prompt-section-header {
    background: rgba(255, 107, 53, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: var(--spacing-md) var(--spacing-lg);
}

.prompt-section-header h4 {
    margin: 0;
    color: var(--primary-color);
    font-size: 0.8em;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prompt-section-content {
    padding: var(--spacing-lg);
    background: transparent;
}

.prompt-content {
    color: var(--text-primary);
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 0.95em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-break: break-word;
    max-height: 200px;
    overflow-y: auto;
}

.prompt-content:empty::before {
    content: "No content available";
    color: var(--text-muted);
    font-style: italic;
}

.character-prompts-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.character-prompt-item-panel {
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    background: #000000ad;
}

.character-prompt-item-panel:last-child {
    margin-bottom: 0;
}

.character-prompt-item-panel .character-name {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.8em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: var(--spacing-sm);
    display: flex;
    align-items: center;
    flex-wrap: wrap;
}

.character-prompt-item-panel .character-prompt-text {
    color: var(--text-primary);
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 0.95em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-break: break-word;
    flex: 1;
}

.character-prompt-item-panel .prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-sm);
}

.prompt-header:not(:first-child) {
    align-items: flex-end;
}
.prompt-header:not(:first-child) .character-name {
    opacity: 0.5;
    color: var(--secoundary-color);
    font-size: 0.6em;
}
.character-prompt-item-panel .prompt-copy-btn {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 100%;
    flex-shrink: 0;
}

.character-prompt-item-panel .prompt-copy-btn:hover {
    background: var(--bg-quaternary);
    color: var(--primary-color);
}

.character-prompt-item-panel .prompt-divider {
    height: 2px;
    background: var(--border-primary);
    margin: var(--spacing-md) 0;
    opacity: 0.5;
}

.character-prompt-item-panel .prompt-badges {
    display: flex;
    gap: var(--spacing-xs);
    margin-left: var(--spacing-sm);
    flex-wrap: wrap;
}

.character-prompt-item-panel .prompt-badge {
    display: inline-block;
    padding: 2px 4px 4px;
    border-radius: 3px;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    text-align: center;
    line-height: 1;
}

.character-prompt-item-panel .coordinate-badge {
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 1px 3px var(--shadow-primary);
}

.character-prompt-item-panel .disabled-badge {
    background: var(--danger-gradient);
    color: var(--text-primary);
    box-shadow: 0 1px 3px var(--shadow-danger);
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .lightbox-container {
        flex-direction: column;
    }
    
    .lightbox-image-section {
        flex: 1;
        padding: 10px;
    }
    
    /* Hide metadata section on mobile */
    .lightbox-metadata-section {
        display: none;
    }
    
    /* Show metadata button on mobile */
    .metadata-btn-mobile {
        display: inline-block !important;
    }
    
    .lightbox-controls-section {
        padding: 15px;
    }
    
    .lightbox-controls {
        gap: 8px;
    }
    
    
    /* Metadata dialog styles for mobile */
    .metadata-dialog-content {
        margin: 10px;
        max-width: none;
    }
    
    .metadata-dialog-header {
        padding: 15px;
    }
    
    .metadata-dialog-body {
        padding: 15px;
        max-height: 80vh;
    }
    
    .metadata-table {
        font-size: 0.9em;
    }
    
    .metadata-cell {
        padding: 8px 10px;
        width: 50%;
    }
    
    .metadata-table tbody tr {
        display: flex;
        flex-wrap: wrap;
    }
    
    .metadata-table tbody tr td:nth-child(1),
    .metadata-table tbody tr td:nth-child(2) {
        width: 50%;
    }
    
    .metadata-table tbody tr td:nth-child(3),
    .metadata-table tbody tr td:nth-child(4) {
        width: 50%;
    }
    
    .metadata-expanded-content {
        max-height: 200px;
    }
    
    /* Mobile layout */
    .lightbox-main-content {
        flex-direction: column;
    }
    
    .lightbox-image-section {
        flex: none;
        height: 100vh;
    }
    
    /* Mobile prompt panel */
    .prompt-panel {
        width: 100%;
        height: 40vh;
        transform: translateY(100%);
    }
    
    .prompt-panel.show {
        transform: translateY(0);
    }
    
    /* Move close button down on mobile when prompt panel is open */
    .lightbox-close-btn.prompt-panel-open {
        right: 20px;
        top: 60vh; /* Move down to be above the prompt panel */
    }
}

/* Desktop styles - hide metadata button */
@media (min-width: 769px) {
    .metadata-btn-mobile {
        display: none !important;
    }
}

/* Toast Notifications */
.toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 3000;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    pointer-events: none;
}

.toast {
    background: var(--bg-modal);
    color: var(--text-primary);
    padding: var(--spacing-md) var(--spacing-lg);
    border-radius: var(--border-radius-lg);
    border: 1px solid var(--primary-color);
    box-shadow: 0 4px 15px var(--shadow-primary);
    font-size: 0.9rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    pointer-events: auto;
    animation: toastSlideIn 0.3s ease-out;
    max-width: 300px;
}

.toast.success {
    border-color: var(--success-color);
    box-shadow: 0 4px 15px var(--shadow-success);
}

.toast.error {
    border-color: var(--danger-color);
    box-shadow: 0 4px 15px var(--shadow-danger);
}

.toast.info {
    border-color: var(--info-color);
    box-shadow: 0 4px 15px var(--shadow-info);
}

.toast i {
    font-size: 1rem;
    flex-shrink: 0;
}

.toast.success i {
    color: var(--success-color);
}

.toast.error i {
    color: var(--danger-color);
}

.toast.info i {
    color: var(--info-color);
}

@keyframes toastSlideIn {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes toastSlideOut {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(100%);
    }
}

.toast.removing {
    animation: toastSlideOut 0.3s ease-in forwards;
}

/* Glass-style toast notifications */
.glass-toast {
    background: var(--glass-layer-dark-4);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg);
    padding: 16px 20px;
    color: var(--text-primary);
    font-size: 0.9rem;
    font-weight: 500;
    box-shadow: var(--glass-shadow-3);
    max-width: 400px;
    min-width: 300px;
    display: flex;
    align-items: center;
    gap: 12px;
    pointer-events: auto;
    cursor: pointer;
    transition: all var(--transition-normal);
    transform: translateX(100%);
    opacity: 0;
}

.glass-toast.show {
    transform: translateX(0);
    opacity: 1;
}

.glass-toast.removing {
    transform: translateX(100%);
    opacity: 0;
}

.glass-toast.upload-progress {
    background: var(--glass-layer-dark-5);
    border-color: var(--primary-color);
    box-shadow: 0 0 20px rgba(255, 69, 0, 0.3);
}

.glass-toast.upload-progress .toast-icon {
    color: var(--primary-color);
}

.glass-toast .toast-icon {
    font-size: 1.75rem;
    flex-shrink: 0;
}

.glass-toast .toast-content {
    flex: 1;
    min-width: 0;
}

.glass-toast .toast-title {
    font-weight: 600;
    margin-bottom: 4px;
    color: var(--text-primary);
}

.glass-toast .toast-message {
    color: var(--text-secondary);
    font-size: 0.85rem;
    line-height: 1.4;
}

.glass-toast .toast-progress {
    width: 100%;
    height: 4px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    margin-top: 8px;
    overflow: hidden;
}

.glass-toast .toast-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color), var(--primary-color-light));
    border-radius: 2px;
    transition: width var(--transition-fast);
    width: 0%;
}

.glass-toast .toast-close {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 4px;
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    flex-shrink: 0;
}

.glass-toast .toast-close:hover {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text-primary);
}

/* Simple one-line toast styling */
.glass-toast.simple {
    padding: 12px 16px;
    min-width: 200px;
    max-width: 350px;
}

.glass-toast.simple .toast-content {
    flex: 1;
    text-align: center;
}

.glass-toast.simple .toast-message {
    font-size: 0.9rem;
    font-weight: 500;
    margin: 0;
}

/* Utility Classes */
.hidden {
    display: none !important;
}

/* Glass Layer Utility Classes */
.glass-layer-1 {
    background: var(--glass-layer-1);
    border: 1px solid var(--glass-border-1);
    box-shadow: var(--glass-shadow-1);
    z-index: var(--z-layer-1);
    backdrop-filter: blur(var(--glass-blur-1));
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-layer-2 {
    background: var(--glass-layer-2);
    backdrop-filter: blur(var(--glass-blur-2));
    border: 1px solid var(--glass-border-2);
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-layer-3 {
    background: var(--glass-layer-3);
    backdrop-filter: blur(var(--glass-blur-3));
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    z-index: var(--z-layer-3);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-layer-4 {
    background: var(--glass-layer-4);
    backdrop-filter: blur(var(--glass-blur-4));
    border: 1px solid var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    z-index: var(--z-layer-4);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.glass-layer-5 {
    background: var(--glass-layer-5);
    backdrop-filter: blur(var(--glass-blur-5));
    border: 1px solid var(--glass-border-5);
    box-shadow: var(--glass-shadow-5);
    z-index: var(--z-layer-5);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Glass Panel Utility Classes */
.glass-panel-base {
    border-radius: var(--border-radius-lg);
    transition: all var(--transition-normal);
}


.glass-panel-base:hover {
    transform: translateY(-1px);
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

/* Autocomplete Overlay Styles */
.autocomplete-overlay {
    position: absolute;
    background: rgb(38 38 38 / 84%);
    border: 1px solid rgb(0 0 0 / 40%);
    border-radius: 5px;
    max-height: 200px;
    overflow-y: auto;
    z-index: var(--z-overlay);
    box-shadow: 0 4px 12px var(--shadow-secondary);
    min-width: 200px;
}

.character-autocomplete-item[data-type="textReplacement"] {
    display: flex;
    flex-direction: column;
}
.character-info-row {
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
}
.placeholder-desc {
    font-size: 0.8em;
    color: #9be6ffc2;
}
.placeholder-desc {
    font-size: 0.8em;
    color: #9be6ffc2;
    overflow: clip;
    text-overflow: ellipsis;
    width: 100%;
    white-space: pre;
}

.autocomplete-overlay.hidden {
    display: none;
}

.autocomplete-list {
    padding: 0;
    margin: 0;
}

.autocomplete-item {
    padding: 10px 15px;
    cursor: pointer;
    border-bottom: 1px solid var(--border-secondary);
    color: var(--text-primary);
    transition: background-color var(--transition-fast);
}

.autocomplete-item:hover {
    background: #ff440095;
    color: var(--text-primary);
}

.autocomplete-item.selected {
    background: #ff440048;
    color: var(--text-primary);
}

.autocomplete-item:last-child {
    border-bottom: none;
}

.autocomplete-item .placeholder-name {
    font-weight: 600;
    color: var(--primary-color-light);
}

.autocomplete-item .placeholder-desc {
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-top: 2px;
}

@media (max-width: 480px) {
    .manual-modal-content {
        margin: 1% auto;
    }
    
    .form-group label {
        font-size: 0.9rem;
    }
    
    .form-control {
        font-size: 0.95rem;
    }
}

/* Responsive breakpoints for metadata grid */
@media (max-width: 1200px) {
    .metadata-row {
        gap: 12px;
    }
    
    .metadata-cell {
        padding: 10px 14px;
        min-height: 70px;
        min-width: 205px;
    }
    
    .metadata-cell.metadata-model-cell {
        min-width: 180px;
    }
    
    .metadata-model-content {
        gap: 8px;
    }
    .metadata-cell.metadata-small {
        min-width: 180px;
        flex: 1 0 auto;
    }
    
    .metadata-cell.metadata-very-small {
        min-width: 120px;
        flex: 1 0 auto;
    }
}

@media (max-width: 900px) {
    .metadata-row {
        gap: 10px;
    }
    
    .metadata-cell {
        padding: 8px 12px;
        min-height: 60px;
        min-width: 150px;
    }
    
    .metadata-cell.metadata-model-cell {
        min-width: 160px;
    }
    
    .metadata-model-content {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
    }
    
    .metadata-buttons {
        width: 100%;
        justify-content: flex-start;
    }
}

@media (max-width: 600px) {
    .metadata-grid {
        gap: 12px;
    }
    
    .metadata-row {
        gap: 8px;
    }
    
    .metadata-cell {
        padding: 6px 10px;
        min-height: 50px;
        min-width: 80px;
    }
    
    .metadata-cell.metadata-model-cell {
        min-width: 140px;
    }
    
    .metadata-label {
        font-size: 0.7em;
    }
    
    .metadata-value {
        font-size: 0.85em;
    }
    
    .metadata-btn {
        padding: 4px 8px;
        font-size: 0.7em;
    }
}

/* Loading Overlay Styles */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-overlay);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-loading);
    backdrop-filter: blur(5px);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.loading-overlay.hidden {
    display: none;
}

.loading-content {
    text-align: center;
    color: var(--text-primary);
    background: var(--bg-modal);
    padding: 40px;
    border-radius: 15px;
    border: 2px solid var(--primary-color);
    box-shadow: 0 10px 30px var(--shadow-primary);
    max-width: 400px;
    width: 90%;
}

.loading-content p {
    margin: 20px 0 0 0;
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary-color);
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid var(--bg-quaternary);
    border-top: 4px solid var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Confetti Styles */
#confettiContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1500;
    overflow: hidden;
}

.confetti {
    position: absolute;
    top: -10px;
    border-radius: 2px;
    animation: confettiFall 3s linear forwards;
    transform-origin: center;
}

@keyframes confettiFall {
    0% {
        transform: translateY(-10px) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

/* Confetti variations for more dynamic effect */
.confetti:nth-child(odd) {
    animation-duration: 2.5s;
    animation-delay: 0.1s;
}

.confetti:nth-child(even) {
    animation-duration: 3.5s;
    animation-delay: 0.2s;
}

.confetti:nth-child(3n) {
    animation-duration: 2.8s;
    animation-delay: 0.3s;
}

.confetti:nth-child(4n) {
    animation-duration: 3.2s;
    animation-delay: 0.4s;
}

.confetti:nth-child(5n) {
    animation-duration: 2.7s;
    animation-delay: 0.5s;
}

/* Disable scroll arrows (spinners) in number inputs */
.form-control[type="number"]::-webkit-outer-spin-button,
.form-control[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* Remove selection borders and highlights across all browsers */
input:focus,
select:focus,
textarea:focus,
button:focus {
    outline: none !important;
    -webkit-appearance: none !important;
    -webkit-tap-highlight-color: transparent !important;
}

/* Remove iOS Safari specific styling */
input[type="text"],
input[type="number"],
input[type="email"],
input[type="password"],
input[type="search"],
input[type="tel"],
input[type="url"],
textarea,
select {
    -webkit-appearance: none;
    -webkit-border-radius: 0;
    border-radius: 3px;
    -webkit-tap-highlight-color: transparent;
}

/* Remove Firefox specific styling */
input::-moz-focus-inner,
button::-moz-focus-inner {
    border: 0;
    outline: none;
}

.form-control[type="number"] {
    -moz-appearance: textfield; /* Firefox */
}

/* Set specific width for Steps, Guidance, and Rescale inputs on desktop/tablet */
@media (min-width: 769px) {
    .form-row .form-group:has(#manualSteps) input,
    .form-row .form-group:has(#manualGuidance) input,
    .form-row .form-group:has(#manualRescale) input {
        width: 58px;
        flex: none;
    }
    
    .form-row .form-group:has(#manualSteps),
    .form-row .form-group:has(#manualGuidance),
    .form-row .form-group:has(#manualRescale) {
        flex: none;
    }
}

/* Add border to all inputs and buttons except lightbox buttons */
input, 
button, 
select, 
textarea {
    border: 1px solid rgba(255, 69, 0, 0.58);
    padding: 0.6em;
    border-radius: var(--border-radius-md);
    background: transparent;
    transition: all var(--transition-normal);
    box-sizing: border-box;
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
}

select:hover,
select:focus,
textarea:hover,
textarea:focus {
    background: rgba(255, 255, 255, 0.25);
    padding: 0.6em;
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid rgba(255, 255, 255, 1);
}

/* Badge styles */
.badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-left: var(--spacing-sm);
}

.upscaled-badge {
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 1px 3px var(--shadow-primary);
}

/* Variety icon styles */
.variety-icon {
    color: #32cd32; /* Lime green */
    margin-left: var(--spacing-sm);
    font-size: 0.9rem;
    animation: splotch-pulse 2s ease-in-out infinite;
}

@keyframes splotch-pulse {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.7;
        transform: scale(1.1);
    }
}

/* Character Autocomplete Styles */
.character-autocomplete-overlay {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: blur(var(--glass-blur-2));
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    max-height: min(500px, 50vh);
    overflow-y: auto;
    min-width: 300px;
    max-width: 500px;
    width: 400px; /* Fixed width for consistency */
    scroll-behavior: smooth;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.character-autocomplete-overlay.hidden {
    display: none;
}

.character-autocomplete-list {
    padding: 0;
}

.character-autocomplete-item {
    padding: 0.2em 0.5em;
    cursor: pointer;
    border-bottom: 1px solid var(--border-secondary);
    transition: background-color var(--transition-fast);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.character-autocomplete-item:hover {
    background: #3a3a3a;
}

.character-autocomplete-item.selected {
    background: var(--primary-color);
    color: var(--text-primary);
}

.character-autocomplete-item:last-child {
    border-bottom: none;
}

.character-autocomplete-item .character-name {
    font-weight: 600;
    font-size: 11px;
    color: var(--primary-color);
}

.character-autocomplete-item[data-type="character"] .character-name,
.character-autocomplete-item[data-type="tag"] .character-name {
    text-transform: uppercase;
}

.character-autocomplete-item .character-copyright {
    font-size: 0.7rem;
    color: var(--text-muted);
    font-style: italic;
}


/* Character items (default styling) */
.character-autocomplete-item .character-name {
    color: #ff4500; /* Orange for characters */
}

.character-autocomplete-item .character-copyright {
    color: #ff9b7a; /* Gray for character copyright */
}

/* Different colors for different item types */ 
.character-autocomplete-item[data-type="tag"] .character-name {
    color: #ffc1c1; /* Light blue for text replacements */
}
.character-autocomplete-item[data-type="tag"] .badge {
    background: #ff1313;
}

.character-autocomplete-item[data-type="tag"] .character-copyright {
    color: #ff8282; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="tag"]:hover {
    background: #4a1a1a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="tag"].selected {
    background: #cd0000; /* Orange background when selected */
}

/* Different colors for different item types */ 
.character-autocomplete-item[data-type="tag"][data-model-type="furry"] .character-name {
    color: #fb82ff; /* Light blue for text replacements */
}
.character-autocomplete-item[data-type="tag"][data-model-type="furry"] .badge {
    background: #a913ff;
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"] .character-copyright {
    color: #d382ff; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"]:hover {
    background: #3a1a4a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected {
    background: #ae00cd; /* Orange background when selected */
}


.character-autocomplete-item[data-type="textReplacement"] .character-name {
    color: #beeaff; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="textReplacement"] .character-copyright {
    color: #4fc3f7; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="textReplacement"]:hover {
    background: #1a3a4a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="textReplacement"].selected {
    background: #0085cd; /* Orange background when selected */
}

/* Show more indicator */
.character-autocomplete-item.more-indicator {
    background: var(--glass-layer-dark-3);
    border-top: 2px solid var(--primary-color);
    font-style: italic;
    opacity: 0.8;
}

.character-autocomplete-item.more-indicator:hover {
    background: var(--glass-layer-dark-4);
}

.character-autocomplete-item.more-indicator .character-name {
    color: var(--text-muted);
    font-weight: normal;
}

/* Emphasis tooltip in autocomplete */
.character-autocomplete-tooltip {
    background: var(--glass-layer-dark-3);
    border-top: 1px solid var(--glass-border-2);
    padding: 6px 10px;
    text-align: center;
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
    opacity: 0.8;
}

.character-autocomplete-tooltip span {
    color: var(--primary-color);
    font-weight: 500;
}

/* Emphasis popup styles */
.emphasis-popup {
    position: absolute;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: blur(var(--glass-blur-2));
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    padding: var(--spacing-sm);
    width: 350px;
    display: none;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.emphasis-popup-content {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.emphasis-header {
    display: flex;
    align-items: center;
    gap: 8px;
}

.emphasis-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
}

.emphasis-type {
    font-size: 0.8rem;
    color: var(--text-muted);
    padding: 2px 6px;
    white-space: nowrap;
    width: 100%;
    height: -webkit-fill-available;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    text-transform: uppercase;
    font-weight: bold;
}

.emphasis-type.mode-normal {
    color: #87ceeb; /* Light blue for new groups */
}

.emphasis-type.mode-brace {
    color: #ff8c00; /* Orange for brace blocks */
}

.emphasis-type.mode-group {
    color: #98fb98; /* Light green for existing groups */
}

.emphasis-text {
    font-size: 0.7rem;
    color: var(--text-secondary);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
    text-align: left;
}

.emphasis-value {
    font-family: var(--font-mono);
    font-size: 1.2rem;
    font-weight: bold;
    padding: 2px 8px;
    border-radius: var(--border-radius-sm);
    background: var(--glass-layer-dark-3);
    border: 1px solid var(--glass-border-2);
    min-width: 60px;
    text-align: right;
}

.emphasis-controls {
    display: flex;
    gap: 2px;
}

.emphasis-btn {
    padding: 0.25em 0.5em;
    min-height: 30px;
    min-width: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.emphasis-btn:hover {
    background: var(--glass-layer-dark-4);
    border-color: var(--glass-border-3);
}

.emphasis-btn.emphasis-up:hover {
    background: #4ecdc4;
    border-color: #4ecdc4;
    color: white;
}

.emphasis-btn.emphasis-down:hover {
    background: #ff6b35;
    border-color: #ff6b35;
    color: white;
}

.emphasis-btn.emphasis-left:hover,
.emphasis-btn.emphasis-right:hover {
    background: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected .character-name,
.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected .character-copyright,
.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected .badge,
.character-autocomplete-item.selected .character-name,
.character-autocomplete-item.selected .character-copyright,
.character-autocomplete-item.selected .badge {
    color: var(--text-primary);
    opacity: 1;
    background: none;
}

/* Preset Autocomplete Styles */
.preset-autocomplete-overlay {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: blur(var(--glass-blur-2));
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    overflow-y: auto;
    min-width: 300px;
    max-width: 500px;
    width: 400px;
    font-size: 0.9em;
    transform-origin: bottom center;
    scroll-behavior: smooth;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Preset Autocomplete Size Classes */
.preset-autocomplete-overlay.size-small {
    max-height: min(200px, 30vh);
}

.preset-autocomplete-overlay.size-medium {
    max-height: min(300px, 40vh);
}

.preset-autocomplete-overlay.size-large {
    max-height: min(400px, 50vh);
}

.preset-autocomplete-overlay.hidden {
    display: none;
}

.preset-autocomplete-list {
    padding: 0;
}

.preset-autocomplete-item {
    padding: 6px 10px;
    cursor: pointer;
    border-bottom: 1px solid var(--border-secondary);
    transition: background-color var(--transition-fast);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85em;
}

.preset-autocomplete-item:hover {
    background: #3a3a3a;
}

.preset-autocomplete-item.selected {
    background: var(--primary-color);
    color: var(--text-primary);
}

.preset-autocomplete-item:last-child {
    border-bottom: none;
}

.preset-autocomplete-item .preset-name {
    font-weight: 600;
    color: #00bfff; /* Light blue for presets */
}

.preset-autocomplete-item .preset-details {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
}

.preset-autocomplete-item.selected .preset-name,
.preset-autocomplete-item.selected .preset-details {
    color: var(--text-primary);
}

/* Character Detail Overlay Styles */
.character-detail-overlay {
    position: absolute;
    background: #2a2a2a;
    border: 2px solid #ff4500;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
    z-index: 2001;
    min-width: 400px;
    max-width: 600px;
    max-height: 80vh;
    overflow: hidden;
    /* Ensure it stays within viewport */
    max-width: calc(100vw - 40px);
    max-height: calc(100vh - 40px);
}

/* Character detail content when inside autocomplete overlay */
.character-detail-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    max-height: 400px;
}

/* Ensure the character detail content takes full height of the autocomplete overlay */
.character-autocomplete-overlay .character-detail-content {
    height: 100%;
    max-height: 400px;
}

.character-detail-overlay.hidden {
    display: none;
}

.character-detail-content {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.character-detail-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-lg);
    background: linear-gradient(45deg, #ff450078, #ff634778);
    color: white;
    border-bottom: 1px solid #ffffff70;
}

.character-name-copyright {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex: 1;
    gap: 20px;
}

.character-name {
    font-weight: 600;
}

.character-copyright {
    font-size: 0.9rem;
    opacity: 0.9;
    font-style: italic;
}

.close-character-detail {
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.close-character-detail:hover {
    background: rgba(255, 255, 255, 0.2);
}

.character-detail-body {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
    max-height: calc(80vh - 80px); /* Account for header height */
}

/* When inside autocomplete overlay, take full available height */
.character-autocomplete-overlay .character-detail-body {
    max-height: calc(400px - 60px); /* Account for header height */
    overflow-y: auto;
}
.character-autocomplete-item span.badge {
    background: #fb4400;
    color: white;
    border-radius: 0.4em;
    padding: 0 0.6em 0.2em 0.25em;
    opacity: 0.45;
    font-size: 0.75em;
    margin-left: 0.5em;
    text-transform: none;
}
.character-prompt {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #444;
}

.character-prompt strong {
    color: #ff4500;
    display: block;
    margin-bottom: 8px;
}

.character-prompt span {
    color: #ccc;
    line-height: 1.5;
}

.character-enhancers {
    margin-bottom: 15px;
}

.character-enhancers strong {
    color: #ff4500;
    display: block;
    margin-bottom: 12px;
}

.enhancers-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-height: 300px;
    overflow-y: auto;
    padding-right: 5px;
}

/* When inside autocomplete overlay, take full available height */
.character-autocomplete-overlay .enhancers-list {
    max-height: none;
    flex: 1;
    overflow-y: visible;
}

/* Custom scrollbar for enhancers list */
.enhancers-list::-webkit-scrollbar {
    width: 6px;
}

.enhancers-list::-webkit-scrollbar-track {
    background: #1a1a1a;
    border-radius: 3px;
}

.enhancers-list::-webkit-scrollbar-thumb {
    background: #ff4500;
    border-radius: 3px;
}

.enhancers-list::-webkit-scrollbar-thumb:hover {
    background: #ff6347;
}

.enhancer-group {
    background: var(--glass-layer-4);
    border: 1px solid var(--glass-border-4);
    border-radius: 6px;
    padding: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.enhancer-group:hover {
    border-color: #ff4500;
    background: #222;
}

.enhancer-group.selected {
    border-color: #ff4500;
    background: linear-gradient(45deg, rgba(255, 69, 0, 0.1), rgba(255, 99, 71, 0.1));
}

.enhancer-group-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.enhancer-group-name {
    font-weight: 600;
    color: #ff4500;
    font-size: 0.9rem;
}

.enhancer-group-count {
    background: #444;
    color: #ccc;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 0.8rem;
}

.enhancer-items {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.enhancer-item {
    background: #333;
    color: #ccc;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.8rem;
    border: 1px solid #555;
}

.enhancer-item.negative {
    background: #4a1a1a;
    color: #ff6b6b;
    border-color: #8b2a2a;
}

/* Mobile responsiveness for character overlays */
@media (max-width: 768px) {
    .character-autocomplete-overlay,
    .character-detail-overlay {
        min-width: 280px;
        max-width: 90vw;
    }
    
    .character-name-copyright {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }
    
    .character-detail-body {
        padding: 15px;
    }
    
    .enhancer-group {
        padding: 10px;
    }
    
    .enhancer-items {
        gap: 4px;
    }
    
    .enhancer-item {
        font-size: 0.75rem;
        padding: 3px 6px;
    }
}

/* Variation image container */
.variation-image-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0;
    max-height: inherit;
    border-bottom: 1px solid #8d8d8d;
    border-bottom-left-radius:  var(--border-radius-md);
    border-bottom-right-radius: var(--border-radius-md);
    background: #929292ab;
    box-shadow: 0px 0px 14px #00000054;
    position: relative;
    overflow: hidden;
    width: 100%;
    height: 100%;
}

.variation-image-container > .variation-image {
    max-width: -webkit-fill-available;
    max-height: inherit;
    object-fit: contain;
}

#maskPreviewCanvas {
    position: absolute;
    pointer-events: none;
    z-index: 1;
}

/* Request Type Toggle */
.request-type-toggle {
    display: flex;
    gap: 10px;
    align-items: center;
}

.request-type-toggle .toggle-btn {
    flex: 1;
    min-width: 120px;
    justify-content: center;
}

/* Lightbox Toggle Base Image Button (Top Left) */
.lightbox-toggle-btn {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 1001;
    background: linear-gradient(45deg, #17a2b8, #20c997);
    color: white;
    border: 2px solid #17a2b8;
    border-radius: 3px;
    padding: 10px 16px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    background: rgba(23, 162, 184, 0.9);
}

.lightbox-toggle-btn:hover {
    background: linear-gradient(45deg, #138496, #1ea085);
    box-shadow: 0 6px 20px rgba(23, 162, 184, 0.5);
}

.lightbox-toggle-btn[data-state="base"] {
    background: linear-gradient(45deg, #6f42c1, #e83e8c);
    border-color: #6f42c1;
    background: rgba(111, 66, 193, 0.9);
}

.lightbox-toggle-btn[data-state="base"]:hover {
    background: linear-gradient(45deg, #5a32a3, #d63384);
    box-shadow: 0 6px 20px rgba(111, 66, 193, 0.5);
}

.lightbox-toggle-btn i {
    margin-right: 6px;
}

/* Balance Display */
.balance-display {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 600;
    font-size: 16px;
    cursor: default;
}

.balance-display.low-credits {
    color: #fd7e14;
}

/* Legacy toggle button styles (for backward compatibility) */
.toggle-base-btn {
    background: linear-gradient(45deg, #17a2b8, #20c997);
    color: white;
    border: 2px solid #17a2b8;
}

.toggle-base-btn:hover {
    background: linear-gradient(45deg, #138496, #1ea085);
    box-shadow: 0 5px 15px rgba(23, 162, 184, 0.4);
}

.toggle-base-btn[data-state="base"] {
    background: linear-gradient(45deg, #6f42c1, #e83e8c);
    border-color: #6f42c1;
}

.toggle-base-btn[data-state="base"]:hover {
    background: linear-gradient(45deg, #5a32a3, #d63384);
    box-shadow: 0 5px 15px rgba(111, 66, 193, 0.4);
}
.header-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

/* Workspace Controls */
.workspace-controls,
.button-group {
    display: flex;
    align-items: center;
    gap: 0;
    box-shadow: var(--glass-shadow-2);
}
.workspace-controls .btn-secondary,
.button-group [class^="btn-"] {
    box-shadow: none;
}
.workspace-controls .btn-secondary:not(:first-child):not(:last-child),
.button-group [class^="btn-"]:not(:first-child):not(:last-child) {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-left: none;
}
.workspace-controls .btn-secondary:first-child,
.button-group [class^="btn-"]:first-child {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
.workspace-controls .btn-secondary:last-child,
.button-group [class^="btn-"]:last-child {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
}
.workspace-option-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    gap: var(--spacing-sm);
}

.workspace-name {
    font-weight: 500;
}

.workspace-counts {
    font-size: 0.8em;
    color: #8c8c8c;
    opacity: 0.8;
}
.workspace-controls > button {
    padding: 0.5em 0.5em;
    min-width: 35px;
}

/* Bulk Actions Bar */
.bulk-actions-bar {
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-4);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-lg) var(--spacing-xl);
    margin: 0 var(--spacing-xxl) var(--spacing-xl) var(--spacing-xxl);
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: var(--glass-shadow-4);
    color: var(--text-primary);
    position: sticky;
    top: 4em;
    z-index: var(--z-layer-5);
}

.bulk-actions-info {
    font-weight: 600;
    font-size: 1.1rem;
}

.bulk-actions-info span {
    color: #ffd700;
    font-weight: 700;
}

.bulk-actions-buttons {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
}

/* Gallery Item Selection */
.gallery-item {
    position: relative;
}

/* Selection mode styles */
.gallery.selection-mode .gallery-item {
    cursor: pointer;
}
/* Selection mode styles */
.gallery.selection-mode .gallery-item:not(.selected):not(:hover) {
    opacity: 0.7;
    scale: 0.9;
}

.gallery-item-checkbox {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 15;
    width: 22px;
    height: 22px;
    cursor: pointer;
    accent-color: #007bff;
    transform: scale(1.3);
    opacity: 0;
    transition: opacity 0.3s ease;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 4px;
    padding: 2px;
}

.gallery-item:hover .gallery-item-checkbox {
    opacity: 1;
}

.gallery-item-checkbox:checked {
    opacity: 1;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 2px 8px rgba(0, 123, 255, 0.4);
}

.gallery-item.selected {
    border: 4px solid #ff9e75;
    box-shadow: 0 0 20px rgba(255, 128, 0, 0.5);
}

.gallery-item.selected .gallery-item-checkbox {
    opacity: 1;
    background: rgb(214, 79, 0);
    box-shadow: 0 2px 8px rgba(255, 123, 0, 0.4);
}

.gallery.selection-mode .gallery-item:hover {
    transform: scale(1.02);
}

/* Responsive adjustments for bulk actions */
@media (max-width: 768px) {
    .bulk-actions-bar {
        flex-direction: column;
        gap: 12px;
        text-align: center;
    }
    
    .bulk-actions-buttons {
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .bulk-actions-buttons button {
        font-size: 0.9rem;
        padding: 8px 12px;
    }
}

/* Character Prompts Section */
.character-prompts-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.character-prompts-title {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.95rem;
    text-transform: uppercase;
}

.character-prompts-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

/* Button group styling for transformation section */
.character-prompts-controls .btn-group {
    display: flex;
    border-radius: var(--border-radius-md);
    overflow: hidden;
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    transition: all var(--transition-normal);
    z-index: var(--z-layer-3);
    gap: 0;
    box-sizing: border-box;
}

.character-prompts-controls .btn-group .btn-secondary {
    border-radius: 0;
    border: none;
    margin: 0;
    position: relative;
    background: transparent;
    color: #ffffff;
    font-weight: 600;
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all var(--transition-normal);
    min-width: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    z-index: var(--z-layer-3);
    box-sizing: border-box;
}

.character-prompts-controls .btn-group .btn-secondary:first-child {
    border-top-left-radius: var(--border-radius-md);
    border-bottom-left-radius: var(--border-radius-md);
}

.character-prompts-controls .btn-group .btn-secondary:last-child {
    border-top-right-radius: var(--border-radius-md);
    border-bottom-right-radius: var(--border-radius-md);
}

.character-prompts-controls .btn-group .btn-secondary:not(:last-child) {
    border-right: 1px solid var(--glass-border-3);
}

.character-prompts-controls .btn-group .btn-secondary:hover:not(:disabled) {
    background: var(--glass-layer-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}

.character-prompts-controls .btn-group .btn-secondary[data-state="on"] {
    background: rgb(255 133 47 / 52%);
    color: var(--text-primary);
    border: none;
    box-shadow: inset 0 2px 4px rgb(62 24 0 / 58%), inset 0 0 8px rgb(83 38 0 / 19%), 0 0 0 1px rgb(0 0 0 / 32%);
    font-weight: 600;
    z-index: var(--z-layer-1);
    transform: none;
    position: relative;
}

.character-prompts-controls .btn-group .btn-secondary[data-state="on"]::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 69, 0, 0.15) 0%, transparent 50%, rgba(0, 0, 0, 0.15) 100%);
    border-radius: var(--border-radius-md);
    pointer-events: none;
    z-index: 1;
}

.character-prompts-controls .btn-group .btn-secondary[data-state="on"]:hover {
    background: rgb(255 154 83 / 52%);
    color: var(--text-primary);
    z-index: var(--z-layer-1);
}

.character-prompts-controls .btn-group .btn-secondary[data-state="off"]:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
}

.character-prompts-controls .btn-group:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    z-index: var(--z-layer-4);
}

.auto-position-toggle {
    display: flex;
    align-items: center;
}

.character-prompt-item {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    margin-bottom: var(--spacing-sm);
    position: relative;
    border-radius: var(--border-radius-md);
}

.character-prompt-item:last-child {
    margin-bottom: 0;
}

.character-prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.character-prompt-title {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.9rem;
    text-transform: uppercase;
}
.character-prompts-title-group {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: flex-start;
    gap: var(--spacing-xs);
}

.character-prompt-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.character-prompt-toggle {
    display: flex;
    align-items: center;
    position: relative;
    cursor: pointer;
}

.character-prompt-toggle input[type="checkbox"] {
    opacity: 0;
    position: absolute;
    cursor: pointer;
}

.character-prompt-toggle .checkmark {
    height: 16px;
    width: 16px;
    background: var(--bg-quaternary);
    border: 1px solid var(--border-secondary);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
}

.character-prompt-toggle input:checked ~ .checkmark {
    background: var(--primary-color);
    border-color: var(--primary-color);
}

.character-prompt-toggle .checkmark:after {
    content: "";
    position: absolute;
    display: none;
    left: 4px;
    top: 1px;
    width: 4px;
    height: 8px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
}

.character-prompt-toggle input:checked ~ .checkmark:after {
    display: block;
}

.character-prompt-delete {
    background: var(--danger-gradient);
    color: var(--text-primary);
    border: none;
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all var(--transition-fast);
    min-width: 60px;
    border-radius: var(--border-radius-sm);
    box-shadow: 0 2px 8px var(--shadow-danger);
}

.character-prompt-delete:hover {
    box-shadow: 0 5px 15px var(--shadow-danger);
}

.character-prompt-fields {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.character-prompt-disabled {
    opacity: 0.6;
}

.character-prompt-disabled .character-prompt-fields {
    filter: grayscale(1);
}

/* Position Dialog Styles */
.position-dialog-content {
    max-width: min-content;
    height: min-content;
}

.position-dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 15px;
}

.position-dialog-header h3 {
    color: var(--primary-color);
    margin: 0;
    text-transform: uppercase;
}

.position-dialog-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xl);
}

.position-grid {
    display: flex;
    flex-direction: column;
    gap: 4px;
    align-items: center;
}

.position-row {
    display: flex;
    gap: 4px;
}

.position-cell {
    width: 60px;
    height: 60px;
    border: 2px solid var(--border-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-tertiary);
    color: var(--text-primary);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-normal);
    font-size: 0.9rem;
}

.position-cell:hover {
    border-color: var(--primary-color);
    background: var(--bg-quaternary);
}

.position-cell.selected {
    border-color: var(--primary-color);
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 2px 8px var(--shadow-primary);
}

.position-dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-md);
}

/* Responsive adjustments for character prompts */
@media (max-width: 768px) {
    .character-prompt-fields {
        grid-template-columns: 1fr;
    }
    
    .character-prompts-controls {
        gap: 8px;
        align-items: flex-end;
    }
    
    .position-btn {
        min-width: 70px;
        font-size: 0.75rem;
    }
}

.hover-show.colored {
    color: #ffcfbd;
    font-weight: bold;
    font-family: 'Oxanium', 'Courier New', monospace;
    font-size: 1em;
    letter-spacing: 0.5px;
}
.hover-show.right {
    text-align: right;
    padding: 0.35em 0em 0.35em 1.2em;
}
#manualPresetToggleBtn.hover-show #manualPresetToggleIcon {
    display: none;
}

.hover-show span#manualPresetToggleText {
    color: var(--text-primary);
    font-weight: 100;
    opacity: 0.5;
    transition: all var(--transition-normal);
}

.hover-show:hover span#manualPresetToggleText {
    opacity: 1;
    transition: all var(--transition-normal);
}

/* Custom Resolution Dropdown Styles */
.custom-dropdown {
    position: relative;
    display: inline-block;
    font-family: inherit;
}
.custom-dropdown-btn {
    width: 100%;
    background: var(--glass-layer-2);
    color: #fff;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    padding: 0.6em 1.8em 0.6em 0.8em;
    font-size: 1rem;
    text-align: left;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all var(--transition-normal);
    min-height: 32px;
    box-shadow: var(--glass-shadow-2);
    position: relative;
    z-index: var(--z-layer-2);
}

.custom-dropdown-btn > span {
    display: flex;
    align-items: center;
}

.custom-dropdown-btn:hover {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
}

.custom-dropdown-btn:focus,
.custom-dropdown-btn.active {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    outline: none;
    z-index: var(--z-layer-4);
}
.custom-dropdown-btn:focus,
.custom-dropdown-btn.active {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    outline: none;
}
.custom-dropdown-menu {
    position: absolute;
    top: 110%;
    left: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--border-radius-lg);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    z-index: var(--z-layer-6);
    line-height: 1.75;
    padding: 0.25em 0;
    max-height: 340px;
    overflow-y: auto;
    min-width: 165px;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

#manualModelDropdown .custom-dropdown-menu,
#manualResolutionGroup .custom-dropdown-menu {
    min-width: 225px;
}
.vibe-reference-info .custom-dropdown-menu {
    min-width: 75px;
    width: auto;
}

/* Custom scrollbar for dropdown menus */
.custom-dropdown-menu::-webkit-scrollbar {
    width: 8px;
}

.custom-dropdown-menu::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 4px;
}

.custom-dropdown-menu::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.8);
    border-radius: 4px;
}

.custom-dropdown-menu::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 1);
}
.custom-dropdown-group {
    padding: 0.2em 0.2em 0.2em 1em;
    font-size: 0.6em;
    color: #8c8c8c;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.85;
}
.custom-dropdown-option {
    padding: 0.25em 1em;
    background: none;
    color: #1a1a1a;
    font-size: 0.85em;
    cursor: pointer;
    border: none;
    width: 100%;
    text-align: left;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: background 0.15s, color 0.15s;
}
.custom-dropdown-option:hover,
.custom-dropdown-option:focus {
    background: rgb(4 4 4 / 50%);
    color: #fff;
}
.custom-dropdown-option.selected {
    background: rgba(4, 4, 4, 0.903);
    color: #fff;
    font-weight: bold;
}
.custom-dropdown-badge {
    display: inline-block;
    background: linear-gradient(45deg, #ff4500, #ff6347);
    color: #fff;
    border-radius: 3px;
    font-size: 0.7em;
    font-weight: 700;
    padding: 2px 5px;
    margin-left: 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}
.custom-dropdown-badge.free-badge {
    background: linear-gradient(45deg, #358b53, #00b152);
}
.custom-dropdown-badge.legacy-badge {
    background: linear-gradient(45deg, #323232, #000000);
}
.custom-dropdown-badge.legacy-furry-badge {
    background: linear-gradient(45deg, #46005a, #63004e);
}
.custom-dropdown-badge.curated-badge {
    background: linear-gradient(45deg, #0045bd, #004fd8);
}

#manualResolutionGroup.expanded {    
    min-width: 250px;
}
#manualModal .custom-dropdown {
    flex: auto; ;
}
/* Dropup for custom dropdowns */
.custom-dropdown.dropup .custom-dropdown-menu {
    top: auto;
    bottom: 0%;
    margin-top: 0;
}
.custom-dropdown.dropright .custom-dropdown-menu {
    right: 0;
    left: auto;
}
#manualModal #manualModelDropdown {
    min-width: 85px;
}
#manualModelGroup {
    flex: 0 1 auto;
}

/* Custom Preset Dropdown Styles */
.custom-dropdown-header {
    padding: 0.4em 1.2em 0.2em 1.2em;
    font-size: 0.8em;
    color: #8c8c8c;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.85;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    margin-bottom: 0.5em;
}

.custom-dropdown-header i {
    margin-right: 0.5em;
}

.preset-option-content {
    display: flex;
    flex-direction: column;
    gap: 0.3em;
    width: 100%;
}

.preset-name{
    font-weight: bold;
    color: #1a1a1a;
    font-size: 1em;
    overflow-x: clip;
    text-overflow: ellipsis;
}

.preset-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85em;
}

.preset-model {
    color: #666;
    font-style: italic;
}

.preset-icons {
    display: flex;
    gap: 0.3em;
    align-items: center;
}

.preset-icons i {
    font-size: 0.8em;
    color: #ff6347;
    opacity: 0.8;
}

.preset-resolution {
    font-size: 0.8em;
    color: #666;
    text-align: left;
    font-style: italic;
}

.layer-type {
    color: #8c8c8c;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 0.7em;
    letter-spacing: 0.5px;
}

.layer-value {
    color: #666;
    font-style: italic;
}

#customPresetDropdown .custom-dropdown-menu {
    min-width: 300px;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    z-index: 9999;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Update preset dropdown option hover and selected states to match custom dropdown */
#customPresetDropdown .custom-dropdown-option:hover,
#customPresetDropdown .custom-dropdown-option:focus {
    background: rgb(4 4 4 / 50%);
    color: #fff;
}

#customPresetDropdown .custom-dropdown-option:hover .preset-name,
#customPresetDropdown .custom-dropdown-option:focus .preset-name {
    color: #fff;
}

#customPresetDropdown .custom-dropdown-option:hover .preset-model,
#customPresetDropdown .custom-dropdown-option:hover .preset-resolution,
#customPresetDropdown .custom-dropdown-option:hover .layer-value,
#customPresetDropdown .custom-dropdown-option:focus .preset-model,
#customPresetDropdown .custom-dropdown-option:focus .preset-resolution,
#customPresetDropdown .custom-dropdown-option:focus .layer-value {
    color: #ccc;
}

#customPresetDropdown .custom-dropdown-option.selected {
    background: rgba(4, 4, 4, 0.903);
    color: #fff;
    font-weight: bold;
}

#customPresetDropdown .custom-dropdown-option.selected .preset-name,
#customPresetDropdown .custom-dropdown-option.selected .preset-resolution,
#customPresetDropdown .custom-dropdown-option.selected .layer-value {
    color: #ccc;
}

/* Prompt Tabs Styling */
.prompt-tabs {
    border: none;
    border-radius: 0 0 6px 6px;
    overflow: hidden;
}

.tab-header {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    padding: 0;
    margin-bottom: 10px;
}

.tab-buttons {
    display: flex;
    flex: 0 1 auto;
    gap: 8px;
}

.extra-buttons {
    display: flex;
    flex: 0 1 auto;
    gap: 4px;
    margin-left: auto;
}


.tab-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
}

.show-both-btn {
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--bg-quaternary);
    color: var(--text-secondary);
    font-size: 14px;
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid var(--border-secondary);
    min-width: 50px;
    border-radius: var(--border-radius-md);
}

.show-both-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border-color: var(--border-tertiary);
}

.show-both-btn.active {
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 2px 8px var(--shadow-primary);
    border-color: var(--primary-color);
}

.show-both-btn.active:hover {
    box-shadow: 0 5px 15px var(--shadow-primary);
}

.tab-content {
    position: relative;
}

.tab-pane {
    display: none;
}

.tab-pane.active {
    display: block;
}

.tab-pane textarea {
    width: 100%;
    min-height: 120px;
    resize: none;
    outline: none;
}

.tab-pane textarea::placeholder {
    color: #484848;
}

/* Ensure prompt textarea maintains its styling */
.tab-pane #manualPrompt {
    min-height: 80px;
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 1em;
}

.tab-pane #manualUc {
    min-height: 80px;
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 1em;
}

/* Show both panes layout */
.prompt-tabs.show-both .tab-content {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    flex-direction: column;
    align-items: stretch;
}

.prompt-tabs.show-both .tab-pane {
    display: block;
    flex: 1;
}

.prompt-tabs.show-both .tab-pane::before {
    content: attr(data-label);
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #ff4500;
    font-size: 0.95rem;
    text-transform: uppercase;
}

/* Character Prompt Tabs Styling */
.character-prompt-tabs {
    border: none;
    border-radius: 0px;
    overflow: hidden;
    gap: 10px;
    padding: var(--spacing-sm);
    display: flex;
    flex-direction: column;
}

.character-prompt-tabs .tab-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0;
    margin-bottom: 0px;
}

.character-prompt-tabs .tab-buttons {
    display: flex;
    flex: 0 1 auto;
}

.character-prompt-tabs .tab-header .toggle-btn[data-state="on"] {
    transform: none;
}

.character-prompt-controls {
    display: flex;
    align-items: center;
    gap: 5px;
}

/* Additional icon-only toggle button sizing */
.toggle-btn.icon-only {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}


.btn-secondary:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    pointer-events: none;
}

.btn-secondary:disabled:hover {
    transform: none;
    background: var(--bg-secondary);
    border-color: var(--border-color);
}

.character-name-editable {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: 0;
    background: transparent;
    border: 1px solid transparent;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}
.character-name-editable:hover {
    background: var(--bg-tertiary);
    border-color: var(--border-tertiary);
    padding: 0 var(--spacing-md);
    border: 1px solid var(--border-secondary);
}

.character-name-text {
    font-size: 14px;
    font-weight: 500;
    color: #fff;
}

.character-name-editable i {
    font-size: 12px;
    color: #888;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.character-name-editable:hover i {
    opacity: 1;
}

.character-name-input {
    background: var(--bg-tertiary) !important;
    border: 1px solid var(--primary-color) !important;
    color: var(--text-primary) !important;
    outline: none !important;
}

.character-name-input:focus {
    background: rgba(255, 255, 255, 0.25) !important;
    border: 1px solid rgba(255, 255, 255, 1) !important;
}


.character-prompt-tabs .tab-content {
    position: relative;
}

.character-prompt-tabs .tab-pane {
    display: none;
}

.character-prompt-tabs .tab-pane.active {
    display: block;
}

.character-prompt-tabs .tab-pane textarea {
    width: 100%;
    min-height: 80px;
    resize: vertical;
    border: none;
    color: #fff;
    font-size: 1em;
    line-height: 1.5;
    outline: none;
    font-family: 'Share Tech Mono', 'Courier New', monospace;
}

.character-prompt-tabs .tab-pane textarea:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
}

div#manualResolutionDropdownMenu {
    width: 210px;
}

.character-prompt-tabs .tab-pane textarea::placeholder {
    color: #888;
}

.prompt-tabs.show-both .tab-pane textarea {
    min-height: 100px;
}

.inset-badge {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    height: -webkit-fill-available;
    font-size: 1em;
    padding: 2px 0.8em;
    background: var(--glass-inset-bg-3);
    margin-left: 0;
    border-radius: var(--border-radius-md);
    transition: all 0.3s ease;
    color: var(--text-secondary);
    border: 1px solid var(--glass-border-1);
    box-shadow: inset 2px 2px 6px rgb(0 0 0 / 40%);
}

.inset-badge.price-display {
    background: #ff980052;
    color: #ffde7b;
    border-color: #ffeaad3d;
}

.inset-badge.price-display.free {
    background: #96ff992b;
    color: #98ff8a59;
    border-color: #dcffdc4f;
}
.price-label {
    font-weight: 500;
}

/* NovelAI SVG Icons - Using CSS Masks for Color Inheritance */
.nai-variations { 
    -webkit-mask: url('/nai-svg/variations.d35c8a3a.svg') no-repeat center;
    mask: url('/nai-svg/variations.d35c8a3a.svg') no-repeat center;
}
.nai-vibe-transfer { 
    -webkit-mask: url('/nai-svg/vibe_transfer.d54b4b78.svg') no-repeat center;
    mask: url('/nai-svg/vibe_transfer.d54b4b78.svg') no-repeat center;
}
.nai-wand-sparkles { 
    -webkit-mask: url('/nai-svg/wand_sparkles.8c4d1c4e.svg') no-repeat center;
    mask: url('/nai-svg/wand_sparkles.8c4d1c4e.svg') no-repeat center;
}
.nai-text { 
    -webkit-mask: url('/nai-svg/text.995ae72b.svg') no-repeat center;
    mask: url('/nai-svg/text.995ae72b.svg') no-repeat center;
}
.nai-thin-cross { 
    -webkit-mask: url('/nai-svg/thin_cross.6cfb084f.svg') no-repeat center;
    mask: url('/nai-svg/thin_cross.6cfb084f.svg') no-repeat center;
}
.nai-trash { 
    -webkit-mask: url('/nai-svg/trash.72ef2ba9.svg') no-repeat center;
    mask: url('/nai-svg/trash.72ef2ba9.svg') no-repeat center;
}
.nai-upscale { 
    -webkit-mask: url('/nai-svg/upscale.21e62f81.svg') no-repeat center;
    mask: url('/nai-svg/upscale.21e62f81.svg') no-repeat center;
}
.nai-small-cross { 
    -webkit-mask: url('/nai-svg/small_cross.8d803d20.svg') no-repeat center;
    mask: url('/nai-svg/small_cross.8d803d20.svg') no-repeat center;
}
.nai-sparkles { 
    -webkit-mask: url('/nai-svg/sparkles.b1e1a420.svg') no-repeat center;
    mask: url('/nai-svg/sparkles.b1e1a420.svg') no-repeat center;
}
.nai-pin { 
    -webkit-mask: url('/nai-svg/pin.8a391c7b.svg') no-repeat center;
    mask: url('/nai-svg/pin.8a391c7b.svg') no-repeat center;
}
.nai-plus { 
    -webkit-mask: url('/nai-svg/plus.dc778eb7.svg') no-repeat center;
    mask: url('/nai-svg/plus.dc778eb7.svg') no-repeat center;
}
.nai-quick-start-gallery { 
    -webkit-mask: url('/nai-svg/quick_start_gallery.602a1b35.svg') no-repeat center;
    mask: url('/nai-svg/quick_start_gallery.602a1b35.svg') no-repeat center;
}
.nai-sakura { 
    -webkit-mask: url('/nai-svg/sakura.685bbe60.svg') no-repeat center;
    mask: url('/nai-svg/sakura.685bbe60.svg') no-repeat center;
}
.nai-paw {
    -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg>');
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg>');
}

.nai-scale {
    content: "âš–ï¸";
}
.nai-save { 
    -webkit-mask: url('/nai-svg/save.36b86afc.svg') no-repeat center;
    mask: url('/nai-svg/save.36b86afc.svg') no-repeat center;
}
.nai-seed { 
    -webkit-mask: url('/nai-svg/seed.8a1df676.svg') no-repeat center;
    mask: url('/nai-svg/seed.8a1df676.svg') no-repeat center;
}
.nai-settings { 
    -webkit-mask: url('/nai-svg/settings.37ac2cdf.svg') no-repeat center;
    mask: url('/nai-svg/settings.37ac2cdf.svg') no-repeat center;
}
.nai-shelficon { 
    -webkit-mask: url('/nai-svg/shelficon.51f6a18f.svg') no-repeat center;
    mask: url('/nai-svg/shelficon.51f6a18f.svg') no-repeat center;
}
.nai-small-arrow { 
    -webkit-mask: url('/nai-svg/small_arrow.1099f431.svg') no-repeat center;
    mask: url('/nai-svg/small_arrow.1099f431.svg') no-repeat center;
}
.nai-person { 
    -webkit-mask: url('/nai-svg/person.8fffa0a6.svg') no-repeat center;
    mask: url('/nai-svg/person.8fffa0a6.svg') no-repeat center;
}
.nai-opus { 
    -webkit-mask: url('/nai-svg/opus.e28dcb4d.svg') no-repeat center;
    mask: url('/nai-svg/opus.e28dcb4d.svg') no-repeat center;
}
.nai-pen-tip-light { 
    -webkit-mask: url('/nai-svg/pen-tip-light.47883c90.svg') no-repeat center;
    mask: url('/nai-svg/pen-tip-light.47883c90.svg') no-repeat center;
}
.nai-pen { 
    -webkit-mask: url('/nai-svg/pen.87137c5d.svg') no-repeat center;
    mask: url('/nai-svg/pen.87137c5d.svg') no-repeat center;
}
.nai-penwriting { 
    -webkit-mask: url('/nai-svg/penwriting.3c214126.svg') no-repeat center;
    mask: url('/nai-svg/penwriting.3c214126.svg') no-repeat center;
}
.nai-help { 
    -webkit-mask: url('/nai-svg/help.98e947de.svg') no-repeat center;
    mask: url('/nai-svg/help.98e947de.svg') no-repeat center;
}
.nai-history { 
    -webkit-mask: url('/nai-svg/history.b9b000e8.svg') no-repeat center;
    mask: url('/nai-svg/history.b9b000e8.svg') no-repeat center;
}
.nai-image-count { 
    -webkit-mask: url('/nai-svg/image_count.de68b045.svg') no-repeat center;
    mask: url('/nai-svg/image_count.de68b045.svg') no-repeat center;
}
.nai-image-placeholder-even { 
    -webkit-mask: url('/nai-svg/image_placeholder_even.e513ece2.svg') no-repeat center;
    mask: url('/nai-svg/image_placeholder_even.e513ece2.svg') no-repeat center;
}
.nai-image-placeholder-odd { 
    -webkit-mask: url('/nai-svg/image_placeholder_odd.953f280d.svg') no-repeat center;
    mask: url('/nai-svg/image_placeholder_odd.953f280d.svg') no-repeat center;
}
.nai-import { 
    -webkit-mask: url('/nai-svg/import.a2828e2c.svg') no-repeat center;
    mask: url('/nai-svg/import.a2828e2c.svg') no-repeat center;
}

.nai-folder { 
    -webkit-mask: url('/nai-svg/folder.svg') no-repeat center;
    mask: url('/nai-svg/folder.svg') no-repeat center;
}
.nai-inpaint { 
    -webkit-mask: url('/nai-svg/inpaint.aaefedb9.svg') no-repeat center;
    mask: url('/nai-svg/inpaint.aaefedb9.svg') no-repeat center;
}
.nai-lang-en { 
    -webkit-mask: url('/nai-svg/lang_en.c6828b78.svg') no-repeat center;
    mask: url('/nai-svg/lang_en.c6828b78.svg') no-repeat center;
}
.nai-logout { 
    -webkit-mask: url('/nai-svg/logout.0b906fff.svg') no-repeat center;
    mask: url('/nai-svg/logout.0b906fff.svg') no-repeat center;
}
.nai-magglass { 
    -webkit-mask: url('/nai-svg/magglass.28078752.svg') no-repeat center;
    mask: url('/nai-svg/magglass.28078752.svg') no-repeat center;
}
.nai-discord { 
    -webkit-mask: url('/nai-svg/discord.9998396f.svg') no-repeat center;
    mask: url('/nai-svg/discord.9998396f.svg') no-repeat center;
}
.nai-dotdotdot { 
    -webkit-mask: url('/nai-svg/dotdotdot.97bb8a73.svg') no-repeat center;
    mask: url('/nai-svg/dotdotdot.97bb8a73.svg') no-repeat center;
}
.nai-easel { 
    -webkit-mask: url('/nai-svg/easel.a9aec978.svg') no-repeat center;
    mask: url('/nai-svg/easel.a9aec978.svg') no-repeat center;
}
.nai-export { 
    -webkit-mask: url('/nai-svg/export.235cebdc.svg') no-repeat center;
    mask: url('/nai-svg/export.235cebdc.svg') no-repeat center;
}
.nai-funnel-empty { 
    -webkit-mask: url('/nai-svg/funnelEmpty.8b01f76a.svg') no-repeat center;
    mask: url('/nai-svg/funnelEmpty.8b01f76a.svg') no-repeat center;
}
.nai-hamburger-alt { 
    -webkit-mask: url('/nai-svg/hamburger_alt.ec19c7ae.svg') no-repeat center;
    mask: url('/nai-svg/hamburger_alt.ec19c7ae.svg') no-repeat center;
}
.nai-heart-disabled { 
    -webkit-mask: url('/nai-svg/heart_disabled.208bfe74.svg') no-repeat center;
    mask: url('/nai-svg/heart_disabled.208bfe74.svg') no-repeat center;
}
.nai-heart-enabled { 
    -webkit-mask: url('/nai-svg/heart_enabled.3dfca10c.svg') no-repeat center;
    mask: url('/nai-svg/heart_enabled.3dfca10c.svg') no-repeat center;
}
.nai-clipboard { 
    -webkit-mask: url('/nai-svg/clipboard.579cb9e6.svg') no-repeat center;
    mask: url('/nai-svg/clipboard.579cb9e6.svg') no-repeat center;
}
.nai-detatch-up { 
    -webkit-mask: url('/nai-svg/detatch_up.5a8391cb.svg') no-repeat center;
    mask: url('/nai-svg/detatch_up.5a8391cb.svg') no-repeat center;
}
.nai-dice { 
    -webkit-mask: url('/nai-svg/dice.d52243c6.svg') no-repeat center;
    mask: url('/nai-svg/dice.d52243c6.svg') no-repeat center;
}
.nai-directional-arrow-down { 
    -webkit-mask: url('/nai-svg/directional_arrow_down.3046336d.svg') no-repeat center;
    mask: url('/nai-svg/directional_arrow_down.3046336d.svg') no-repeat center;
}
.nai-directional-arrow-left { 
    -webkit-mask: url('/nai-svg/directional_arrow_left.d2437171.svg') no-repeat center;
    mask: url('/nai-svg/directional_arrow_left.d2437171.svg') no-repeat center;
}
.nai-directional-arrow-right { 
    -webkit-mask: url('/nai-svg/directional_arrow_right.7d4cdcfe.svg') no-repeat center;
    mask: url('/nai-svg/directional_arrow_right.7d4cdcfe.svg') no-repeat center;
}
.nai-directional-arrow-up { 
    -webkit-mask: url('/nai-svg/directional_arrow_up.22936b44.svg') no-repeat center;
    mask: url('/nai-svg/directional_arrow_up.22936b44.svg') no-repeat center;
}
.nai-anla { 
    -webkit-mask: url('/nai-svg/anla.23c99491.svg') no-repeat center;
    mask: url('/nai-svg/anla.23c99491.svg') no-repeat center;
}
.nai-book-open { 
    -webkit-mask: url('/nai-svg/book-open.e6d9fcb0.svg') no-repeat center;
    mask: url('/nai-svg/book-open.e6d9fcb0.svg') no-repeat center;
}
.nai-check { 
    -webkit-mask: url('/nai-svg/check.c906eb0a.svg') no-repeat center;
    mask: url('/nai-svg/check.c906eb0a.svg') no-repeat center;
}
.nai-aa { 
    -webkit-mask: url('/nai-svg/Aa.1034ae44.svg') no-repeat center;
    mask: url('/nai-svg/Aa.1034ae44.svg') no-repeat center;
}
.nai-circles-centered { 
    -webkit-mask: url('/nai-svg/circles_centered.1238f30d.svg') no-repeat center;
    mask: url('/nai-svg/circles_centered.1238f30d.svg') no-repeat center;
}
.nai-cross { 
    -webkit-mask: url('/nai-svg/cross.fac5a02a.svg') no-repeat center;
    mask: url('/nai-svg/cross.fac5a02a.svg') no-repeat center;
}
.nai-dropper { 
    -webkit-mask: url('/nai-svg/dropper.78b85b64.svg') no-repeat center;
    mask: url('/nai-svg/dropper.78b85b64.svg') no-repeat center;
}
.nai-empty-sparkles { 
    -webkit-mask: url('/nai-svg/empty_sparkles.4c1b822d.svg') no-repeat center;
    mask: url('/nai-svg/empty_sparkles.4c1b822d.svg') no-repeat center;
}
.nai-eraser { 
    -webkit-mask: url('/nai-svg/eraser.0ec62cc8.svg') no-repeat center;
    mask: url('/nai-svg/eraser.0ec62cc8.svg') no-repeat center;
}
.nai-fold { 
    -webkit-mask: url('/nai-svg/fold.faaf6d0f.svg') no-repeat center;
    mask: url('/nai-svg/fold.faaf6d0f.svg') no-repeat center;
}
.nai-image-tool-colorize { 
    -webkit-mask: url('/nai-svg/image_tool_colorize.6baf2425.svg') no-repeat center;
    mask: url('/nai-svg/image_tool_colorize.6baf2425.svg') no-repeat center;
}
.nai-image-tool-declutter { 
    -webkit-mask: url('/nai-svg/image_tool_declutter.7848744c.svg') no-repeat center;
    mask: url('/nai-svg/image_tool_declutter.7848744c.svg') no-repeat center;
}
.nai-image-tool-emotion { 
    -webkit-mask: url('/nai-svg/image_tool_emotion.bca3218f.svg') no-repeat center;
    mask: url('/nai-svg/image_tool_emotion.bca3218f.svg') no-repeat center;
}
.nai-image-tool-line-art { 
    -webkit-mask: url('/nai-svg/image_tool_line_art.99b08a4e.svg') no-repeat center;
    mask: url('/nai-svg/image_tool_line_art.99b08a4e.svg') no-repeat center;
}
.nai-image-tool-remove-bg { 
    -webkit-mask: url('/nai-svg/image_tool_remove_bg.be09ccf1.svg') no-repeat center;
    mask: url('/nai-svg/image_tool_remove_bg.be09ccf1.svg') no-repeat center;
}
.nai-image-tool-sketch { 
    -webkit-mask: url('/nai-svg/image_tool_sketch.8bd2cc8b.svg') no-repeat center;
    mask: url('/nai-svg/image_tool_sketch.8bd2cc8b.svg') no-repeat center;
}
.nai-img2img { 
    -webkit-mask: url('/nai-svg/img2img.aa3e7184.svg') no-repeat center;
    mask: url('/nai-svg/img2img.aa3e7184.svg') no-repeat center;
}
.nai-minus { 
    -webkit-mask: url('/nai-svg/minus.3db8267d.svg') no-repeat center;
    mask: url('/nai-svg/minus.3db8267d.svg') no-repeat center;
}
.nai-redo { 
    -webkit-mask: url('/nai-svg/redo.c8b50748.svg') no-repeat center;
    mask: url('/nai-svg/redo.c8b50748.svg') no-repeat center;
}
.nai-resize { 
    -webkit-mask: url('/nai-svg/resize.9b598e1b.svg') no-repeat center;
    mask: url('/nai-svg/resize.9b598e1b.svg') no-repeat center;
}
.nai-select { 
    -webkit-mask: url('/nai-svg/select.429034b7.svg') no-repeat center;
    mask: url('/nai-svg/select.429034b7.svg') no-repeat center;
}
.nai-undo { 
    -webkit-mask: url('/nai-svg/undo.d181fecf.svg') no-repeat center;
    mask: url('/nai-svg/undo.d181fecf.svg') no-repeat center;
}
.nai-unfold { 
    -webkit-mask: url('/nai-svg/unfold.df1e363f.svg') no-repeat center;
    mask: url('/nai-svg/unfold.df1e363f.svg') no-repeat center;
}
.nai-reload { 
    -webkit-mask: url('/nai-svg/reload.bd9372a2.svg') no-repeat center;
    mask: url('/nai-svg/reload.bd9372a2.svg') no-repeat center;
}

/* Make all nai-* icons display as inline-block with proper sizing and color inheritance */
[class^="nai-"] {
    display: inline-block;
    width: 1em;
    height: 1em;
    vertical-align: middle;
    background: currentColor;
    -webkit-mask-size: contain;
    mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
    color: inherit;
}

button#layer1SeedToggle {
    padding-left: 0px;
    padding-right: 0px;
}

/* Mask Bias Dropdown Styles */
.mask-bias-option-content {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
}

.mask-bias-grid {
    display: grid;
    gap: 0;
    width: 20px;
    height: 20px;
    border: 1px solid rgb(255 133 47 / 60%);
    border-radius: 4px;
    background: rgb(0 0 0 / 23%);
    flex-shrink: 0;
}

/* Portrait: 3 columns, 5 rows */
.mask-bias-grid[data-orientation="portrait"] {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(5, 1fr);
}

/* Landscape: 5 columns, 3 rows */
.mask-bias-grid[data-orientation="landscape"] {
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(3, 1fr);
}


/* Portrait: 3 columns, 5 rows */
.mask-bias-grid[data-bias="custom"][data-orientation="portrait"],
.mask-bias-grid[data-bias="custom"][data-orientation="landscape"] {
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
}

.mask-bias-grid .grid-cell {
    background: var(--glass-layer-2);
    border-radius: 1px;
    transition: all var(--transition-normal);
}

/* Portrait Layout (3 columns, 5 rows) - highlight rows for each bias */
.mask-bias-grid[data-orientation="portrait"][data-bias="0"] .grid-cell:nth-child(-n+3) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="1"] .grid-cell:nth-child(n+4):nth-child(-n+6) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="2"] .grid-cell:nth-child(n+7):nth-child(-n+9) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="3"] .grid-cell:nth-child(n+10):nth-child(-n+12) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="4"] .grid-cell:nth-child(n+13):nth-child(-n+15) {
    background: rgb(228 94 0 / 80%);
}

/* Landscape Layout (5 columns, 3 rows) */
/* Bias 0: Left - first column */
.mask-bias-grid[data-orientation="landscape"][data-bias="0"] .grid-cell:nth-child(1),
.mask-bias-grid[data-orientation="landscape"][data-bias="0"] .grid-cell:nth-child(6),
.mask-bias-grid[data-orientation="landscape"][data-bias="0"] .grid-cell:nth-child(11) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 1: Left-Mid - second column */
.mask-bias-grid[data-orientation="landscape"][data-bias="1"] .grid-cell:nth-child(2),
.mask-bias-grid[data-orientation="landscape"][data-bias="1"] .grid-cell:nth-child(7),
.mask-bias-grid[data-orientation="landscape"][data-bias="1"] .grid-cell:nth-child(12) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 2: Center - third column */
.mask-bias-grid[data-orientation="landscape"][data-bias="2"] .grid-cell:nth-child(3),
.mask-bias-grid[data-orientation="landscape"][data-bias="2"] .grid-cell:nth-child(8),
.mask-bias-grid[data-orientation="landscape"][data-bias="2"] .grid-cell:nth-child(13) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 3: Right-Mid - fourth column */
.mask-bias-grid[data-orientation="landscape"][data-bias="3"] .grid-cell:nth-child(4),
.mask-bias-grid[data-orientation="landscape"][data-bias="3"] .grid-cell:nth-child(9),
.mask-bias-grid[data-orientation="landscape"][data-bias="3"] .grid-cell:nth-child(14) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 4: Right - fifth column */
.mask-bias-grid[data-orientation="landscape"][data-bias="4"] .grid-cell:nth-child(5),
.mask-bias-grid[data-orientation="landscape"][data-bias="4"] .grid-cell:nth-child(10),
.mask-bias-grid[data-orientation="landscape"][data-bias="4"] .grid-cell:nth-child(15) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(1),
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(6),
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(11),
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(16) {
    background: rgb(228 94 0 / 80%);
}

.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(4),
.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(7),
.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(10),
.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(13) {
    background: rgb(228 94 0 / 80%);
}


.mask-bias-label {
    flex-grow: 1;
}

.mask-bias-button-content {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
}

.mask-bias-button-content .mask-bias-grid {
    width: 20px;
    height: 20px;
}

.custom-dropdown-option.selected .mask-bias-grid {
    border-color: rgb(255 133 47 / 60%);
    background: var(--glass-layer-2);
}

/* Mask Editor Styles */
.mask-editor-content {
    max-width: 1200px;
    max-height: 90vh;
    width: 90vw;
    background: var(--glass-layer-4);
    backdrop-filter: blur(var(--glass-blur-4));
    border: 1px solid var(--glass-border-4);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-4);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.mask-editor-body {
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: var(--spacing-lg);
}

.mask-editor-tools {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    flex-wrap: wrap;
    padding: var(--spacing-md);
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
}

.brush-size-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-right: auto;
}

.brush-size-control label {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin: 0;
}

.brush-size-control input[type="range"] {
    width: 100px;
    margin: 0;
}

.brush-size-control span {
    font-size: 0.9rem;
    color: var(--text-primary);
    font-weight: 600;
    min-width: 30px;
    text-align: center;
}

.mask-editor-canvas-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 400px;
    position: relative;
    background: #0000005c;
}

.mask-editor-canvas-inner {
    border-radius: var(--border-radius-lg);
    position: relative;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-height: 60vh;
    aspect-ratio: var(--background-aspect-ratio, auto);
}

.mask-editor-canvas-inner::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-image: var(--background-image, none);
    background-size: var(--background-size, contain);
    background-repeat: no-repeat;
    background-position: center;
    opacity: 1;
    pointer-events: none;
    z-index: 1;
    width: var(--background-width, 100%);
    height: var(--background-height, 100%);
    aspect-ratio: var(--background-aspect-ratio, auto);
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

#maskCanvas,
#maskBrushPreviewCanvas {
    cursor: none;
    background: transparent;
    width: 100%;
    height: 100%;
    position: relative;
    z-index: 2;
    opacity: 0.75;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    object-fit: contain;
}

#maskCanvas {
    opacity: 0.95;
}

.mask-editor-actions {
    display: flex;
    gap: var(--spacing-md);
    justify-content: flex-end;
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--glass-border-2);
}

/* Responsive adjustments for mask editor */
@media (max-width: 768px) {
    .mask-editor-content {
        width: 95vw;
        max-height: 95vh;
    }
    
    .mask-editor-tools {
        flex-direction: column;
        align-items: stretch;
    }
    
    .brush-size-control {
        margin-left: 0;
        justify-content: center;
    }
    
    .mask-editor-canvas-container {
        min-height: 300px;
    }
    
    #maskCanvas {
        max-width: 90%;
        max-height: 90%;
    }
    
    .mask-editor-actions {
        flex-direction: column;
    }
    
    .mask-editor-actions button {
        width: 100%;
    }
}


.no-images {
    grid-column: 1 / -1;
    text-align: center;
    padding: 50px;
    color: #666;
    font-size: 1.2rem;
}

.upscale-btn {
    font-size: 0.9rem;
    padding: 8px 16px;
}

/* Glass style slider row */
.slider-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Glass style slider */
.modal-content .glass-slider:focus,
.modal-content .glass-slider:active,
.glass-slider {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 0px;
  background: transparent;
  border-radius: var(--border-radius-md);
  box-shadow: none;
  outline: none;
  border: none;
  position: relative;
  min-height: 20px;
  padding: 0;
}
.glass-slider::-webkit-slider-runnable-track {
  height: 0px;
  background: transparent;
  border-radius: var(--border-radius-md);
  box-shadow: none;
}
.glass-slider::-ms-fill-lower,
.glass-slider::-ms-fill-upper {
  background: transparent;
  border-radius: var(--border-radius-md);
  box-shadow: none;
}
.glass-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 22px;
  height: 20px;
  background: var(--glass-layer-3);
  border: 1.5px solid var(--glass-border-3);
  border-radius: var(--border-radius-md);
  box-shadow: var(--glass-shadow-3);
  margin-top: -10px;
  cursor: pointer;
  transition: none;
}
.glass-slider::-ms-thumb {
  width: 22px;
  height: 20px;
  background: var(--glass-layer-3);
  border: 1.5px solid var(--glass-border-3);
  border-radius: var(--border-radius-md);
  box-shadow: var(--glass-shadow-3);
  cursor: pointer;
  margin-top: -10px;
  transition: none;
}
/* Remove default outline for Firefox */
.glass-slider::-moz-focus-outer {
  border: 0;
}

/* Value input for slider */
.slider-value-input {
  text-align: left;
  font-size: 1em;
  font-family: 'Oxanium', 'Courier New', monospace;
  color: #ffcfbd;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--border-radius-md);
  transition: all var(--transition-normal);
  box-shadow: none;
  min-width: 48px;
  padding: 0.35em 0.6em;
}
.slider-value-input:hover, .slider-value-input:focus {
  background: var(--glass-layer-3);
  border: 1px solid var(--glass-border-3);
  box-shadow: var(--glass-shadow-3);
  outline: none;
}

/* Character Prompt Collapse/Expand Styles */
.character-prompt-item {
    position: relative;
    transition: all var(--transition-normal);
}

.character-prompt-item.collapsed .tab-buttons,
.character-prompt-item.collapsed .tab-content {
    display: none !important;
}

.character-prompt-item.collapsed .character-prompt-controls {
    display: flex !important;
}

.character-prompt-collapse-toggle {
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    color: var(--text-primary);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.8rem;
    font-weight: 600;
    z-index: var(--z-layer-3);
    box-shadow: var(--glass-shadow-3);
}

.character-prompt-collapse-toggle:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    color: var(--text-primary);
    z-index: var(--z-layer-4);
}

.character-prompt-collapse-toggle i {
    transition: transform var(--transition-normal);
}

.character-prompt-item.collapsed .character-prompt-collapse-toggle i {
    transform: rotate(180deg);
}

.character-prompt-preview {
    display: none;
    margin: 0px;
    min-height: 32px;
    padding: 0em 0.6em;
    background: var(--glass-layer-2);
    color: var(--text-primary);
    border: 1px solid var(--glass-border-3);
    box-shadow: inset 0 2px 4px rgb(62 24 0 / 58%), inset 0 0 8px rgb(83 38 0 / 19%), 0 0 0 1px rgb(0 0 0 / 32%);
    border-radius: var(--border-radius-md);
    box-shadow: var(--glass-shadow-2);
    cursor: pointer;
    transition: all var(--transition-normal);
    flex: 1 0 auto;
}

.character-prompt-item.collapsed .character-prompt-preview {
    display: inline-flex;
}

.character-prompt-preview input:focus,
.character-prompt-preview input {
    width: 100%;
    resize: none;
    background: transparent;
    border: none;
    color: var(--text-primary);
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 0.9em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: pointer;
    outline: none;
    padding: 0;
}

.character-prompt-preview input::placeholder {
    color: var(--text-muted);
    font-style: italic;
}

/* Ensure the character name is always visible in collapsed state */
.character-prompt-item.collapsed .character-name-editable {
    display: flex !important;
    margin-right: var(--spacing-md);
}

/* Hide tab buttons in collapsed state */
.character-prompt-item.collapsed .tab-buttons {
    display: none !important;
}

/* Show character name in collapsed state */
.character-prompt-item.collapsed .tab-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 25px;
}

/* Adjust spacing for collapsed state */
.character-prompt-item.collapsed .tab-header {
    margin-bottom: 0;
}

/* Animation for smooth collapse/expand */
.character-prompt-tabs {
    transition: all var(--transition-normal);
}

.character-prompt-item.collapsed .character-prompt-tabs {
    min-height: auto;
}

/* Manual Modal Loading Overlay Styles */
.manual-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-layer-10);
    border-radius: var(--border-radius-xl);
}

.manual-loading-overlay.hidden {
    display: none;
}

.manual-loading-content {
    text-align: center;
    color: var(--text-primary);
    background: rgb(255 255 255 / 63%);
    padding: 30px;
    border-radius: var(--border-radius-lg);
    border: 1px solid var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    max-width: 300px;
    width: 90%;
}

.manual-loading-content p {
    margin: 15px 0 0 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--primary-color);
}

.manual-loading-content .spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--glass-layer-2);
    border-top: 3px solid var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

.bokeh-background {
    height: 100vh;
    width: 100vw;
    position: fixed;
    top: 0;
    left: 0;
    transform: translateZ(0);
    backface-visibility: hidden;
    transition: opacity 3s ease-in-out, background-color 3s ease-in-out;
    z-index: -2;
    will-change: opacity, background-color, background-image;
}

.bokeh {
    height: 130vh;
    width: 130vw;
    position: fixed;
    top: -15vh;
    left: -15vw;
    transform: translateZ(0);
    backface-visibility: hidden;
    z-index: -1;
    transition: background-color 3s ease-in-out;
    will-change: background-color, opacity;
}
.header-left, .header-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: 0;;
}

.bokeh circle {
  animation: rotate 120s linear infinite;
  fill: #124;
  opacity: 0.43;
  transform-origin: 50%;
  filter: blur(0.04px);
  transition: fill 3s ease-in-out, opacity 3s ease-in-out, transform 0.6s ease-in-out;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(2n) {
  fill: #614;
  transform-origin: 20% 110%;
  animation-delay: -60s;
  animation-duration: 82.632s;
  opacity: 0.2;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(3n) {
  opacity: 0.65;
  fill: #469;
  transform-origin: 70% 30%;
  animation-delay: -30s;
  animation-duration: 159.996s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(4n) {
  fill: #c63;
  transform-origin: 110% 70%;
  animation-delay: -40s;
  animation-duration: 95.5992s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(5n) {
  fill: #266;
  transform-origin: 30% 40%;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(6n) {
  fill: #124;
  transform-origin: -10% 80%;
  animation-delay: -156s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(7n) {
  fill: #614;
  transform-origin: 70% -10%;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(8n) {
  fill: #c63;
  transform-origin: -30% 50%;
  animation-delay: -48s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(9n) {
  fill: #469;
  transform-origin: 40% 90%;
  animation-delay: -72s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(10n) {
  fill: #614;
  transform-origin: 90% 20%;
  animation-delay: -36s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(11n) {
  fill: #124;
  transform-origin: 20% 10%;
  animation-delay: -84s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(12n) {
  fill: #c63;
  transform-origin: 85% 80%;
  animation-delay: -54s;
  will-change: fill, opacity, transform;
}
.bokeh circle:nth-child(13n) {
  fill: #266;
  transform-origin: 10% 60%;
  animation-delay: -66s;
  will-change: fill, opacity, transform;
}

@keyframes rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.footer-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    flex: auto;
}

/* Cache Browser Modal */
.cache-browser-content {
    width: 90%;
    max-width: 1200px;
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.cache-browser-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    background: var(--glass-layer-3);
    border-bottom: 1px solid var(--glass-border-3);
    flex-shrink: 0;
}

.cache-browser-header h3 {
    color: var(--text-primary);
    margin: 0;
    font-size: 1.2em;
}

.cache-browser-body {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.cache-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: var(--spacing-md);
    padding: var(--spacing-lg);
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1;
    align-content: start;
    min-height: 0;
}

.modal-body .cache-gallery {
    max-height: 55vh;
}

/* Custom scrollbar for cache gallery */
.cache-gallery::-webkit-scrollbar {
    width: 8px;
}

.cache-gallery::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.cache-gallery::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.cache-gallery::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

/* Stretch items when there are few items */
.cache-gallery.few-items {
    align-content: stretch;
}

.cache-gallery.few-items .cache-gallery-item {
    height: auto;
}

.cache-gallery-item {
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: all var(--transition-normal);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    background: var(--glass-layer-2);
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
}

.cache-gallery-item:hover {
    transform: translateY(-3px);
    border-color: var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    background: var(--glass-layer-4);
    z-index: var(--z-layer-4);
}

.cache-gallery-item img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    display: block;
}

.cache-gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    color: var(--text-primary);
    padding: 12px;
    opacity: 0;
    transition: opacity var(--transition-normal);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.cache-gallery-item:hover .cache-gallery-item-overlay {
    opacity: 1;
}

.cache-gallery-item-info {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin-top: auto;
}

.cache-delete-btn {
    background: rgba(220, 53, 69, 0.9);
    color: white;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s ease;
    flex-shrink: 0;
    position: absolute;
    top: 8px;
    right: 8px;
}

.cache-delete-btn:hover {
    background: rgba(220, 53, 69, 1);
}

.cache-delete-btn i {
    font-size: 14px;
}

.default-workspace-badge {
    position: absolute;
    top: 8px;
    left: 8px;
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: bold;
    z-index: 10;
    pointer-events: none;
}

.cache-browser-tabs .tab-buttons {
    display: flex;
    gap: var(--spacing-sm);
}

.cache-browser-tabs .tab-btn {
    background: var(--glass-layer-3);
    color: #ffffff;
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 0.9rem;
}

.cache-browser-tabs .tab-btn:hover {
    background: var(--glass-layer-2);
    color: var(--text-primary);
}

.cache-browser-tabs .tab-btn.active {
    background: var(--primary-color);
    color: white;
    border-bottom: 2px solid var(--accent-color);
}

.cache-browser-tabs .tab-btn i {
    font-size: 1rem;
}

.cache-browser-body .tab-pane {
    display: none;
    overflow-y: auto;
}

.cache-browser-body .tab-pane.active {
    display: block;
}

.transforms-container { 
    min-height: 210px;
    height: 210px;
    gap: var(--spacing-sm);
}

/* Vibe References Header */
.vibe-references-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-md);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--border-secondary);
}

.vibe-references-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
}

.vibe-references-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

/* Vibe References Container */
.vibe-references-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: ". .";
    width: 100%;
    gap: var(--spacing-sm);
    height: 100%;
}

.vibe-reference-item {
    display: flex;
    flex-direction: column;
    position: relative;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    overflow: hidden;
    transition: all var(--transition-normal);
}

.vibe-reference-preview-container {
    display: flex;
    position: relative;
    width: 100%;
    flex: 1;
    align-items: flex-start;
    justify-content: center;
    max-height: -webkit-fill-available;
}

.vibe-reference-preview {
    max-width: -webkit-fill-available;
    max-height: -webkit-fill-available;
    object-fit: cover;
    display: block;
    position: absolute;
}

.overlay-icon-container {
    position: absolute;
    left: 0;
    bottom: 0;
    padding: 0.75em;
    display: flex;
    gap: 0.6em;
    opacity: 0.85;
    color: #ffe1aa;
}

.vibe-reference-controls {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    gap: 4px;
}

.vibe-reference-delete-btn {
    background: rgba(220, 53, 69, 0.9);
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s ease;
    font-size: 12px;
}

.vibe-reference-delete-btn:hover {
    background: rgba(220, 53, 69, 1);
}

.vibe-reference-info {
    padding: var(--spacing-sm);
    display: flex;
    flex-direction: row;
    gap: var(--spacing-xs);
    justify-content: space-between;
}

.vibe-reference-ie-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    flex: 1;
}

.vibe-reference-ratio-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.vibe-reference-ratio-input {
    flex: 1;
    font-size: 0.8rem;
    padding: 2px 6px;
    text-align: center;
}

/* Remove spinner buttons from number inputs */
.vibe-reference-ratio-input::-webkit-outer-spin-button,
.vibe-reference-ratio-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.vibe-reference-ratio-input[type=number] {
    -moz-appearance: textfield;
}

/* Disabled vibe reference items */
.cache-gallery-item.disabled {
    opacity: 0.5;
    filter: grayscale(0.5);
    pointer-events: none;
}

.cache-gallery-item.disabled .cache-gallery-item-overlay {
    background: rgba(0, 0, 0, 0.3);
}

.cache-gallery-item.disabled .cache-delete-btn {
    opacity: 0.3;
    cursor: not-allowed;
}

/* Cache Browser Container (Desktop Only) */
.cache-browser-container {
    background: var(--glass-layer-3);
    backdrop-filter: blur(var(--glass-blur-3));
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg);
    display: none;
    flex-direction: column;
    z-index: var(--z-layer-5);
    height: 100%;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal-actions {
    margin-top: var(--spacing-xxl);
}

/* Panel management using data-active-panel attribute */
.manual-modal-preview-section[data-active-panel="cache-browser"] .manual-preview-container {
    display: none !important;
}

.manual-modal-preview-section[data-active-panel="cache-browser"] .cache-browser-container {
    display: flex !important;
}

/* Default state - show manual preview, hide cache browser */
.manual-modal-preview-section:not([data-active-panel]) .cache-browser-container {
    display: none !important;
}

.cache-browser-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xxl);
    color: var(--text-secondary);
}

.cache-browser-loading .spinner {
    margin-bottom: var(--spacing-lg);
}

.cache-browser-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Image Bias Adjustment Modal Styles */
.image-bias-adjustment-content {
    max-width: 1200px;
    width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    height: auto;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.image-bias-adjustment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.image-bias-adjustment-header h3 {
    margin: 0;
    color: #fff;
    font-size: 1.5rem;
    font-weight: 600;
}

.image-bias-adjustment-body {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    gap: 24px;
}

.bias-controls-section {
    flex: none;
    display: flex;
    flex-direction: row;
    gap: 20px;
    align-items: center;
}
.bias-controls-section.main-controls {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    flex-wrap: wrap;
    padding: var(--spacing-md);
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
}

.bias-controls-grid {
    display: flex;
    flex-direction: row;
    gap: 16px;
    align-items: end;
    justify-content: space-between;
    flex: 1
}

.bias-control-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.bias-control-group label {
    color: #ccc;
    font-size: 0.9rem;
    font-weight: 500;
}

.bias-test-section {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.bias-test-results {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 16px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.test-result-item {
    display: flex;
    align-items: center;
    gap: 12px;
}

.test-label {
    color: #ccc;
    font-size: 0.85rem;
    font-weight: 500;
    min-width: 80px;
}

.test-result-item img {
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.image-preview-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 0;
}



.client-preview-image {
    position: absolute;
    top: 2em;
    left: 2em;
    width: calc(100% - 4em);
    height: calc(100% - 4em);
    object-fit: contain;
    pointer-events: none;
}

.image-preview-container {
    flex: 1;
    position: relative;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    min-height: 400px;
    padding: 2em;
}

.target-area-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 10;
}

.target-area-border {
    border: 2px dotted rgba(255, 255, 255, 0.6);
    border-radius: 4px;
}

.bias-adjustment-image {
    object-fit: cover;
    cursor: grab;
    transition: transform 0.1s ease;
    user-select: none;
    position: absolute;
    top: 0;
    left: 0;
    transform-origin: top left;
}

.bias-adjustment-image:active {
    cursor: grabbing;
}

.image-info {
    display: flex;
    gap: 24px;
    padding: 16px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.info-label {
    color: #ccc;
    font-size: 0.8rem;
    font-weight: 500;
}

.info-item span:last-child {
    color: #fff;
    font-size: 0.9rem;
    font-weight: 600;
}

.image-bias-adjustment-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    padding: 20px 0 0 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

/* Responsive Design */
@media (max-width: 768px) {
    .image-bias-adjustment-content {
        width: 95vw;
        max-height: 95vh;
    }
    
    .image-bias-adjustment-body {
        gap: 16px;
    }
    
    .bias-controls-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }
    
    .bias-control-group:last-child {
        grid-column: 1 / -1;
    }
    
    .image-preview-container {
        min-height: 300px;
    }
    
    .image-info {
        flex-direction: column;
        gap: 12px;
    }
    
    .image-bias-adjustment-actions {
        flex-direction: column;
    }
    
    .image-bias-adjustment-actions button {
        width: 100%;
    }
}

@media (max-width: 480px) {
    .bias-controls-grid {
        grid-template-columns: 1fr;
    }
    
    .image-preview-container {
        min-height: 250px;
    }
}

/* Bias Adjustment Confirmation Dialog */
.bias-confirm-content {
    max-width: 800px;
    width: 90%;
    height: min-content;
    max-height: 90vh;
    overflow-y: auto;
    background: var(--glass-layer-3);
    backdrop-filter: blur(var(--glass-blur-3));
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-3);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.bias-confirm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    border-bottom: 1px solid var(--border-secondary);
}

.bias-confirm-header h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--text-primary);
}

.bias-confirm-body {
    padding: var(--spacing-lg);
}

.bias-confirm-body p {
    margin-bottom: var(--spacing-lg);
    color: var(--text-secondary);
    font-size: 1rem;
}

.bias-confirm-previews {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
}

.preview-section {
    text-align: center;
}

.preview-section h4 {
    margin-bottom: var(--spacing-md);
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 500;
}

.preview-image-container {
    background: var(--bg-secondary);
    border: 1px solid var(--border-secondary);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-md);
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.preview-image-container img {
    max-width: 100%;
    max-height: 180px;
    object-fit: contain;
    border-radius: var(--border-radius-md);
}

.bias-confirm-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-md);
    padding: var(--spacing-lg);
    border-top: 1px solid var(--border-secondary);
}

@media (max-width: 768px) {
    .bias-confirm-content {
        width: 95%;
        max-height: 95vh;
    }
    
    .bias-confirm-previews {
        grid-template-columns: 1fr;
        gap: var(--spacing-md);
    }
    
    .preview-image-container {
        min-height: 150px;
    }
    
    .preview-image-container img {
        max-height: 130px;
    }
    
    .bias-confirm-actions {
        flex-direction: column;
    }
    
    .bias-confirm-actions button {
        width: 100%;
    }
}

/* Mask Adjustment Modal Styles */
.mask-adjustment-content {
    max-width: 500px;
    width: 90%;
}

.mask-adjustment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    border-bottom: 1px solid var(--glass-border-2);
}

.mask-adjustment-header h3 {
    margin: 0;
    color: var(--text-primary);
}

.mask-adjustment-body {
    padding: var(--spacing-lg);
}

.mask-adjustment-body p {
    margin-bottom: var(--spacing-md);
    color: var(--text-secondary);
    line-height: 1.4;
}

.mask-adjustment-options {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    margin-top: var(--spacing-lg);
}

.mask-adjustment-options button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md) var(--spacing-lg);
    border: none;
    border-radius: var(--border-radius-md);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.mask-adjustment-options button i {
    font-size: 16px;
}

.mask-adjustment-options .btn-primary {
    background: var(--primary-color);
    color: white;
}

.mask-adjustment-options .btn-primary:hover:not(:disabled) {
    background: var(--primary-hover);
}

.mask-adjustment-options .btn-secondary {
    background: var(--glass-bg-2);
    color: var(--text-primary);
    border: 1px solid var(--glass-border-2);
}

.mask-adjustment-options .btn-secondary:hover:not(:disabled) {
    background: var(--glass-bg-3);
    border-color: var(--glass-border-3);
}

/* Responsive adjustments for mask adjustment modal */
@media (max-width: 768px) {
    .mask-adjustment-content {
        width: 95%;
        margin: 10px;
    }
    
    .mask-adjustment-options {
        gap: var(--spacing-sm);
    }
    
    .mask-adjustment-options button {
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: 13px;
    }
}

/* Modal Alert Theme - Red theme for alerts */
.modal.alert-theme {
    background: rgba(0, 0, 0, 0.47); /* Darker backdrop */
}

.modal.alert-theme .modal-content {
    background: linear-gradient(135deg, rgb(220 53 69 / 17%), rgb(200 35 51 / 22%));
    backdrop-filter: blur(var(--glass-blur-5));
    border: 2px solid rgb(99 41 46 / 42%);
    box-shadow: 0 8px 32px rgb(220 53 69 / 25%), 0 0 0 1px rgb(220 53 69 / 18%);
    animation: modalAlertSlideIn 0.3s ease-out;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal.alert-theme .modal-content h2,
.modal.alert-theme .modal-content h3 {
    color: #ffffff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.modal.alert-theme .modal-content p {
    color: rgba(255, 255, 255, 0.9);
}

.modal.alert-theme .modal-content .btn-primary {
    background: linear-gradient(135deg, #dc3545, #c82333);
    border: 1px solid #dc3545;
    color: #ffffff;
}

.modal.alert-theme .modal-content .btn-primary:hover:not(:disabled) {
    background: linear-gradient(135deg, #c82333, #bd2130);
    border: 1px solid #c82333;
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
}

.modal.alert-theme .modal-content .btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #ffffff;
}

.modal.alert-theme .modal-content .btn-secondary:hover:not(:disabled) {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.4);
}

.modal.alert-theme .modal-content .btn-danger {
    background: linear-gradient(135deg, #dc3545, #c82333);
    border: 1px solid #dc3545;
    color: #ffffff;
}

.modal.alert-theme .modal-content .btn-danger:hover:not(:disabled) {
    background: linear-gradient(135deg, #c82333, #bd2130);
    border: 1px solid #c82333;
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
}

.modal.alert-theme .modal-content .close-dialog {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.modal.alert-theme .modal-content .close-dialog:hover {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

/* Alert animation */
@keyframes modalAlertSlideIn {
    0% {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* Modal Warning Theme - Orange theme for warnings */
.modal.warning-theme {
    background: rgba(0, 0, 0, 0.8); /* Slightly darker backdrop */
}

.modal.warning-theme .modal-content {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.95), rgba(255, 165, 0, 0.95));
    backdrop-filter: blur(var(--glass-blur-5));
    border: 2px solid rgba(255, 193, 7, 0.8);
    box-shadow: 0 8px 32px rgba(255, 193, 7, 0.4), 0 0 0 1px rgba(255, 193, 7, 0.2);
    animation: modalWarningSlideIn 0.3s ease-out;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal.warning-theme .modal-content h2,
.modal.warning-theme .modal-content h3 {
    color: #000000;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
}

.modal.warning-theme .modal-content p {
    color: rgba(0, 0, 0, 0.8);
}

.modal.warning-theme .modal-content .btn-primary {
    background: linear-gradient(135deg, #ffc107, #e0a800);
    border: 1px solid #ffc107;
    color: #000000;
}

.modal.warning-theme .modal-content .btn-primary:hover:not(:disabled) {
    background: linear-gradient(135deg, #e0a800, #d39e00);
    border: 1px solid #e0a800;
    box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
}

.modal.warning-theme .modal-content .btn-secondary {
    background: rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.3);
    color: #000000;
}

.modal.warning-theme .modal-content .btn-secondary:hover:not(:disabled) {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(0, 0, 0, 0.4);
}

.modal.warning-theme .modal-content .close-dialog {
    color: #000000;
    background: rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.2);
}

.modal.warning-theme .modal-content .close-dialog:hover {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(0, 0, 0, 0.3);
}

/* Warning animation */
@keyframes modalWarningSlideIn {
    0% {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* Modal Success Theme - Green theme for success */
.modal.success-theme {
    background: rgba(0, 0, 0, 0.75); /* Standard backdrop */
}

.modal.success-theme .modal-content {
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.95), rgba(28, 200, 138, 0.95));
    backdrop-filter: blur(var(--glass-blur-5));
    border: 2px solid rgba(40, 167, 69, 0.8);
    box-shadow: 0 8px 32px rgba(40, 167, 69, 0.4), 0 0 0 1px rgba(40, 167, 69, 0.2);
    animation: modalSuccessSlideIn 0.3s ease-out;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal.success-theme .modal-content h2,
.modal.success-theme .modal-content h3 {
    color: #ffffff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.modal.success-theme .modal-content p {
    color: rgba(255, 255, 255, 0.9);
}

.modal.success-theme .modal-content .btn-primary {
    background: linear-gradient(135deg, #28a745, #20c997);
    border: 1px solid #28a745;
    color: #ffffff;
}

.modal.success-theme .modal-content .btn-primary:hover:not(:disabled) {
    background: linear-gradient(135deg, #20c997, #1ea085);
    border: 1px solid #20c997;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
}

.modal.success-theme .modal-content .btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #ffffff;
}

.modal.success-theme .modal-content .btn-secondary:hover:not(:disabled) {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.4);
}

.modal.success-theme .modal-content .close-dialog {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.modal.success-theme .modal-content .close-dialog:hover {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

/* Success animation */
@keyframes modalSuccessSlideIn {
    0% {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.mini-toolbar {
    position: absolute;
    bottom: 6px;
    left: 6px;
    right: 6px;
    display: flex;
    flex-direction: row;
    gap: 6px;
    justify-content: center;
    align-items: center;
    background: rgba(0,0,0,0.7);
    border-radius: 8px;
    padding: 4px 6px;
    z-index: 10;
    opacity: 0.95;
}
.mini-toolbar .btn-small {
    min-width: 28px;
    min-height: 28px;
    font-size: 14px;
    padding: 2px 6px;
    border-radius: 6px;
    background: var(--glass-layer-4);
    color: #fff;
    border: 1px solid var(--glass-border-4);
    box-shadow: var(--glass-shadow-2);
    display: flex;
    align-items: center;
    justify-content: center;
}
.mini-toolbar .btn-small:hover {
    background: var(--glass-layer-5);
    color: #fff;
    border-color: var(--glass-border-5);
}

body:not(.editor-open) .gallery-container {
    scale: 1.0;
    opacity: 1.0;
    transition: all var(--transition-slow);
}

body.editor-open .gallery-container {
    scale: 0.85;
    opacity: 0.3;
    transition: all var(--transition-normal);
}

.gallery-placeholder {
    background: rgba(255,255,255,0.04);
    border: 1px dashed #444;
    border-radius: 18px;
    min-height: 150px;
    min-width: 0;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.3;
    pointer-events: none;
    user-select: none;
    /* Responsive adjustments */
    max-height: 400px;
    transition: all var(--transition-normal);
}

/* Responsive gallery placeholder adjustments */
@media (max-width: 768px) {
    .gallery-placeholder {
        min-height: 120px;
        max-height: 300px;
    }
}

@media (max-width: 480px) {
    .gallery-placeholder {
        min-height: 100px;
        max-height: 250px;
    }
}
.mini-toolbar-active .gallery-item-info-container,
.mini-toolbar-active .gallery-actions {
    display: none;
}

/* Workspace Color Indicators */
.workspace-color-indicator {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.3);
    flex-shrink: 0;
}

.workspace-option-content {
    display: flex;
    align-items: center;
    flex: 1;
}

.workspace-name {
    font-weight: 500;
    margin-right: auto;
}

.workspace-counts {
    font-size: 0.85rem;
    margin-left: auto;
}
div#workspaceDropdownMenu {
    min-width: 300px;
}

.workspace-manage-list {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    gap: var(--spacing-sm);
}

/* Workspace Management Styles */
.workspace-manage-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px;
    gap: var(--spacing-md);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    background: var(--glass-layer-2);
    transition: all var(--transition-normal);
}

.workspace-manage-item:hover {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
}

.workspace-manage-info {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.workspace-manage-counts {
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.workspace-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.workspace-header h5 {
    margin: 0;
    font-size: 1rem;
    font-weight: 500;
    color: var(--text-primary);
}

.workspace-manage-actions {
    display: flex;
    gap: 4px;
    align-items: center;
}

.workspace-manage-actions .btn-link {
    background: none;
    border: none;
    color: var(--text-secondary);
    padding: 6px;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
    font-size: 0.9rem;
}

.workspace-manage-actions .btn-link:hover {
    background: var(--glass-layer-3);
    color: var(--text-primary);
}

.workspace-manage-actions .btn-link.text-danger:hover {
    background: rgba(220, 53, 69, 0.2);
    color: var(--danger-color);
}

/* Workspace Edit Modal Styles */
#workspaceColorInput,
#workspaceBackgroundColorInput {
    width: 64px;
    padding: 4px 8px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    color: var(--text-primary);
    font-size: 1rem;
    height: 33px;
}

#workspaceColorInput:focus,
#workspaceBackgroundColorInput:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 69, 0, 0.2);
}

/* Workspace Settings Form Styles */
#workspaceBackgroundImageInput {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    font-size: 1rem;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1em;
}

.modal-footer {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-end;
    padding-top: 1em;
    gap: var(--spacing-lg);
    width: 100%;
}

#workspaceBackgroundImageInput:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 69, 0, 0.2);
}

.opacity-display {
    text-align: center;
    margin-top: 8px;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

.opacity-display span {
    background: var(--glass-layer-3);
    padding: 4px 8px;
    border-radius: var(--border-radius-sm);
    border: 1px solid var(--glass-border-2);
}

/* Badge Active */
.badge-active {
    background: var(--success-color);
    color: white;
    padding: 2px 6px;
    border-radius: var(--border-radius-sm);
    font-size: 0.75rem;
    font-weight: 500;
    margin-left: 8px;
}

/* Workspace Move Item Styles */
.workspace-move-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    background: var(--glass-layer-2);
    margin-bottom: 8px;
    cursor: pointer;
    transition: all var(--transition-normal);
}

.workspace-move-item:hover {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
}

.workspace-move-info {
    display: flex;
    align-items: center;
    flex: 1;
}

.workspace-move-info .workspace-name {
    font-weight: 500;
    color: var(--text-primary);
}

.workspace-move-info .badge-active {
    margin-left: 8px;
}

/* Background Image Selector */
.background-image-selector {
    display: flex;
    gap: 8px;
    align-items: stretch;
}

.background-image-selector input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    color: var(--text-primary);
    font-size: 1rem;
    cursor: default;
}

.background-image-selector input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 69, 0, 0.2);
}

.background-image-selector button {
    padding: 8px 16px;
    white-space: nowrap;
}

/* Background Image Modal */
.background-image-modal-content {
    max-width: 800px;
    max-height: 80vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.background-image-modal-content .modal-body {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    padding: 20px;
}

.background-image-search {
    margin-bottom: 16px;
}

.background-image-options {
    margin-bottom: 16px;
}

.background-image-option {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 12px;
    border: 2px solid transparent;
    border-radius: var(--border-radius-lg);
    background: none;
    color: var(--text-primary);
    cursor: pointer;
    transition: all var(--transition-normal);
    min-width: 100px;
}

.background-image-option:hover {
    border-color: var(--primary-color);
    background: var(--glass-layer-3);
}

.background-image-option.selected {
    border-color: var(--primary-color);
    background: rgba(255, 69, 0, 0.2);
}

.background-image-thumbnail {
    width: 80px;
    height: 80px;
    border-radius: var(--border-radius-md);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border: 1px solid var(--glass-border-2);
    display: flex;
    align-items: center;
    justify-content: center;
    background-image: var(--glass-layer-2);
}

.background-image-thumbnail.no-image {
    background: var(--glass-layer-3);
    color: var(--text-secondary);
    font-size: 24px;
}

.background-image-name {
    font-size: 12px;
    text-align: center;
    max-width: 100px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.background-image-grid {
    flex: 1;
    overflow-y: auto;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 12px;
    padding: 8px 0;
}

.background-image-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px;
    color: var(--text-secondary);
}

.background-image-loading .spinner {
    margin-bottom: 16px;
}

/* Infinite Scroll Loading */
.infinite-scroll-loading {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-md);
    margin-top: var(--spacing-xxl);
    padding: var(--spacing-xl);
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-2);
    position: relative;
    z-index: var(--z-layer-2);
    /* Responsive adjustments */
    margin-left: auto;
    margin-right: auto;
    max-width: 90vw;
    width: fit-content;
}

.infinite-scroll-loading p {
    color: var(--text-primary);
    font-weight: 500;
    margin: 0;
    text-align: center;
    font-size: 0.9rem;
}

.infinite-scroll-loading .spinner {
    width: 24px;
    height: 24px;
    border: 2px solid var(--glass-border-2);
    border-top: 2px solid var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

.infinite-scroll-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Responsive adjustments for infinite scroll loading */
@media (max-width: 768px) {
    .infinite-scroll-loading {
        padding: var(--spacing-lg);
        margin-top: var(--spacing-xl);
        gap: var(--spacing-sm);
    }
    
    .infinite-scroll-loading p {
        font-size: 0.8rem;
    }
    
    .infinite-scroll-loading .spinner {
        width: 24px;
        height: 24px;
        border-width: 2px;
    }
}

@media (max-width: 480px) {
    .infinite-scroll-loading {
        padding: var(--spacing-md);
        margin-top: var(--spacing-lg);
    }
    
    .infinite-scroll-loading p {
        font-size: 0.75rem;
    }
}

/* Cache Manager Modal Styles */
.cache-manager-content {
    max-width: 1200px;
    width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    box-sizing: border-box;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.cache-manager-controls {
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-xxl);
    box-shadow: var(--glass-shadow-3);
}

.cache-manager-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
}

.cache-manager-workspace-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
}

.cache-manager-workspace-selector label {
    color: #ccc;
    font-size: 0.9rem;
    font-weight: 500;
    white-space: nowrap;
}

.cache-manager-actions {
    display: flex;
    gap: 12px;
    flex-shrink: 0;
}

.cache-manager-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    padding: 10px;
    overflow: hidden;
    box-sizing: border-box;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
}

.cache-manager-gallery-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    width: 100%;
    overflow: hidden;
}

.cache-manager-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 16px;
    padding: 10px;
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1;
    width: 100%;
    max-height: 60vh;
    min-height: 200px;
}

/* Custom scrollbar for cache manager gallery */
.cache-manager-gallery::-webkit-scrollbar {
    width: 8px;
}

.cache-manager-gallery::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.cache-manager-gallery::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.cache-manager-gallery::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

.cache-manager-gallery-item {
    position: relative;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.2s ease;
    cursor: pointer;
}

.cache-manager-gallery-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.3);
}

.cache-manager-gallery-item img {
    width: 100%;
    aspect-ratio: 1/1;
    object-fit: cover;
    display: block;
}

.cache-manager-gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.7) 100%);
    opacity: 0;
    transition: opacity 0.2s ease;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 12px;
}

.cache-manager-gallery-item:hover .cache-manager-gallery-item-overlay {
    opacity: 1;
}

.cache-manager-gallery-item-info {
    color: #fff;
    font-size: 0.8rem;
    line-height: 1.4;
}

.cache-manager-gallery-item-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    align-items: flex-end;
}

.cache-manager-gallery-item-checkbox {
    position: absolute;
    top: 8px;
    left: 8px;
    width: 20px;
    height: 20px;
    background: rgba(0, 0, 0, 0.7);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 1;
}

.cache-manager-gallery-item-checkbox:checked {
    background: var(--primary-color);
    border-color: var(--primary-color);
}

.cache-manager-gallery-item-checkbox:checked::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #fff;
    font-size: 12px;
    font-weight: bold;
}

.cache-manager-gallery-item.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
}

.cache-manager-gallery.selection-mode .cache-manager-gallery-item {
    cursor: default;
}

.cache-manager-gallery.selection-mode .cache-manager-gallery-item:not(.selected):not(:hover) {
    opacity: 0.7;
}

.cache-manager-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px;
    color: #ccc;
}

.cache-manager-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 16px;
}

.cache-manager-loading p {
    margin: 0;
    font-size: 0.9rem;
}

/* Upload Progress Styles */
.upload-progress {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 8px;
}

.progress-bar {
    flex: 1;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--primary-color);
    border-radius: 4px;
    transition: width 0.3s ease;
    width: 0%;
}

div#cacheManagerMoveModal, #workspaceEditModal {
    background: #00000085;
}

/* Responsive Design */
@media (max-width: 768px) {
    .cache-manager-content {
        width: 95vw;
        max-height: 95vh;
    }
    
    .cache-manager-header {
        flex-direction: column;
        align-items: stretch;
        gap: 16px;
    }
    
    .cache-manager-workspace-selector {
        justify-content: center;
    }
    
    .cache-manager-actions {
        justify-content: center;
    }
    
    .cache-manager-gallery {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 12px;
    }
    
    .cache-manager-gallery-item img {
        aspect-ratio: 1/1;
    }
}

@media (max-width: 480px) {
    .cache-manager-content {
        width: 100vw;
        height: 100vh;
        max-height: none;
        border-radius: 0;
    }
    
    .cache-manager-gallery {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 8px;
    }
    
    .cache-manager-gallery-item img {
        aspect-ratio: 1/1;
    }
}

/* Emphasis highlighting styles */
.emphasis-highlight {
    position: relative;
    display: inline;
    padding: 1px 2px;
    margin: 0 -2px;
    border-radius: 3px;
    transition: all 0.2s ease;
}

/* Emphasis highlighting overlay */
.emphasis-highlight-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 1;
    font-family: 'Share Tech Mono', 'Courier New', monospace;
    font-size: 1em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow: hidden;
    padding: 0.6em;
    background: transparent;
    border: none;
    outline: none;
    resize: none;
    line-break: anywhere;
    color: transparent;
}

.prompt-textarea-container {
    position: relative;
}

.prompt-textarea-container .prompt-textarea, 
.prompt-textarea-container .prompt-textarea:hover,
.prompt-textarea-container .prompt-textarea:focus,
.prompt-textarea-container .prompt-textarea:active,
.character-prompt-tabs .tab-pane textarea,
.character-prompt-tabs .tab-pane textarea:hover,
.character-prompt-tabs .tab-pane textarea:focus,
.character-prompt-tabs .tab-pane textarea:active {
    display: block;
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
    backdrop-filter: none !important;
}

.prompt-textarea-container .emphasis-highlight-overlay {
    z-index: 1;
}

/* Cache Manager Tabs */
.cache-manager-tabs {
    margin-bottom: var(--spacing-sm);
}

.cache-manager-tabs .tab-buttons {
    display: flex;
    gap: 8px;
}

.cache-manager-tabs .tab-btn {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    padding: 8px 16px;
    color: #ccc;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.cache-manager-tabs .tab-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
    color: #fff;
}

.cache-manager-tabs .tab-btn.active {
    background: var(--primary-color);
    border-color: var(--primary-color);
    color: #fff;
}

.cache-manager-tabs .tab-btn.active:hover {
    background: var(--primary-color);
    opacity: 0.9;
}

.cache-manager-tabs .tab-btn i {
    font-size: 0.8rem;
}

/* Vibe Manager Styles */

.vibe-manager-gallery-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    width: 100%;
    overflow: hidden;
}

.vibe-manager-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 16px;
    padding: 10px;
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1;
    width: 100%;
    max-height: 60vh;
    min-height: 200px;
}

/* Custom scrollbar for vibe manager gallery */
.vibe-manager-gallery::-webkit-scrollbar {
    width: 8px;
}

.vibe-manager-gallery::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.vibe-manager-gallery::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.vibe-manager-gallery::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

/* Disabled vibe transfer elements during inpainting */
#vibeReferencesContainer[style*="opacity: 0.5"] {
    position: relative;
}

#vibeReferencesContainer[style*="opacity: 0.5"]::after {
    content: "Vibe transfers disabled during inpainting";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    z-index: 10;
    pointer-events: none;
}

.cache-browser-tabs .tab-btn[style*="opacity: 0.5"],
.cache-manager-tabs .tab-btn[style*="opacity: 0.5"] {
    position: relative;
    cursor: not-allowed;
}

.cache-browser-tabs .tab-btn[style*="opacity: 0.5"]::after,
.cache-manager-tabs .tab-btn[style*="opacity: 0.5"]::after {
    content: "âš ï¸";
    position: absolute;
    top: -5px;
    right: -5px;
    background: #ff6b6b;
    color: white;
    border-radius: 50%;
    width: 16px;
    height: 16px;
    font-size: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
}

.vibe-manager-gallery-item {
    position: relative;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.2s ease;
    cursor: pointer;
}

.vibe-manager-gallery-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.3);
}

.vibe-manager-gallery-item img {
    width: 100%;
    aspect-ratio: 1/1;
    object-fit: cover;
    display: block;
}

.vibe-manager-gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.7) 100%);
    opacity: 0;
    transition: opacity 0.2s ease;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 12px;
}

.vibe-manager-gallery-item:hover .vibe-manager-gallery-item-overlay {
    opacity: 1;
}

.vibe-manager-gallery-item-info {
    color: #fff;
    font-size: 0.8rem;
    line-height: 1.4;
}

.vibe-manager-gallery-item-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}

.vibe-manager-gallery-item-encodings {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    max-width: 80px;
}

.vibe-manager-encoding-badge {
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.vibe-manager-encoding-badge.no-encodings {
    background: rgba(255, 0, 0, 0.6);
    border-color: rgba(255, 0, 0, 0.8);
}

.vibe-manager-reference-preview {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 16px;
    text-align: center;
    margin-bottom: 16px;
}

.vibe-manager-reference-preview img {
    max-width: 100%;
    max-height: 200px;
    border-radius: 4px;
    object-fit: contain;
}

.vibe-manager-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px;
    color: #ccc;
}

.vibe-manager-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 16px;
}

.vibe-manager-loading p {
    margin: 0;
    font-size: 0.9rem;
    color: #ccc;
}

/* Vibe Manager Gallery Item Checkbox */
.vibe-manager-gallery-item-checkbox {
    position: absolute;
    top: 8px;
    left: 8px;
    width: 20px;
    height: 20px;
    background: rgba(0, 0, 0, 0.7);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 10;
    opacity: 0;
}

.vibe-manager-gallery-item:hover .vibe-manager-gallery-item-checkbox,
.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item-checkbox {
    opacity: 1;
}

.vibe-manager-gallery-item-checkbox:checked {
    background: var(--primary-color);
    border-color: var(--primary-color);
}

.vibe-manager-gallery-item-checkbox:checked::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 12px;
    font-weight: bold;
}

.vibe-manager-gallery-item.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-color);
}

.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item {
    cursor: pointer;
}

.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item:not(.selected):not(:hover) {
    opacity: 0.7;
}

.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item:hover {
    opacity: 1;
}

/* Vibe delete items list styling */
.vibe-delete-items-list {
    max-height: 400px;
    overflow-y: auto;
    background: var(--glass-layer-1);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--glass-shadow-2);
}

.vibe-delete-select-all {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-bottom: 1px solid var(--glass-border-2);
    background: var(--glass-layer-2);
    font-weight: 600;
    color: var(--text-primary);
}

.vibe-delete-select-all input[type="checkbox"] {
    display: none;
}

.vibe-delete-select-all .checkmark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
    cursor: pointer;
}

.vibe-delete-select-all input[type="checkbox"]:checked + .checkmark {
    background: var(--primary-color);
}

.vibe-delete-select-all input[type="checkbox"]:checked + .checkmark::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-primary);
    font-size: 12px;
    font-weight: bold;
}

.vibe-delete-select-all label {
    cursor: pointer;
    margin: 0;
    font-size: 1rem;
    color: var(--text-primary);
}

.vibe-delete-items {
    padding: 0.75rem;
}

.vibe-delete-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border: 1px solid var(--glass-border-1);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-1);
    margin-bottom: 0.5rem;
    transition: all var(--transition-normal);
}

.vibe-delete-item:hover {
    background: var(--glass-layer-2);
    border-color: var(--glass-border-2);
    box-shadow: var(--glass-shadow-1);
}

.vibe-delete-item:last-child {
    margin-bottom: 0;
}

.vibe-delete-item input[type="checkbox"] {
    display: none;
}

.vibe-delete-item .checkmark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
    cursor: pointer;
    flex-shrink: 0;
}

.vibe-delete-item input[type="checkbox"]:checked + .checkmark {
    background: var(--primary-color);
}

.vibe-delete-item input[type="checkbox"]:checked + .checkmark::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-primary);
    font-size: 12px;
    font-weight: bold;
}

.vibe-delete-item label {
    cursor: pointer;
    flex: 1;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    color: var(--text-primary);
}

.vibe-delete-item .vibe-badge {
    flex-shrink: 0;
}

.overlay-buttons-container {
    display: flex;
    justify-content: space-between;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    padding: 10px;
    z-index: 2;
}

.transformation-image-container {
    display: flex;
    flex-direction: column;
    position: relative;
    min-width: calc(33.3333333333333333% - var(--spacing-sm));
    max-width: calc(33.3333333333333333% - var(--spacing-sm));
    background: var(--glass-layer-2);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--glass-border-2);
    max-height: -webkit-fill-available;
}

.no-items {
    text-align: center;
    color: var(--text-secondary);
    font-style: italic;
    padding: 2rem;
}

/* Modal buttons styling */
.modal-buttons {
    display: flex;
    gap: 0.75rem;
    justify-content: flex-end;
}

.modal-buttons .btn-secondary,
.modal-buttons .btn-danger {
    padding: 0.5rem 1rem;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.2s ease;
}

.modal-buttons .btn-secondary {
    background: #6c757d;
    color: white;
}

.modal-buttons .btn-secondary:hover {
    background: #5a6268;
}

.modal-buttons .btn-danger {
    background: #dc3545;
    color: white;
}

.modal-buttons .btn-danger:hover {
    background: #c82333;
}
.delete-options {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.radio-option {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 4px;
    transition: background-color 0.2s;
}

.radio-option:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.radio-option input[type="radio"] {
    margin: 0;
}

.radio-label {
    font-weight: 500;
    color: #fff;
}

.delete-items-list {
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    padding: 0.5rem;
    background-color: rgba(0, 0, 0, 0.3);
}

.delete-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
    transition: background-color 0.2s;
}

.delete-item:last-child {
    border-bottom: none;
}

.delete-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.delete-item input[type="checkbox"] {
    margin: 0;
}

.delete-item-label {
    flex: 1;
    font-size: 0.9rem;
    color: #fff;
}

.delete-item-badge {
    font-size: 0.8rem;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    background-color: #007bff;
    color: white;
}

/* Enhanced vibe image badges */
.vibe-image-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    margin-top: 0.5rem;
}

.vibe-badge {
    font-size: 0.75rem;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    color: white;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    position: relative;
    overflow: hidden;
}

.vibe-badge.split {
    background: transparent;
    padding: 0;
    display: flex;
    overflow: hidden;
    border-radius: 3px;
    gap: 0;
}

.vibe-badge.split .badge-text:first-child {
    background: #007bff;
    padding: 0.2rem 0.4rem;
    border-radius: 3px 0 0 3px;
}

.vibe-badge.split .badge-text:last-child {
    background: #28a745;
    padding: 0.2rem 0.4rem;
    border-radius: 0 3px 3px 3px;
}

.vibe-badge.vibe-only {
    background: #6c757d;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
}

.vibe-badge .badge-icon {
    font-size: 0.7rem;
}

.vibe-badge .badge-text {
    font-size: 0.7rem;
    font-weight: 500;
}
#vibeManagerDeleteModal .modal-content {
    width: 350px;
}

.queue-status {
    font-weight: bold;
    color: var(--text-secondary);
    transition: color 0.2s;
}
.queue-status.notice {
    background: #f29d0024;
    color: #d8c8ab;
    border-color: rgb(255 202 136 / 20%);
}
.queue-status.warn {
    background: #904d007d;
    color: #ffd68a;
    border-color: rgb(255 214 136 / 20%);
}
.queue-status.bad {
    background: #7e121278;
    color: #ff9999;
    border-color: rgb(255 136 136 / 20%);
}
.queue-status.stopped {
    background: #61000078;
    color: #ff5959;
    border-color: rgb(255 136 136 / 20%);
}

.scraps-grayscale {
    filter: grayscale(1) blur(20px) brightness(0.4) !important;
    transition: filter 0.3s;
}

.gallery-item.initial-placeholder:not(.fade-in), .gallery-placeholder.initial-placeholder:not(.fade-in) {
    opacity: 0;
}

.gallery-item.fade-in, .gallery-placeholder.fade-in {
    opacity: 0;
    animation: galleryFadeIn 1s forwards;
}

@keyframes galleryFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.gallery-item.slide-in, .gallery-placeholder.slide-in {
    opacity: 0;
    transform: translateY(32px);
    animation: gallerySlideIn 2s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes gallerySlideIn {
    from {
        opacity: 0;
        transform: translateY(32px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}