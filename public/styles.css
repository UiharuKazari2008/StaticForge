/* CSS Variables for Design System */
:root {
    /* Primary Colors */
    --primary-color: #ff4500;
    --primary-color-light: #ff6347;
    --primary-color-dark: #e63900;
    --primary-gradient: linear-gradient(45deg, #ff4500, #ff6347);
    --primary-glass-color: hsl(16 100% 38% / 72%);
    --primary-glass-border: hsl(16 100% 46% / 58%);
    --danger-glass-color: hsl(0 100% 36% / 72%);
    --danger-glass-border: hsl(0 100% 54% / 58%);
    
    /* Secondary Colors */
    --secondary-color: #6c757d;
    --secondary-color-light: #5a6268;
    --secondary-color-dark: #495057;
    --secondary-gradient: linear-gradient(45deg, #6c757d, #5a6268);
    
    /* Background Colors */
    --bg-primary: #000000;
    --bg-secondary: #1a1a1a;
    --bg-tertiary: #2a2a2a;
    --bg-quaternary: #333333;
    --bg-overlay: hsl(0 0% 0% / 90%);
    --bg-toolbar: hsl(0 0% 0% / 50%);
    --bg-modal: hsl(0 0% 10% / 95%);
    
    /* Text Colors */
    --text-primary: #ffffff;
    --text-secondary: #cccccc;
    --text-muted: #888888;
    --text-accent: #ff4500;
    
    /* Border Colors */
    --border-primary: #ff4500;
    --border-secondary: #444444;
    --border-tertiary: #555555;
    --border-light: hsl(0 0% 100% / 20%);
    --border-divider: #413e3e;
    --border-focus: #00bfff;
    
    /* Button Hover Colors */
    --btn-hover-bg-primary: radial-gradient(hsl(16 100% 56% / 70%), hsl(16 100% 56% / 84%));
    --btn-hover-bg-secondary: radial-gradient(hsl(0 0% 100% / 25%), hsl(0 0% 100% / 35%));
    --btn-hover-bg-danger: radial-gradient(hsl(0 100% 45% / 50%), hsl(0 100% 45% / 67%));
    --btn-hover-border-primary: var(--primary-color-light);
    --btn-hover-border-secondary: var(--glass-border-4);
    --btn-hover-border-danger: var(--danger-color-light);
    --btn-hover-text-primary: #ffffff;
    --btn-hover-text-secondary: #000000;
    --btn-hover-text-danger: #ffffff;
    
    /* Button Shadow Colors */
    --btn-shadow-primary: hsl(16 100% 50% / 89%);
    --btn-shadow-secondary: var(--glass-shadow-3);
    --btn-shadow-danger: hsl(0 100% 50% / 87%);
    --btn-shadow-primary-glow: 0 2px 16px var(--btn-shadow-primary);
    --btn-shadow-secondary-glow: 0 8px 20px hsl(0 0% 100% / 33%);
    --btn-shadow-danger-glow: 0 2px 16px var(--btn-shadow-danger);
    
    /* Status Colors */
    --success-color: #28a745;
    --success-color-light: #20c997;
    --success-gradient: linear-gradient(45deg, #28a745, #20c997);
    
    --danger-color: #dc3545;
    --danger-color-light: #c82333;
    --danger-gradient: linear-gradient(45deg, #dc3545, #c82333);
    
    --warning-color: #ffc107;
    --warning-color-light: #e0a800;
    --warning-gradient: linear-gradient(45deg, #ffc107, #e0a800);
    
    --info-color: #17a2b8;
    --info-color-light: #20c997;
    --info-gradient: linear-gradient(45deg, #17a2b8, #20c997);
    
    /* Status Colors - These will be workspace-themed */
    --status-error: #ff0000;
    --status-error-light: #ff2424;
    --status-error-dark: #cc0000;
    --status-error-bg: hsl(0 100% 50% / 20%);
    --status-error-border: hsl(0 100% 57% / 33%);
    --status-error-text: #ffdadacf;
    
    --status-info: #009dff;
    --status-info-light: #24afff;
    --status-info-dark: #007acc;
    --status-info-bg: hsl(204 100% 50% / 20%);
    --status-info-border: hsl(204 100% 57% / 33%);
    --status-info-text: #c6ecff;
    
    --status-warning: #ffd000;
    --status-warning-light: #ffe224;
    --status-warning-dark: #ccaa00;
    --status-warning-bg: hsl(48 100% 50% / 20%);
    --status-warning-border: hsl(48 100% 57% / 33%);
    --status-warning-text: #fff27c;
    
    --status-success: #0dff00;
    --status-success-light: #24ff24;
    --status-success-dark: #00cc00;
    --status-success-bg: hsl(120 100% 50% / 20%);
    --status-success-border: hsl(120 100% 57% / 33%);
    --status-success-text: #adffb8;
    
    /* Special Colors */
    --variety-color: #8500ff;
    --variety-color-light: #4755ff;
    --variety-gradient: linear-gradient(45deg, #8500ff, #4755ff);
    
    --balance-color: #28a745;
    --balance-color-light: #20c997;
    --balance-gradient: linear-gradient(45deg, #28a745, #20c997);
    
    --price-color: #ffb84f;
    --price-color-free: #4caf50;
    
    /* Shadow Colors */
    --shadow-primary: hsl(16 100% 50% / 30%);
    --shadow-secondary: hsl(0 0% 0% / 30%);
    --shadow-danger: hsl(354 100% 53% / 30%);
    --shadow-success: hsl(142 61% 41% / 30%);
    --shadow-warning: hsl(45 100% 51% / 30%);
    --shadow-info: hsl(187 60% 41% / 30%);
    --shadow-variety: hsl(267 100% 50% / 53%);
    
    /* Spacing */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 12px;
    --spacing-lg: 16px;
    --spacing-xl: 20px;
    --spacing-xxl: 30px;
    
    /* Border Radius */
    --border-radius-sm: 2px;
    --border-radius-md: 3px;
    --border-radius-lg: 6px;
    --border-radius-xl: 8px;
    --border-radius-xxl: 12px;
    
    /* Transitions */
    --transition-fast: 0.2s ease;
    --transition-normal: 0.3s ease;
    --transition-slow: 0.5s ease;
    
    /* Z-index layers */
    --z-dropdown: 1000;
    --z-modal: 1000;
    --z-loading: 9999;
    --z-lightbox: 1000;
    --z-overlay: 1001;
    --z-loading: 5000;
    --z-dialog: 2000;
    
    /* Z-index layers for stacking */
    --z-layer-1: 1;
    --z-layer-2: 2;
    --z-layer-3: 3;
    --z-layer-4: 4;
    --z-layer-5: 5;
    --z-layer-6: 6;
    --z-layer-7: 7;
    --z-layer-8: 8;
    --z-layer-9: 9;
    --z-layer-10: 10;
    
    /* Background image */
    --background-image: none;

    /* Fonts */
    --font-primary: 'Noto Sans', 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --font-secondary: 'Oxanium', 'Noto Sans', 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --font-tertiary: 'Atkinson Hyperlegible Next', 'Noto Sans', 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --font-quaternary: 'Eczar', 'Noto Sans', 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --font-quinary: 'Kanit', 'Noto Sans', 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --font-mono: 'Share Tech Mono', 'Noto Sans', 'Noto Sans JP', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    /* Variable font weight presets */
    --wght-regular: 400;
    --wght-medium: 500;
    --wght-semibold: 550;
    --wght-bold: 650;
    --wght-black: 900;
    
    /* Glass Layer Depths - These will be overridden by workspace-specific variables */
    --glass-layer-1: hsl(0 0% 100% / 5%);
    --glass-layer-1-opaque: hsl(0 0% 95% / 94%);
    --glass-layer-2: hsl(0 0% 100% / 10%);
    --glass-layer-2-opaque: hsl(0 0% 90% / 90%);
    --glass-layer-3: hsl(0 0% 100% / 20%);
    --glass-layer-3-opaque: hsl(0 0% 80% / 80%);
    --glass-layer-4: hsl(0 0% 100% / 30%);
    --glass-layer-4-opaque: hsl(0 0% 70% / 70%);
    --glass-layer-5: hsl(0 0% 100% / 40%);
    --glass-layer-5-opaque: hsl(0 0% 60% / 60%);
    
    --glass-layer-dark-1: hsl(0 0% 27% / 13%);
    --glass-layer-dark-2: hsl(0 0% 27% / 22%);
    --glass-layer-dark-3: hsl(0 0% 27% / 33%);
    --glass-layer-dark-4: hsl(0 0% 27% / 44%);
    --glass-layer-dark-5: hsl(0 0% 27% / 66%);
    
    /* Glass Borders - These will be overridden by workspace-specific variables */
    --glass-border-1: hsl(0 0% 100% / 10%);
    --glass-border-2: hsl(0 0% 100% / 15%);
    --glass-border-3: hsl(0 0% 100% / 20%);
    --glass-border-4: hsl(0 0% 100% / 25%);
    --glass-border-5: hsl(0 0% 100% / 30%);
    
    /* Glass Shadows - These will be overridden by workspace-specific variables */
    --glass-shadow-1: 0 2px 8px hsl(0 0% 0% / 10%);
    --glass-shadow-2: 0 4px 16px hsl(0 0% 0% / 15%);
    --glass-shadow-3: 0 8px 24px hsl(0 0% 0% / 20%);
    --glass-shadow-4: 0 12px 32px hsl(0 0% 0% / 25%);
    --glass-shadow-5: 0 16px 40px hsl(0 0% 0% / 30%);
    
    /* Glass Inset Backgrounds - These will be overridden by workspace-specific variables */
    --glass-inset-bg-1: hsl(0 0% 100% / 5%);
    --glass-inset-bg-2: hsl(0 0% 100% / 8%);
    --glass-inset-bg-3: hsl(0 0% 100% / 12%);
    --glass-inset-bg-4: hsl(0 0% 100% / 15%);
    --glass-inset-bg-5: hsl(0 0% 100% / 20%);
}

/* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

*:not(input, textarea, select, button) {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -webkit-user-drag: none;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

body {
    font-family: var(--font-primary);
    background: black;
    background: black;
    color: var(--text-primary);
    line-height: 1.25;
    overflow-x: hidden; 
    min-height: 100vh;
    position: relative;
    overscroll-behavior: none; /* Disable overscroll bounce/refresh */
}

html {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
    -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on iOS */
    touch-action: pan-y; /* Enable vertical touch scrolling */
    overscroll-behavior: none; /* Disable overscroll bounce/refresh */
}

/* Hide scrollbar for WebKit browsers (Chrome, Safari, Edge) */
html::-webkit-scrollbar {
    display: none;
}

/* Disable overscroll behavior globally */
* {
    overscroll-behavior: none; /* Disable overscroll bounce/refresh */
}

/* Typography weights (variable fonts) */
html, body { font-variation-settings: "wght" var(--wght-regular); }

/* Headings */
h1, h2, h3 {
    font-variation-settings: "wght" var(--wght-bold); 
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    gap: 0.25em;
}
h4, h5, h6 { font-variation-settings: "wght" var(--wght-semibold); }

/* Mono blocks keep regular weight */
code, pre, kbd, samp { font-variation-settings: "wght" var(--wght-regular); }

/* Prominent labels/titles */
.logo-text {
    font-variation-settings: "wght" 600;
    font-family: 'Mozilla Headline';
    line-height: 1;
    font-size: 1.25em;
}
.header .gallery-toggle-btn, .custom-dropdown-btn { font-variation-settings: "wght" var(--wght-bold); }

/* Weight utility classes */
.wght-100 { font-variation-settings: "wght" 100; }
.wght-200 { font-variation-settings: "wght" 200; }
.wght-300 { font-variation-settings: "wght" 300; }
.wght-400 { font-variation-settings: "wght" 400; }
.wght-500 { font-variation-settings: "wght" 500; }
.wght-600 { font-variation-settings: "wght" 600; }
.wght-700 { font-variation-settings: "wght" 700; }
.wght-800 { font-variation-settings: "wght" 800; }
.wght-900 { font-variation-settings: "wght" 900; }

body.modal-open,
body.editor-open,
body.initializing {
    overflow: hidden;
}

/* Dynamic background image */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

/* Workspace transition styles */
body.workspace-transitioning * {
    transition: color 4s ease, background-color 4s ease, border-color 4s ease, box-shadow 4s ease !important;
}

body.workspace-transitioning {
    transition: all 4s ease;
}

/* Ensure smooth transitions for CSS custom properties */
body {
    transition: all 4s ease;
    /* Calculate scrollbar width to prevent layout shift when modals open */
    --scrollbar-width: 0px;
}

/* Semi-transparent gradient overlay */
body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(hsl(0 0% 0% / 0%), hsl(0 0% 0% / 29%));
    filter: saturate(1.0) contrast(1.0);
    z-index: -1;
    transition: all 3s ease;
}

body.editor-open::after {
    filter: saturate(2.0) contrast(1.25);
    background: radial-gradient(hsl(0 0% 0% / 0%), hsl(0 0% 0% / 65%));
}

body.dialog-open {
    overflow: clip;
}

/* Focus overlay to prevent accidental interactions when window loses focus */
#focus-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(10px) saturate(0.35);
    z-index: 2999;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
}

#focus-overlay.active {
    opacity: 1;
    visibility: visible;
}

#focus-overlay .focus-logo {
    position: absolute;
    top: var(--spacing-xxl);
    left: var(--spacing-xxl);
    font-size: 2rem;
    color: var(--primary-color);
}

#focus-overlay .focus-message {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-primary);
    font-size: 1.2rem;
    text-align: center;
    background: rgba(0, 0, 0, 0.8);
    padding: 1rem 2rem;
    border-radius: var(--border-radius-lg);
    border: 1px solid var(--border-primary);
    backdrop-filter: blur(10px);
    white-space: nowrap;
}

/* Container */
.container {
    margin: 0 auto;
    min-height: min-content;
    position: relative;
    z-index: 1;
    overflow: visible !important;
}

.header-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-direction: column;
    position: sticky;
    top: 0;
    z-index: 3;
    margin: 0 var(--spacing-xxl) 0 var(--spacing-xxl);
}


.floating-bar-left {
    display: flex;
    flex-direction: column;
    position: fixed;
    bottom: 0;
    left: env(safe-area-inset-left);
    z-index: 2;
    margin: var(--spacing-xxl);
    transition: all 0.2s ease;
    align-items: flex-start;
    pointer-events: none;
    transform-origin: bottom left;
}

.floating-bar-top-left {
    display: flex;
    flex-direction: column;
    position: fixed;
    top: 0;
    left: env(safe-area-inset-left);
    z-index: 2;
    margin: var(--spacing-xxl);
    transition: all 0.2s ease;
    align-items: flex-start;
    pointer-events: none;
    transform-origin: top left;
}

.mobile-only, #mobileSortOrderToggleBtn {
    display: none;
}

.floating-bar-left.mobile-only {
    left: calc(env(safe-area-inset-left));
    bottom: 0;
    top: unset;
    flex-direction: column;
    align-items: flex-start;
}

.floating-bar-left.mobile-only::after {
    top: calc(-1 * calc(var(--spacing-xxl) + 50%));
    left: calc(-1 * var(--spacing-xxl));
    width: calc(150% + calc(2 * var(--spacing-xxl)));
    height: calc(150% + calc(2 * var(--spacing-xxl)));
    background: linear-gradient(transparent, #000000b0);
    z-index: -1;
    pointer-events: none;
    mask-image: linear-gradient(90deg, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 0));
}

#mobile-controls-bar .main-menu-row {
    flex-direction: column;
}

.floating-bar-right {
    display: flex;
    flex-direction: column;
    position: fixed;
    bottom: 0;
    right: env(safe-area-inset-right);
    padding-right: env(safe-area-inset-right);
    z-index: 2;
    margin: var(--spacing-xxl);
    transition: all 0.2s ease;
    align-items: flex-end;
    pointer-events: none;
    transform-origin: bottom right;
}

.floating-bar-left::after {
    content: '';
    position: absolute;
    top: calc(-1 * calc(var(--spacing-xxl) + 50%));
    left: calc(-1 * var(--spacing-xxl));
    width: calc(150% + calc(2 * var(--spacing-xxl)));
    height: calc(150% + calc(2 * var(--spacing-xxl)));
    background: linear-gradient(transparent, #000000b0);
    z-index: -1;
    pointer-events: none;
    mask-image: linear-gradient(90deg, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 0));
}

.floating-bar-top-left::after {
    content: '';
    position: absolute;
    top: calc(-1 * var(--spacing-xxl));
    left: calc(-1 * var(--spacing-xxl));
    width: min(100vw, calc(200% + calc(2 * var(--spacing-xxl))));
    height: calc(200% + calc(2 * var(--spacing-xxl)));
    background: linear-gradient(00deg, transparent, #000000d6);
    z-index: -1;
    pointer-events: none;
    mask-image: linear-gradient(90deg, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 0));
}

span.logo-text.title-bar-text,
.gallery-title-bar .logo-text.gallery-main-logo-text {
    font-size: 24pt;
    font-variation-settings: "wght" 400;
    font-weight: 400;
    opacity: 0.75;
}

.gallery-title-bar .logo-text.gallery-main-logo-text {
    display: none;
    width: 100%;
    padding: var(--spacing-xxl);
    background: #000000;
    opacity: 1;
}

#title-bar {
    display: flex;
    opacity: 1;
    transition: opacity 0.75s ease-in-out;
    pointer-events: none;
}

#title-bar:hover {
    opacity: 0;
}

.floating-bar-right::after {
    content: '';
    position: absolute;
    top: calc(-1 * calc(var(--spacing-xxl) + 50%));
    right: calc(-1 * var(--spacing-xxl));
    width: calc(150% + calc(2 * var(--spacing-xxl)));
    height: calc(150% + calc(2 * var(--spacing-xxl)));
    background: linear-gradient(transparent, #000000b0);
    z-index: -1;
    pointer-events: none;
    mask-image: linear-gradient(270deg, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 0));
}

.editor-open .floating-bar-left,
.initializing .floating-bar-left {
    left: -1000px;
}

.editor-open .floating-bar-top-left,
.initializing .floating-bar-top-left {
    left: -1000px;
}

.editor-open .floating-bar-right,
.initializing .floating-bar-right {
    right: -1000px;
}

.main-menu-bar-outer {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: flex-start;
    align-items: center;
    padding: var(--spacing-md);
    border-radius: var(--border-radius-xl);
    background: var(--header-bg, var(--glass-layer-dark-5));
    backdrop-filter: var(--glass-blur-2, none);
    border: 1px solid var(--header-border, var(--glass-border-2));
    box-shadow: 1px 4px 25px rgb(0 0 0 / 68%);
    width: min-content;
    pointer-events: auto;
    transform-origin: center;
}

.floating-bar-right .main-menu-bar-outer {
    justify-content: flex-end;
}


.main-menu-bar-outer .gallery-toggle-group {
    border-color: var(--header-border, var(--glass-border-2));
}

.main-menu-row {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: left;
    align-items: center;
    gap: var(--spacing-sm);
}

.menu-section {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: left;
    align-items: center;
    border-left: 1px solid var(--glass-border-4);
    padding-left: var(--spacing-sm);
    gap: var(--spacing-sm);
}

.sub-menu-contents {
    margin-top: var(--spacing-md);
    padding-top: var(--spacing-sm);
    width: 100%;
    border-top: 1px solid var(--glass-border-4);
    max-height: 0;
    overflow: visible;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.sub-menu-contents:not(.hidden) {
    max-height: 200px;
    opacity: 1;
}

.sub-menu-contents.hidden {
    max-height: 0;
    opacity: 0;
}

.main-menu-contents {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: flex-start;
    flex-wrap: nowrap;
    align-items: center;
}

.main-menu-bar-overlay {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-start;
    flex-wrap: nowrap;
    pointer-events: none;
    margin: 0.5em;
    filter: drop-shadow(2px 4px 6px black);
    gap: 0.35rem;
    opacity: 0.65;
    transition: opacity 0.5s ease;
}

#main-controls-bar .main-menu-bar-overlay {
    opacity: 1;
}
#main-controls-bar .main-menu-bar-overlay .balanceDisplay {
    opacity: 0.65;
    transition: opacity 0.5s ease;
}

.floating-bar-right .main-menu-bar-overlay {
    justify-content: end;
    align-items: flex-end
}

span.menu-logo, 
#workspaceSelected {
    display: flex;
    align-items: center;
    gap: 0.25em;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 6px;
    pointer-events: auto;
}

/* Header */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-md);
    border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
    background: var(--header-bg, var(--glass-layer-dark-5));
    backdrop-filter: var(--glass-blur-2, none);   
    border: 1px solid var(--header-border, var(--glass-border-2));
    box-shadow: var(--glass-shadow-2);
    width: 100%;
    z-index: 3;
}

.header-bottom {
    position: relative;
    width: 100%;
}

.header h1 {
    font-size: 2.5rem;
    font-variation-settings: "wght" var(--wght-bold);
    font-weight: 600;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Controls Container */
.controls-container {
    background: var(--header-bg, var(--glass-layer-dark-5));
    border: 1px solid var(--header-border, var(--glass-border-3));
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-xxl);
    box-shadow: var(--glass-shadow-3);
    position: relative;
    z-index: var(--z-layer-3);
    overflow: visible !important;
}

.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-xl);
    flex-wrap: wrap;
}

.controls-left {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
    flex-wrap: wrap;
}

.controls-right {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
}

.control-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    min-width: 150px;
}

.control-group label {
    font-variation-settings: "wght" 650;
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.9rem;
    text-transform: uppercase;
}

.select-control {
    padding: 0.6em;
    border: 1px solid var(--border-secondary);
    background: transparent;
    color: var(--text-primary);
    font-size: 1rem;
    cursor: pointer;
    transition: all var(--transition-normal);
    border-radius: var(--border-radius-md);
    min-height: 32px;
    box-sizing: border-box;
}


@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    span.menu-logo:hover,
    #workspaceSelected:hover {
        background: var(--glass-layer-2);
    }
    .select-control:hover,
    .select-control:focus,
    .select-control:active {
        background: hsl(0 0% 100% / 25%);
        border: 1px solid hsl(0 0% 100% / 100%);
        outline: none;
        -webkit-appearance: none;
        -webkit-tap-highlight-color: transparent;
    }
}

.select-control option {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

/* Toggle Button Styling */
.toggle-btn {
    position: relative;
    transition: all var(--transition-normal);
    box-shadow: 0 8px 20px hsl(0 0% 100% / 0%);
    min-width: 120px;
}

.indicator::after {
    content: '';
    position: absolute;
    top: 2px;
    right: 2px;
    z-index: 1;
    height: 4px;
    width: 4px;
    border-radius: 100%;
    background: #141414e0;
    border: 1px solid var(--glass-border-5, #737373);
    box-shadow: 0 0 3px 0px #70ff8300;
    pointer-events: none;
    transition: all 0.3s ease;
}

.indicator.active::after {
    background: #ffe97e;
    border: 1px solid #cd9300;
    box-shadow: 0 0 5px 0px rgb(255, 219, 112);
}

.indicator.flashing.active:not([data-state="on"]):not([data-state="onhigh"])::after {
    animation: flash 1s infinite;
}

@keyframes flash {
    0%, 49% { 
        background: #ffe97e; 
        border: 1px solid #cd9300; 
        box-shadow: 0 0 5px 0px hsl(39 100% 71% / 100%);
    }
    50%, 100% { 
        background: #211c00; 
        border: 1px solid #201200; 
        box-shadow: 0 0 5px 0px hsl(39 100% 71% / 11.2%);
    }
}

.indicator[data-state="on"]::after,
.indicator[data-state="desc"]::after {
    background: #7eff7e;
    border: 1px solid #00cd00;
    box-shadow: 0 0 5px 0px #70ff83ff;
}

.indicator[data-state="onhigh"]::after {
    background: #ffb88a;
    border: 1px solid #cd7100;
    box-shadow: 0 0 5px 0px rgb(255 132 112);
}

.indicator[data-state="asc"]::after {
    background: #ff7e7e;
    border: 1px solid #cd0000;
    box-shadow: 0 0 5px 0px rgb(255, 112, 112);
}

/* Toggle Buttons - Layer-Aware */
.toggle-btn,
.toggle-btn[data-state="off"],
.tab-btn {
    color: #ffffff;
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    font-variation-settings: "wght" 750;
    font-weight: 600;
}


.toggle-btn[data-state="on"],
.tab-btn.active {
    background: var(--toggle-on-bg);
    color: var(--text-primary);
    border: 1px solid var(--glass-border-3);
    box-shadow: inset 0 2px 4px var(--toggle-shadow-color-58), inset 0 0 8px var(--toggle-shadow-color-19), 0 0 0 1px rgb(0 0 0 / 32%);
    transform: translateY(1px);
    position: relative;
}

.toggle-btn[data-state="on"]::before,
.tab-btn.active::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, hsl(16 100% 50% / 15%) 0%, transparent 50%, hsl(0 0% 0% / 15%) 100%);
    border-radius: var(--border-radius-md);
    pointer-events: none;
}

/* UC Boxes for UC Preset Button */
.uc-boxes {
    display: flex;
    gap: 3px;
    align-items: center;
    justify-content: center;
}

.uc-box {
    width: 8px;
    height: 8px;
    border: 1px solid var(--glass-border-3);
    background: transparent;
    border-radius: 2px;
    transition: background-color 0.2s ease;
}

/* UC Box States - Based on UC Preset Level */
.uc-boxes[data-uc-level="0"] .uc-box {
    background: transparent;
}

.uc-boxes[data-uc-level="1"] .uc-box[data-level="1"],
.uc-boxes[data-uc-level="2"] .uc-box[data-level="1"],
.uc-boxes[data-uc-level="2"] .uc-box[data-level="2"],
.uc-boxes[data-uc-level="3"] .uc-box[data-level="1"],
.uc-boxes[data-uc-level="3"] .uc-box[data-level="2"],
.uc-boxes[data-uc-level="3"] .uc-box[data-level="3"] {
    background: #ffffff;
    box-shadow: 0 0 5px 0px rgb(255 170 54);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .toggle-btn:hover:not(:disabled),
    .tab-btn:hover:not(:disabled) {
        background: var(--glass-layer-4);
        border-color: var(--glass-border-4);
        color: #ffffff;
        box-shadow: 0 8px 20px hsl(0 0% 100% / 12%);
        transition: all var(--transition-normal);
    }

    .toggle-btn[data-state="on"]:hover:not(:disabled),
    .tab-btn.active:hover:not(:disabled) {
        background: var(--toggle-on-hover-bg);
        border: 1px solid var(--glass-border-4);
        color: var(--text-primary);
        box-shadow: inset 0 2px 4px var(--toggle-shadow-color-58), inset 0 0 8px var(--toggle-shadow-color-19), 0 0 0 1px rgb(0 0 0 / 32%);
    }

    .toggle-btn[data-state="off"]:hover,
    .tab-btn:hover {
        background: var(--glass-layer-4);
        border-color: var(--glass-border-4);
    }
    /* UC Boxes in hover state */
    .toggle-btn:hover .uc-box {
        border-color: var(--glass-border-4);
    }
}

/* Dataset Bias Controls */
.dataset-bias-container {
    padding: var(--spacing-sm);
    border: 1px solid var(--glass-border-5);
    background: var(--glass-layer-dark-5);
    border-radius: var(--border-radius-md);
}
.prompt-tabs:not(.show-both) .dataset-bias-container {
    min-height: 150px;
}

.dataset-bias-group {
    margin-bottom: var(--spacing-sm);
}

.dataset-bias-group .form-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.dataset-bias-group input[type="number"] {
    width: 80px;
    flex-shrink: 0;
}

.dataset-bias-group .toggle-btn {
    min-width: 60px;
    padding: 0.25rem 0.5rem;
    font-size: 0.85rem;
}

.show-both div#tab-buttons {
    display: none;
}

div#datasetBiasControls {
    display: flex;
    flex-direction: row;
    align-items: center;
    flex-wrap: wrap;
    justify-content: flex-start;
    gap: var(--spacing-md);
}

button#datasetDropdownBtn {
    gap: 5px;
}
span#datasetSelected {
    background: white;
    border-radius: 0.3em;
    color: #a6653b;
    padding: 0.0em 0.45em;
    margin: 0;
}
/* Special case for variety button */
button#varietyBtn {
    padding: 0.5em;
    min-width: 2.25em;
}

button#clearSeedBtn,
button#manualUpscale,
button#vibeNormalizeToggle,
button#paidRequestToggle,
button#imageBiasAdjustBtn,
button#editSeedBtn, 
button#sproutSeedBtn {
    min-width: 35px;
    padding: 0.5em;
}

/* Checkbox Styling */
.checkbox-label {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    font-variation-settings: "wght" 750;
    font-weight: 600;
    color: var(--primary-color);
}

.checkbox-label input[type="checkbox"] {
    display: none;
}

.checkmark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
}

.checkbox-label input[type="checkbox"]:checked + .checkmark {
    background: var(--primary-color);
}

.checkbox-label input[type="checkbox"]:checked + .checkmark::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    color: var(--text-primary);
    font-size: 12px;
    font-variation-settings: "wght" 750;
    font-weight: 600;
}

button {
    font-family: inherit;
}

/* Buttons - Layer-Aware Design System */
.btn-primary, .btn-secondary, .btn-danger, .pswp__button--custom {
    padding: 0.25em 1em;
    border-radius: var(--border-radius-md);
    font-size: 14px;
    font-variation-settings: "wght" var(--wght-semibold);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    text-decoration: none;
    min-height: 32px;
    min-width: 45px;
    white-space: nowrap;
    position: relative;
    border: 1px solid transparent;
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
    letter-spacing: 0.3px;
    transform: translateZ(0);
    will-change: backdrop-filter;
    line-height: 1;
}


.mdi-1-5 {
    font-size: 1.5em;
    margin: -0.5em 0;
}
.mdi-1-25 {
    font-size: 1.25em;
    margin: -0.25em 0;
}
.mdi-1-35 {
    font-size: 1.35em;
    margin: -0.35em 0;
}
.mdi-1-45 {
    font-size: 1.45em;
    margin: -0.45em 0;
}

.round-button .mdi-1-5 {
    margin: -0.5em;
}
.round-button .mdi-1-25 {
    margin: -0.25em;
}
.round-button .mdi-1-35 {
    margin: -0.35em;
}
.round-button .mdi-1-45 {
    margin: -0.45em;
}

.btn-primary:has(.mdi-1-5, .mdi-1-25, .mdi-1-35, .mdi-1-45),
.btn-secondary:has(.mdi-1-5, .mdi-1-25, .mdi-1-35, .mdi-1-45),
.btn-danger:has(.mdi-1-5, .mdi-1-25, .mdi-1-35, .mdi-1-45),
.btn-warning:has(.mdi-1-5, .mdi-1-25, .mdi-1-35, .mdi-1-45),
.pswp__button--custom:has(.mdi-1-5, .mdi-1-25, .mdi-1-35, .mdi-1-45) {
    padding: 0.25em 0.75em;
}

.blur {
    backdrop-filter: var(--glass-blur-2, contrast(0.2) brightness(0.25));
}

/* Base button layer awareness */
.btn-primary, .btn-secondary, .btn-danger, .btn-warning, .pswp__button--custom {
    background: radial-gradient(var(--glass-layer-3), var(--glass-layer-3));
    border-color: var(--glass-border-3);
    color: var(--text-primary);
}


/* Primary Button - High Contrast */
.btn-primary {
    background: radial-gradient(var(--primary-glass-color), var(--primary-glass-color));
    color: #ffffff;
    border-color: var(--primary-glass-border);
    box-shadow: var(--glass-shadow-3), 0 2px 8px var(--shadow-primary);
    font-weight: 700;
}

.btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    background: radial-gradient(var(--glass-layer-1), var(--glass-layer-1));
    border-color: var(--glass-border-1);
    color: var(--text-muted);
    box-shadow: var(--glass-shadow-1);
}

/* Secondary Button - Medium Contrast */
.btn-secondary,
.pswp__button--custom {
    background: radial-gradient(var(--glass-layer-3), var(--glass-layer-3));
    color: #ffffff;
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
}

.btn-secondary:disabled,
.pswp__button--custom:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    background: radial-gradient(var(--glass-layer-1), var(--glass-layer-1));
    border-color: var(--glass-border-1);
    color: var(--text-muted);
    box-shadow: var(--glass-shadow-1);
}

/* Danger Button - High Contrast */
.btn-danger {
    background: radial-gradient(var(--danger-glass-color), var(--danger-glass-color));
    color: #ffffff;
    border-color: var(--danger-glass-border);
    box-shadow: var(--glass-shadow-3), 0 2px 8px var(--shadow-danger);
}

.btn-danger:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

/* Warning Button - Medium-High Contrast */
.btn-warning {
    background: radial-gradient(var(--warning-glass-color, #ff95009e), var(--warning-glass-color, #ff95009e));
    color: #ffffff;
    border-color: var(--warning-glass-border, #ff9500db);
    box-shadow: var(--glass-shadow-3), 0 2px 8px var(--shadow-warning, hsl(45 100% 50% / 30%));
}

.btn-warning:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
    background: radial-gradient(var(--glass-layer-1), var(--glass-layer-1));
    border-color: var(--glass-border-1);
    color: var(--text-muted);
    box-shadow: var(--glass-shadow-1);
}

/* Layer-Aware Button Variants */

/* Generate Button - Prominent */
.generate-btn {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-color-light));
    color: #ffffff;
    border-color: var(--primary-color);
    box-shadow: var(--glass-shadow-4), 0 4px 12px var(--shadow-primary);
    font-size: 16px;
    padding: 0.6em 1.2em;
    min-height: 44px;
    z-index: var(--z-layer-4);
}

.generate-btn .badge {
    background: white;
    color: #ff4705;
    border-radius: 3px;
    padding: 4px 10px;
    display: inline-flex;
    flex-direction: row;
    align-items: center;
    gap: 6px;
    margin: 0;
}

/* Small and Icon-Only Button Variants */
.btn-small {
    padding: 2px 8px;
    font-size: 14px;
    min-height: 26px;
    min-width: 40px;
    z-index: var(--z-layer-3);
}

.btn-small.indicator,
.btn-small.btn-wide {
    padding: 2px 12px;
    min-width: 45px;
}

.custom-dropdown-btn.btn-full {
    width: 100%;
}


button#ucPresetsDropdownBtn.btn-small {
    padding: 2px 12px;
}

/* Compact button groups */
.btn-group-compact .btn-primary,
.btn-group-compact .btn-secondary,
.btn-group-compact .btn-danger {
    padding: 6px 12px;
    font-size: 13px;
    min-height: 32px;
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    color: #ffffff;
    z-index: var(--z-layer-3);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    /* Button hover states with layer elevation */
    .btn-secondary:hover:not(:disabled),
    .pswp__button--custom:hover:not(:disabled) {
        color: var(--btn-hover-text-secondary);
        background: var(--btn-hover-bg-secondary);
        border-color: var(--btn-hover-border-secondary);
        z-index: var(--z-layer-4);
        box-shadow: var(--btn-shadow-secondary-glow);
        transition: all var(--transition-normal);
    }
    .btn-primary:hover:not(:disabled) {
        background: var(--btn-hover-bg-primary);
        border-color: var(--btn-hover-border-primary);
        box-shadow: var(--btn-shadow-primary-glow);
        color: var(--btn-hover-text-primary);
    }
    .btn-danger:hover:not(:disabled) {
        background: var(--btn-hover-bg-danger);
        border-color: var(--btn-hover-border-danger);
        box-shadow: var(--btn-shadow-danger-glow);
        color: var(--btn-hover-text-danger);
    }
    .btn-warning:hover:not(:disabled) {
        background: var(--btn-hover-bg-warning, #ff9500cc);
        border-color: var(--btn-hover-border-warning, #ff8000);
        box-shadow: var(--btn-shadow-warning-glow, 0 4px 12px hsl(45 100% 50% / 40%));
        color: var(--btn-hover-text-warning, #ffffff);
    }
    .generate-btn:hover:not(:disabled) {
        background: linear-gradient(135deg, var(--primary-color-light), var(--primary-color));
        border-color: var(--primary-color-light);
        color: #ffffff;
        z-index: var(--z-layer-5);
    }

    .btn-group-compact .btn-primary:hover:not(:disabled),
    .btn-group-compact .btn-secondary:hover:not(:disabled),
    .btn-group-compact .btn-danger:hover:not(:disabled) {
        background: var(--glass-layer-4);
        border-color: var(--glass-border-4);
        color: #ffffff;
        z-index: var(--z-layer-4);
    }
}

/* Button groups with consistent spacing */
.btn-group {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    flex-wrap: wrap;
}

.btn-group-compact {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
    flex-wrap: wrap;
}

/* Button utility classes for layer awareness */
.btn-layer-1 {
    background: var(--glass-layer-1);
    border-color: var(--glass-border-1);
    box-shadow: var(--glass-shadow-1);
    color: var(--text-muted);
    z-index: var(--z-layer-1);
}

.btn-layer-2 {
    background: var(--glass-layer-2);
    border-color: var(--glass-border-2);
    box-shadow: var(--glass-shadow-2);
    color: #cccccc;
    z-index: var(--z-layer-2);
}

.btn-layer-3 {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    color: #ffffff;
    z-index: var(--z-layer-3);
}

.btn-layer-4 {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}

.btn-layer-5 {
    background: var(--glass-layer-5);
    border-color: var(--glass-border-5);
    box-shadow: var(--glass-shadow-5);
    color: #ffffff;
    z-index: var(--z-layer-5);
}

/* Enhanced disabled states */
.btn-primary:disabled,
.btn-secondary:disabled,
.btn-danger:disabled,
.toggle-btn:disabled,
.btn-small:disabled,
.btn-icon-only:disabled,
.pswp__button--custom:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
}

/* Active button states - only for text inputs */
input[type="text"]:active,
input[type="number"]:active,
input[type="email"]:active,
input[type="password"]:active,
input[type="search"]:active,
input[type="tel"]:active,
input[type="url"]:active,
textarea:active {
    background: hsl(0 0% 100% / 25%);
    border: 1px solid hsl(0 0% 100% / 100%);
    z-index: var(--z-layer-4);
}

.gallery-controls {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: var(--spacing-lg);
    gap: var(--spacing-md);
}

.gallery-controls .toggle-btn {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    color: var(--text-primary);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-lg);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 16px;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery-controls .toggle-btn:hover {
        background: var(--glass-layer-3);
        border-color: var(--glass-border-3);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px hsl(0 0% 0% / 30%);
    }
}

.gallery-controls .toggle-btn[data-state="scraps"] {
    background: var(--glass-layer-3);
    border-color: var(--primary-color);
    color: var(--primary-color);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery-controls .toggle-btn[data-state="scraps"]:hover {
        background: var(--primary-color);
        color: var(--text-primary);
    }
}

/* Gallery Toggle Group */
.gallery-toggle-group {
    position: relative;
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    background: var(--glass-layer-1);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg);
    padding: 2px;
    box-shadow: inset 0 0 20px var(--shadow-color-3, #000000a3);
    z-index: var(--z-layer-1);
    gap: 2px;
    margin: -4px 0px;
    transition: all var(--transition-normal);
}

.gallery-toggle-btn {
    position: relative;
    background: transparent;
    border: none;
    color: var(--primary-color-light);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 16px;
    min-width: 45px;
    justify-content: center;;
    opacity: 0.65;
    z-index: var(--z-layer-2);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery-toggle-group:hover .gallery-toggle-btn {
        color: var(--text-primary);
        opacity: 0.75;
    }
    .gallery-toggle-group:hover .gallery-toggle-btn:hover {
        color: var(--text-primary);
        opacity: 1;
    }
}


.gallery-toggle-group .gallery-toggle-btn.active {
    color: var(--text-primary);
    background: transparent;
    border: none;
    box-shadow: none;
    z-index: var(--z-layer-3);
    opacity: 1;
}

.gallery-toggle-slider {
    position: absolute;
    top: 2px;
    left: 2px;
    width: calc(25% - 2px);
    height: calc(100% - 4px);
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-md);
    box-shadow: var(--shadow-color-2);
    transition: transform var(--transition-normal), background var(--transition-slow), border-color var(--transition-slow);
    z-index: var(--z-layer-2);
    pointer-events: none;
}

.gallery-toggle-group[data-active="scraps"] .gallery-toggle-slider {
    transform: translateX(0);
    background: hsl(0 100% 50% / 50%);
    border-color: hsl(0 100% 60% / 69%);
}

.gallery-toggle-group[data-active="scraps"] .gallery-toggle-btn.active {
    color: #ffc6c6;
}

.gallery-toggle-group[data-active="images"] .gallery-toggle-slider {
    transform: translateX(calc(100% + 2px));
    background: hsl(210 73% 47% / 50%);
    border-color: hsl(210 73% 59% / 50%);
}

.gallery-toggle-group[data-active="images"] .gallery-toggle-btn.active {
    color: #def4ff;
}

.gallery-toggle-group[data-active="pinned"] .gallery-toggle-slider {
    transform: translateX(calc(200% + 3px));
    background: hsl(48 100% 50% / 50%);
    border-color: hsl(48 100% 60% / 51.3%);
}

.gallery-toggle-group[data-active="pinned"] .gallery-toggle-btn.active {
    color: #fffbd4;
}

.gallery-toggle-group[data-active="upscaled"] .gallery-toggle-slider {
    transform: translateX(calc(300% + 4px));
    background: hsl(120 100% 50% / 50%);
    border-color: hsl(120 100% 57% / 33%);
}

.gallery-toggle-group[data-active="upscaled"] .gallery-toggle-btn.active {
    color: #d3ffd9;
}

/* Ensure smooth transitions for the slider */
.gallery-toggle-slider {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
/* Hover effects for the toggle group */
    .gallery-toggle-group:hover {
        background: var(--glass-layer-dark-3);
    }
}

/* Active button styling */
.gallery-toggle-btn.active {
    color: var(--text-primary);
    background: transparent;
    border: none;
    box-shadow: none;
    z-index: var(--z-layer-3);
}

.gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 0;
    margin-bottom: var(--spacing-xxl);
    width: 100%;
    max-width: 100%;
}

.gallery-item {
    position: relative;
    overflow: hidden;
    cursor: pointer;
    aspect-ratio: 1;
    transition: all var(--transition-normal);
    border: 2px solid #000000;
    border-radius: 0;
    background: var(--glass-layer-2);
    box-shadow: none;
    z-index: var(--z-layer-2);
}

.gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center top;
    display: block;
}

.gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    color: var(--text-primary);
    padding: 15px;
    opacity: 0;
    transition: opacity var(--transition-fast);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery-item:hover {
        border-color: var(--glass-border-4);
        box-shadow: var(--glass-shadow-4);
        background: var(--glass-layer-4);
        z-index: var(--z-layer-4);
    }
    .gallery-item:hover .gallery-item-overlay {
        opacity: 1;
    }
}

.gallery-item-title {
    color: var(--text-primary);
    margin-bottom: 5px;
}

.gallery-item-info {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* Gallery actions - using standardized button system */
.gallery-actions {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    gap: var(--spacing-sm);
    opacity: 0;
    transition: opacity var(--transition-normal);
    z-index: 10;
    height: calc(100% - 15px);
    flex-wrap: wrap;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
}

.gallery-actions button {
    width: 42px;
    height: 42px;
    min-width: 0px;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery-item:hover .gallery-actions {
        opacity: 1;
    }
}

/* Gallery info - moved to bottom left */
.gallery-item-info-container {
    position: absolute;
    bottom: 15px;
    left: 15px;
    right: 15px;
    margin-bottom: 0;
}

.gallery-info-row {
    color: var(--text-primary);
    font-size: 0.85rem;
    margin-bottom: 2px;
}

.gallery-info-row:first-child {
    font-size: 0.9rem;
    color: var(--primary-color);
}

/* Modal Styles */
.modal {
    display: flex;
    position: fixed;
    z-index: var(--z-modal);
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: #00000030;
    overflow: hidden;
}

div#manualModal {
    background: transparent;
}

div#bulkMoveToWorkspaceModal {
    background: #00000052;
}

/* Modal Initializing State */
.modal.initializing .prompt-options-container,
.modal.initializing .form-section.model-control,
.modal.initializing .manual-preview-content {
    opacity: 0.3;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.modal.initializing .prompt-options-container {
    position: relative;
}

.modal.initializing .prompt-options-container .spinner-overlay {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

.modal.initializing .prompt-options-container .spinner-overlay .fa-spinner {
    font-size: 2rem;
    color: var(--accent-primary);
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.modal-content {
    display: flex;
    flex-direction: column;
    background: var(--glass-layer-dark-5);
    backdrop-filter: var(--glass-blur-5, none);
    border: 1px solid var(--glass-border-5);
    margin: auto;
    padding: var(--spacing-xl);
    width: 96%;
    height: fit-content;
    max-width: 600px;
    position: relative;
    animation: modalSlideIn 0.3s ease-out;
    overflow-y: auto;
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-5);
    z-index: var(--z-layer-5);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Gallery Action Buttons - Medium Layer */
.gallery-info-row:first-child {
    font-weight: var(--wght-bold);
    margin-bottom: 5px;
}

/* Gallery Sentinel Elements for Virtual Scrolling */
.gallery-sentinel {
    position: relative;
    width: 100%;
    height: 1px;
    background: transparent;
    pointer-events: none;
    z-index: -1;
}

.gallery-sentinel.top-sentinel {
    margin-bottom: 0;
}

.gallery-sentinel.bottom-sentinel {
    margin-top: 0;
}

/* Ensure sentinels don't interfere with gallery layout */
.gallery-sentinel:not(:first-child):not(:last-child) {
    display: none;
}

/* Gallery Action Buttons - Medium Layer */
.round-button {
    padding: 9px 12px;
    font-size: 18px;
    width: 45px;
    height: 45px;
    border-radius: 45px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    box-shadow: 0 2px 8px var(--shadow-secondary);
    align-items: center;
    background: var(--round-secondary-bg);
    border-color: var(--glass-border-2);
    color: var(--text-primary);
    z-index: var(--z-layer-3);
}

.round-button.wide-button {
    width: unset;
}

.round-button.wide-button span {
    font-size: 0.8em;
}

.round-button:disabled {
    background: var(--round-secondary-bg);
}

#workspaceEditModal .modal-content,
#updatePresetModal .modal-content {
    overflow: visible;
}

.round-button.btn-danger {
    color: #ffdadacf;
    border-color: #ff000030;
    background: #4700005c;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .round-button:hover {
        background: var(--btn-hover-bg-secondary);
        border-color: var(--btn-hover-border-secondary);
        color: var(--btn-hover-text-secondary);
        z-index: var(--z-layer-4);
    }

    .round-button.btn-primary:hover:not(:disabled) {
        background: var(--btn-hover-bg-primary);
        border-color: var(--btn-hover-border-primary);
        color: var(--btn-hover-text-primary);
    }

    .round-button.btn-danger:hover:not(:disabled) {
        background: #630000c2;
        border-color: #ff48284f;
        color: #ffdfdf;
        box-shadow: var(--glass-shadow-3), 0 2px 16px rgb(255 0 0 / 28%);
    }
}

.round-button-group {
    font-size: 18px;
    height: 45px;
    border-radius: 45px;
    cursor: pointer;
    display: flex;
    box-shadow: 0 2px 8px var(--shadow-secondary);
    align-items: center;
    border: none;
    color: var(--text-primary);
    z-index: var(--z-layer-3);
    padding: 0;
    background: transparent;
    backdrop-filter: var(--glass-blur-2, none);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.round-button-group .round-button {
    backdrop-filter: none;
    box-shadow: none;
}

.round-button-group .round-button:first-child {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.round-button-group .round-button:last-child {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}

.round-button-group .round-button:not(:first-child):not(:last-child) {
    border-radius: 0;
}

span#manualPreviewSeedNumber {
    font-family: var(--font-secondary);
    line-height: 1;
}


.modal-content.center {
    margin: auto;
}

/* Manual Modal Specific Styles */
.manual-modal-content {
    flex-direction: column;
    max-width: 650px;
    height: calc(min(100vh, 1250px) - 2em);
    padding: 0;
    margin: 1em auto 1em auto;
}
    
.manual-modal-split {
    display: flex;
    gap: 0;
    height: 100%;
    flex: 0 1 auto;
    position: relative;
    flex-flow: column-reverse;
    overflow: hidden;
    padding-bottom: var(--spacing-lg);
}

.manual-modal-form-section {
    width: 100%;
    height: 100%;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.workspace-tabs {
    display: none;
}
    
.manual-modal-preview-section {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
}


.manual-preview-container {
    background: var(--glass-layer-2);
    border-left: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-xl);
    height: 100%;
    display: flex;
    flex-direction: column;
    box-shadow: var(--glass-shadow-2);
    position: relative;
}

.manual-preview-blur-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    z-index: 0;
    border-radius: var(--border-radius-xl);
}

.manual-preview-header {
    margin-bottom: var(--spacing-lg);
}

.manual-preview-header h3 {
    color: var(--primary-color);
    font-size: 1.2rem;
    text-transform: uppercase;
    margin: 0;
}

.manual-preview-content {
    display: flex;
    position: relative;
    height: 100%;
    overflow: hidden;
    z-index: 1;
}

.manual-preview-image-container {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    padding: var(--spacing-xxl);
    border-radius: var(--border-radius-xl);
    height: 100%;
}

.manual-preview-image-container img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.manual-preview-image-container-inner {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    box-shadow: var(--glass-shadow-4);
    user-select: none;
    max-width: 90%;
    max-height: 90%;
}

/* Manual block container positioning */
.manual-preview-image-container-inner .block-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    aspect-ratio: unset;
    pointer-events: none;
    transform: none;
    z-index: 2;
}

.manual-preview-image-container-inner .block-container .block {
    aspect-ratio: 1/1;
}

.manual-preview-image-container-inner #manualPreviewImage {
    position: relative;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    z-index: 1;
    width: auto;
    height: auto;
}

/* Side-by-side preview styles */
.manual-preview-image-container.dual-mode {
    justify-content: center;
}

.manual-preview-image-container.dual-mode .manual-preview-image-container {
    max-width: 100%;
    max-height: 100%;
    transition: all 0.3s ease;
    z-index: 2;
}

.manual-preview-image-container img.manual-preview-original-image {
    position: absolute;
    top: 50%;
    right: 0;
    transform: translateY(-50%) translateX(calc(100% - 40px));
    height: 50%;
    object-fit: contain;
    opacity: 0.75;
    cursor: pointer;
    pointer-events: auto;
    transition: all 0.3s ease;
    z-index: 1;
    box-shadow: var(--glass-shadow-4);
    border: 1px solid #ffffffab;
    border-radius: var(--border-radius-xxl);
}

/* Swapped state - original image becomes main preview, generated image becomes thumbnail */
.manual-preview-image-container.swapped .manual-preview-original-image {
    transform: translateY(-50%) translateX(calc(-100% + 40px));
    left: 0;
    right: unset;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .manual-preview-image-container img.manual-preview-original-image:hover {
        opacity: 1;
        transform: translateY(-50%) translateX(calc(100% - 72px));
        height: 55%;
        border-radius: 0px;
    }

    .manual-preview-image-container.swapped .manual-preview-original-image:hover {
        opacity: 1;
        transform: translateY(-50%) translateX(calc(-100% + 72px));
    }
}


.manual-preview-image-container.swapped .manual-preview-image-container-inner #manualPreviewImage {
    max-width: 100%;
    max-height: 100%;
    transition: all 0.3s ease;
}

/* Hide original image when zoomed */
.manual-preview-image-container.zoomed .manual-preview-original-image {
    display: none !important;
}

.manual-preview-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    text-align: center;
    padding: var(--spacing-xl);
}

.manual-preview-placeholder i {
    font-size: 5em;
    opacity: 0.5;
    color: var(--text-secondary);
}

.manual-preview-placeholder p {
    margin: 0;
    font-size: 0.9rem;
}

.manual-preview-controls {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    position: absolute;
    padding: 0 var(--spacing-xxl) var(--spacing-xxl);
    width: 100%;
    bottom: 0;
    right: 50%;
    flex-direction: row;
    transform: translate(50%, 0);
    z-index: 4;
}

.manual-preview-controls-center {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: center;
    flex-wrap: wrap;
    flex-direction: row;
}

.manual-preview-controls-right {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-end;
    flex-wrap: wrap;
    align-items: center;
}

.manual-preview-controls-left {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-start;
    flex-wrap: wrap;
    align-items: center;
}

.manual-preview-controls-top-right {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-end;
    flex-wrap: wrap;
    position: absolute;
    top: 0;
    right: 0;
    padding-top: var(--spacing-lg);
    width: 150px;
    align-items: center;
    padding-right: var(--spacing-lg);
    z-index: 4;
}

.manual-preview-controls-top-left {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-start;
    flex-wrap: wrap;
    position: absolute;
    top: 0;
    left: 0;
    padding-top: var(--spacing-lg);
    align-items: center;
    padding-left: var(--spacing-lg);
    z-index: 4;
}

.manual-preview-handle-inner {
    display: flex;
    width: 64px;
    height: 30px;
    background: var(--glass-layer-2);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--glass-border-1);
    box-shadow: var(--glass-shadow-2);
    margin-top: -5px;
    padding-top: 5px;
    align-items: center;
    justify-content: center;
    cursor: grab;
    pointer-events: auto;
    z-index: 25;
}


/* Pending Requests Spinner */
.pending-requests-spinner {
    display: flex;
    align-items: center;
    padding: 3px 10px 3px 6px;
    gap: 3px;
    background: hsl(0 0% 100% / 10%);
    border-radius: 20px;
    backdrop-filter: var(--glass-blur-2, none);
    border: 1px solid hsl(0 0% 100% / 20%);
    transition: all 0.3s ease;
    position: relative;
}

.pending-requests-spinner i {
    color: var(--hover-show-colored-text);
    font-size: 18px;
}

.pending-requests-badge {
    color: var(--hover-show-colored-text);
    font-weight: 600;
    text-align: center;
    line-height: 1;
    font-size: 12pt;
    margin-left: 4px;
}
#manualPendingRequestsSpinner {
    background: var(--glass-layer-2);
    border-color: var(--glass-border-2);
}

/*
#manualModal:not(.ready) > form > div {
    opacity: 0.25;
    transition: opacity 0.3s ease;
    pointer-events: none;
}
*/

@media (min-width: 1500px) {
    #manualPreviewSeedBtn {
        width: unset;
        padding: 9px 20px;
        font-size: 18px;
        height: 45px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        flex-direction: row;
        flex-wrap: nowrap;
        gap: 0.4em;
        align-items: center;
        min-height: 32px;
        min-width: 45px;
        white-space: nowrap;
        position: relative;
    }
}
@media (max-width: 1499px) {
    #manualPreviewSeedNumber {
        display: none;
    }
}

/* Manual Modal Split Layout for Wide Viewports */
@media (min-width: 1400px) {    
    .manual-preview-container, .cache-browser-container {
        border-left: 1px solid var(--glass-border-3);
        border-bottom: 1px solid var(--glass-border-3);
    }

    .manual-preview-container, .cache-browser-container, .manual-preview-blur-background {
        border-top-right-radius: 0;
        border-top-left-radius: 0;
        border-bottom-right-radius: 0;
        border-right: none;
        border-top: none;
    }

    .manual-modal-split {
        flex-flow: row;
    }

    div#manualModal {
        position: fixed;
        box-shadow: none;
        justify-content: center;
    }

    .manual-modal-content {
        max-width: 100%;
        width: 100%;
        margin: 0;
        height: 100%;
        border-radius: 0;
        border-width: 0;
    }
    
    .manual-modal-form-section {
        width: unset;
        flex: 1;
        min-width: 0;
        overflow: hidden;
        max-width: 650px;
    }

    .small-viewport {
        display: none!important;
    }

    .form-section.model-control .control-holder {
        flex-direction: row;
    }

    .form-section.model-control .control-holder .form-row {
        width: 100%;
    }

    #editSeedBtn {
        display: none !important;
    }
    
    #manualSeed, #sproutSeedBtn:not(.hidden) {
        display: flex !important;
    }

    .form-section.model-control .control-holder .form-row.control-row-5,
    .form-section.model-control .control-holder .form-row.control-row-3 {
        width: auto;
    }

    #manualModal #manualModelDropdown {
        min-width: 125px;
    }
    
    .form-row .form-group:has(#manualSteps) input,
    .form-row .form-group:has(#manualRescale) .percentage-input-container  {
        min-width: 58px;
        flex: none;
    }
    
    .form-row .form-group:has(#manualGuidance) input {
        max-width: 58px;
        flex: none;
    }

    .form-row .form-group:has(#manualSteps),
    .form-row .form-group:has(#manualRescale) {
        flex: 1;
    }
    .form-row .form-group:has(#manualGuidance) {
        flex: 0 1 auto;
    }

    .form-section.model-control .control-holder .form-row.control-row-0 {
        order: 0;
        max-width: fit-content;
    }
    .form-section.model-control .control-holder .form-row.control-row-1 {
        order: 1;
        width: auto;
        min-width: max-content;
    }
    .form-section.model-control .control-holder .form-row.control-row-3 {
        order: 2;
    }
    .form-section.model-control .control-holder .form-row.control-row-4 {
        order: 3;
        width: auto;
        min-width: 20%;
    }
    .form-section.model-control .control-holder .form-row.control-row-2 {
        order: 4;
        max-width: 185px;
        margin-right: auto;
    }
    .form-section.model-control .control-holder .form-row.control-row-5 {
        order: 5;
    }

    .form-row .form-group:has(#manualSeed) label {
        justify-content: flex-end;
    }

    #manualSeed {
        text-align: right;
        justify-content: end;
    }

    @supports not ((-webkit-touch-callout: none) or (hover: hover)) {
        #manualSeed:not(:hover):not(:focus) {
            padding: 0.35em 0em 0.35em 1.2em;
        }
    }

    @supports (-webkit-touch-callout: none) or (hover: hover) {
        #manualSeed {
            padding: 0.35em 0em 0.35em 1.2em;
        }
    }

    .seed-input-group {
        flex-direction: row-reverse;
    }
    
    #manualPanelSection {
        position: relative;
        min-width: 0%;
    }

    #manualSamplerDropdown {
        min-width: 160px;
    }
    #manualNoiseSchedulerDropdown {
        min-width: 150px;
    }
    
    #manualPanelSection.initial {
        position: relative;
        width: 100%;
        top: 0;
        right: 0;
        height: 100%;
        min-width: 0%;
        animation: panelSlideOut 0.5s ease reverse;
    }
    
    #manualPanelSection.zoomed {
        position: absolute;
        top: 0;
        right: 0;
        height: calc(100% - var(--spacing-lg));
        min-width: min(85%, max(1300px, calc(100% - 650px)));
        z-index: var(--z-layer-10);
        animation: panelSlideIn 0.5s ease forwards;
    }
    #manualPanelSection.initial div#manualPreviewContainer {
        background: var(--glass-layer-2);
        animation: panelBlurOut 0.35s ease reverse;
        backdrop-filter: none;
    }
    #manualPanelSection.zoomed div#manualPreviewContainer {
        background: var(--glass-layer-5);
        animation: panelBlurIn 0.35s ease forwards;
        backdrop-filter: blur(10px);
    }

    
    #manualPanelSection.zoomed .manual-preview-content .btn-secondary:not(:hover) {
        transition: background 0.2s ease;
    }
    #manualPanelSection:not(.zoomed) .manual-preview-content .btn-secondary:not(:hover) {
        background: var(--glass-layer-3);
        transition: background 0.2s ease;
    }
    
    #manualPreviewSeedBtn {
        display: none;
    }

    @keyframes panelBlurIn {
        0% {
            background: var(--glass-layer-2);
            backdrop-filter: none;
        }
        0.01% {
            background: var(--glass-layer-2);
            backdrop-filter: blur(0px);
        }
        100% {
            background: var(--glass-layer-5);
            backdrop-filter: blur(10px);
        }
    }
    @keyframes panelBlurOut {
        0% {
            background: var(--glass-layer-2);
            backdrop-filter: none;
        }
        0.01% {
            background: var(--glass-layer-2);
            backdrop-filter: blur(0px);
        }
        100% {
            background: var(--glass-layer-5);
            backdrop-filter: blur(10px);
        }
    }

    @keyframes panelSlideIn {
        0% {
            width: 100%;
            min-width: 0%;
            position: relative;
            height: 100%;
            z-index: inherit;
        }
        0.01% {
            width: calc(100% - 650px);
            min-width: calc(100% - 650px);
            position: absolute;
            height: calc(100% - var(--spacing-lg));
            z-index: var(--z-layer-10);
        }
        100% {
            width: 90%;
            min-width: min(85%, max(1300px, calc(100% - 650px)));
            position: absolute;
            height: calc(100% - var(--spacing-lg));
            z-index: var(--z-layer-10);
        }
    }

    @keyframes panelSlideOut {
        0% {
            width: 100%;
            min-width: 0%;
            position: relative;
            height: 100%;
            z-index: inherit;
        }
        0.01% {
            width: calc(100% - 650px);
            min-width: calc(100% - 650px);
            position: absolute;
            height: calc(100% - var(--spacing-lg));
            z-index: var(--z-layer-10);
        }
        100% {
            width: 90%;
            min-width: min(85%, max(1300px, calc(100% - 650px)));
            position: absolute;
            height: calc(100% - var(--spacing-lg));
            z-index: var(--z-layer-10);
        }
    }

    #closeManualBtn {
        display: none;
    }
    
    .workspace-tabs {
        position: absolute;
        top: -1px;
        left: 0;
        background: transparent;
        padding: 0 var(--spacing-xxl) var(--spacing-xl) var(--spacing-lg);
        z-index: -2;
        display: flex;
        gap: var(--spacing-xs);
        align-items: flex-start;
        justify-content: flex-start;
        flex-wrap: nowrap;
        transition: all 0.2s ease;
        overflow: hidden;
    }

    .workspace-tabs.inactive .workspace-tab {
        top: -35px !important;
    }
    
    body:not(.editor-open) .header-container:hover .workspace-tab:not(.inactive),
    .workspace-tabs:hover:not(.inactive) {
        padding-bottom: 95px;
        padding-right: 150px;
    }
    
    .workspace-tab {
        border-radius: var(--border-radius-md);
        border-top-left-radius: 0;
        border-top-right-radius: 0; 
        backdrop-filter: var(--glass-blur-2, none);
        padding: var(--spacing-sm) var(--spacing-sm) var(--spacing-xs) var(--spacing-sm);
        min-height: 40px;
        min-width: 100px;
        max-width: 100px;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        justify-content: flex-start;
        top: -14px;
        margin-top: -2px;
        background: var(--glass-layer-alt-3, var(--glass-layer-3));
        color: var(--text-color);
        border: 1px solid var(--glass-border-3);
        box-shadow: 0px -2px 20px #20202026;
        font-variation-settings: "wght" 175;
        font-weight: 100;
        transform: translateZ(0);
        will-change: backdrop-filter;
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        position: relative;
        opacity: 0.65;
        transition: all 0.2s ease, min-width 0.4s ease, max-width 0.4s ease;
    }

    .workspace-tab span,
    .workspace-tab i {
        opacity: 0.15;
        transition: opacity 0.2s ease;
    }
    .workspace-tab::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        opacity: 0;
        transition: opacity 0.2s ease;
    }
    
    .workspace-tab:hover::before {
        opacity: 1;
    }

    /* Disable header hover effects when editor is open */
    body:not(.editor-open) .header-container:hover .workspace-tabs .workspace-tab,
    body:not(.editor-open) .workspace-tabs:hover .workspace-tab {
        min-width: 150px;
        max-width: 150px;
        top: -4px;
        padding: var(--spacing-md) var(--spacing-sm) var(--spacing-sm) var(--spacing-sm);
        opacity: 0.9;
    }
    
    body:not(.editor-open) .header-container:hover .workspace-tabs .workspace-tab span,
    body:not(.editor-open) .workspace-tabs:hover .workspace-tab span,
    body:not(.editor-open) .header-container:hover .workspace-tabs .workspace-tab i,
    body:not(.editor-open) .workspace-tabs:hover .workspace-tab i {
        opacity: 1;
    }
    
    .workspace-tab:hover {
        transform: translateY(1px);
        box-shadow: 0px -2px 20px #ffffff43;
    }
    
    .workspace-tab.active {
        color: var(--active-tab-text);
        background: var(--active-tab-bg);
        border-color: var(--hover-show-active-border);
        box-shadow: 0px -2px 20px #ffffff1d;
        min-width: 150px;
        max-width: 150px;
    }
    
    .workspace-tab.active::before {
        opacity: 0.2;
    }
    
    /* Animation for workspace tab transitions */
    .workspace-tab {
        animation: tabSlideIn 0.3s ease-out;
    }

    .workspace-tab.active span {
        opacity: 1;
        transition: opacity 0.2s ease;
    }
    
    .workspace-tabs:not(:hover) .workspace-tab.active {
        top: calc(var(--spacing-xs) * -1);
    }

    .workspace-tab.active {
        top: 0px;
        font-variation-settings: "wght" 350;
        font-weight: 300;
        opacity: 1;
    }

    body:not(.editor-open) .header-container:hover .workspace-tabs .workspace-tab.active,
    body:not(.editor-open) .workspace-tabs:hover .workspace-tab.active {
        top: 0px;
    }

    .editor-open .workspace-tabs {
        padding-bottom: 0;
        pointer-events: none;
        max-height: 12px;
    }
    .editor-open .workspace-tabs .workspace-tab,
    .editor-open .workspace-tabs .workspace-tab.active {
        min-height: unset;
        top: -22px !important;
        pointer-events: none !important;
        opacity: 0.5 !important;
    }

    .editor-open .workspace-tabs .workspace-tab.active {
        opacity: 0.75 !important;
    }

    .workspace-controls {
        display: none !important;
    }

    @keyframes tabSlideIn {
        from {
            transform: translateY(-25px);
        }
        to {
            transform: translateY(0);
        }
    }
    
    .workspace-tab .workspace-color-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        flex-shrink: 0;
    }
    
    .workspace-tab .workspace-name {
        font-variation-settings: "wght" 350;
        font-weight: 300;
    }
    
    .workspace-tab .workspace-counts {
        font-size: 0.8rem;
        opacity: 0.7;
    }

    .workspace-tabs .workspace-tab.workspace-options-tab {
        top: -40px;
        min-width: 54px;
        justify-content: center;
    }

    body:not(.editor-open) .header-container:hover .workspace-tabs .workspace-tab.workspace-options-tab,
    body:not(.editor-open) .workspace-tabs:hover .workspace-tab.workspace-options-tab {
        justify-content: center;
        min-width: 45px;
        max-width: 45px;
    }
    
    /* Adjust container to account for fixed tabs */
    .container {
        padding-bottom: 80px;
    }
    
    /* Responsive adjustments for workspace tabs */
    @media (max-width: 1600px) {
        .workspace-tab {
            min-width: 100px;  
            font-size: 0.85rem;
        }
    }
    
    @media (max-width: 1500px) {
        .workspace-tab {
            min-width: 85px;
            font-size: 0.8rem;
        }

        body:not(.editor-open) .header-container:hover .workspace-tabs .workspace-tab, 
        body:not(.editor-open) .workspace-tabs:hover .workspace-tab {
            min-width: 135px;
            max-width: 135px;
        }
        
        .workspace-tab .workspace-counts {
            display: none;
        }
    }
    .manual-preview-handle {
        display: none;
    }
}

/* Mobile/Tablet styles - hide preview section */
@media (max-width: 1399px) {
    .custom-dropdown.dropup .custom-dropdown-menu::before {
        top: 100%;
        border-top-color: var(--glass-layer-dark-menu);
        border-bottom-color: transparent;
    }
    .manual-preview-image-container {
        border-bottom: 1px solid var(--glass-border-5);
    }
    .manual-preview-handle {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: flex-start;
        overflow: hidden;
        padding-bottom: 15px;
        pointer-events: none;
    }
    .manual-modal-preview-section {
        display: none;
        position: absolute;
        top: -100%;
        left: 0;
        z-index: 105;
        opacity: 0;
        width: 100%;
        height: 100%;
        margin-bottom: 0;
        backdrop-filter: var(--glass-blur-1, none);
        transform: translateZ(0);
        will-change: backdrop-filter, opacity, top;
        transition: opacity 0.2s ease, top 0.5s ease;
    }
    .show-preview .manual-modal-preview-section {
        display: flex;
    }
    .show-preview .control-holder {
        overflow: hidden;
        height: 0;
    }
    
    .manual-modal-preview-section.active {
        top: 0;
        opacity: 1;
        transform: translateZ(0);
        will-change: backdrop-filter, opacity, top;
        transition: opacity 0.2s ease, top 0.5s ease;
    }
    .manual-preview-container {
        background: var(--glass-overlay-bg, rgb(197 197 197 / 88%));
    }
    #manualModelGroup {
        flex: 0 1 auto;
    }
    .manual-preview-controls {
        padding: 0 var(--spacing-xxl) var(--spacing-xxl);
        bottom: 0;
        right: 0;
        flex-direction: row;
        transform: none;
    }
}

/* General form input styles */
input[type="email"],
input[type="password"],
input[type="search"],
input[type="tel"],
input[type="url"],
textarea,
select {
    appearance: none;
    -webkit-appearance: none;
    -webkit-border-radius: 0;
    border-radius: 3px;
    -webkit-tap-highlight-color: transparent;
}

/* Remove Firefox specific styling */
input::-moz-focus-inner,
button::-moz-focus-inner {
    border: 0;
    outline: none;
}

.form-control[type="number"] {
    appearance: textfield;
    -webkit-appearance: textfield;
}

.manual-modal-content h2 {
    color: var(--primary-color);
    margin-bottom: 25px;
    text-align: center;
    text-transform: uppercase;
}

.prompt-options-container {
    display: flex;
    flex-direction: column;
    gap: 0;
    overflow: hidden;
    padding: 0;
    height: 100%;
    justify-content: space-between;
}

.form-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
    padding: var(--spacing-lg);
}

.control-holder {
    display: flex;
    gap: 0.75rem;
    flex-direction: column;
}

.form-section-scroll {
    overflow-y: hidden;
    overflow-x: visible;
    height: 100%;
    padding: 0;
    position: relative; /* For custom scrollbar positioning */
    flex: 1;
    /* Ensure touch scrolling works properly */
    touch-action: pan-y;
    -webkit-overflow-scrolling: touch;
}

.form-section-scroll .scrollable-content {
    padding: 0 var(--spacing-lg) var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

/* Custom scrollbar container */
.form-section-scroll .custom-scrollbar {
    position: absolute;
    top: var(--spacing-lg); /* Padding from top */
    right: 0;
    width: 8px;
    height: calc(100% - calc(var(--spacing-lg) * 2)); /* Subtract top and bottom padding */
    background: transparent;
    border-radius: 4px;
    opacity: 0;
    transition: opacity 0.2s ease;
    z-index: 1000; /* Ensure it's above other elements */
}

/* Custom scrollbar thumb */
.form-section-scroll .custom-scrollbar-thumb {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 80px; /* Static height */
    background: var(--glass-layer-5);
    border-top-left-radius: var(--border-radius-lg);
    cursor: pointer;
    transition: background 0.2s ease;
    border-bottom-left-radius: var(--border-radius-lg);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    /* Show scrollbar on hover */
    .form-section-scroll:hover .custom-scrollbar {
        opacity: 1;
    }

    .form-section-scroll .custom-scrollbar-thumb:hover {
        background: var(--primary-color-light);
    }
}

/* Scrollable content wrapper */
.form-section-scroll .scrollable-content {
    height: 100%;
    overflow-y: auto;
    overflow-x: visible;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
    -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on iOS */
    touch-action: pan-y; /* Enable vertical touch scrolling */
}

/* Hide webkit scrollbars */
.form-section-scroll .scrollable-content::-webkit-scrollbar {
    display: none;
}

.form-section.model-control {
    padding-top: 0;
    gap: var(--spacing-sm);
    line-height: 1;;
}

.form-section.model-control .control-holder {
    flex-wrap: wrap;
}

/* Custom scrollbar styles for form-section-scroll only */
.form-section-scroll::-webkit-scrollbar {
    display: none;
}



.form-row label {
    font-weight: 500;
    color: var(--text-primary);
}

.form-row input,
.form-row .percentage-input-container {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-primary);
    font-family: var(--font-mono);
}

.form-row .percentage-input-container input {
    font-family: unset;
    font-size: unset;
    font-weight: unset;
    font-variation-settings: unset;
    line-height: unset;
    text-align: unset;
    text-transform: unset;
    letter-spacing: unset;
    cursor: ns-resize;
}

.form-row input:focus,
.form-row .percentage-input-container:focus-within {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px rgba(var(--accent-primary-rgb), 0.2);
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.form-group-row {
    display: flex;
    flex-direction: row;
    gap: var(--spacing-xs);
}

.form-group label {
    text-transform: uppercase;
    color: var(--primary-color-light);
    font-variation-settings: "wght" 750;
    font-weight: 600;
    font-size: 0.75rem;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 4px;
}

/* Form Controls - Layered Glass System */
.form-control {
    border: 1px solid var(--glass-border-2);
    background: var(--glass-layer-2);
    color: var(--text-primary);
    font-size: 1rem;
    transition: all var(--transition-normal);
    padding: 0.6em;
    min-height: 32px;
    box-sizing: border-box;
    border-radius: var(--border-radius-md);
    box-shadow: var(--glass-shadow-2);
    position: relative;
    z-index: var(--z-layer-2);
}

.form-control:hover {
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
}
.form-control:focus, 
.form-control:active {
    background: var(--glass-layer-4);
    border: 1px solid var(--glass-border-4);
}

.hover-show,
.modal-content .hover-show,
.custom-dropdown-btn.hover-show,
.form-control.hover-show,
.percentage-input-container.hover-show {
    border: 1px solid transparent;
    background: transparent;
    color: var(--text-primary);
    padding: 0.35em 1.2em 0.35em 0;
    transition: all var(--transition-normal);
    backdrop-filter: none;
    box-shadow: none;
    display: flex;
    justify-content: flex-start;
    gap: var(--spacing-xs);
    align-items: center;
}

.hover-show.right,
.percentage-input-container.hover-show.right {
    text-align: right;
    justify-content: end;
    padding: 0.35em 0em 0.35em 1.2em;
}

.percentage-input-container.hover-show input {
    color: var(--text-primary);
}

.hover-show:hover,
.modal-content .hover-show:hover,
.modal-content .hover-show:focus,
.custom-dropdown-btn.hover-show:hover,
.form-control.hover-show:hover,
.percentage-input-container.hover-show:hover,
.percentage-input-container.hover-show:focus-within {
    color: var(--text-primary);
    background: var(--glass-layer-4);
    padding: 0.35em 0.6em;
    outline: none;
    appearance: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 20px rgb(255 255 255 / 12%);
    z-index: var(--z-layer-3);
}


.percentage-input-container.hover-show input {
    transition: color 0.2s ease;
}
.percentage-input-container.hover-show input:focus {
    color: var(--text-primary);
    transition: color 0.2s ease;
}
.percentage-input-container.hover-show:focus-within .percentage-input-overlay {
    transition: color 0.2s ease 0.3s;
}

.form-control::placeholder {
    color: var(--text-muted);
}

.form-control option {
    background: var(--bg-quaternary);
    color: var(--text-primary);
}

/* Prompt textarea container and background */
.prompt-textarea-container,
.character-prompt-textarea-container {
    background: rgb(0 0 0 / 28%);
    border: 1px solid var(--glass-inset-bg-5);
    border-radius: var(--border-radius-md);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    transition: all var(--transition-normal);
    overflow: visible;
    font-size: 1.1rem;
    line-height: 1.75;
}

.prompt-textarea-container {
    position: relative;
    width: 100%;
    height: auto;
    min-height: 80px;
}

.character-prompt-textarea-container {
    position: relative;
    width: 100%;
    height: auto;
    min-height: 80px;
}

.prompt-textarea-background,
.character-prompt-textarea-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgb(0 0 0 / 28%);
    border: 1px solid var(--glass-inset-bg-5);
    border-radius: var(--border-radius-md);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    z-index: 1;
    transition: all var(--transition-normal);
}

.prompt-textarea-container.textarea-focused,
.character-prompt-textarea-container.textarea-focused {
    background: var(--glass-layer-alt-5, rgb(32, 32, 32, 0.69));
    border: 1px solid var(--btn-hover-border-primary);
    box-shadow: inset 0 0px 8px var(--hover-show-active-border);
}

/* Prompt textarea toolbar */
.prompt-textarea-toolbar {
    position: relative;
    border-top: 1px solid var(--glass-inset-bg-5);
    border-radius: 0 0 var(--border-radius-md) var(--border-radius-md);
    padding: 8px 8px 8px 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 6;
    line-height: 1;
    transition: all var(--transition-normal);
    margin-top: 6px;
    min-height: 46px;
    background: var(--glass-inset-bg-5);
}

.prompt-textarea-toolbar.hidden {
    opacity: 0;
    max-height: 0;
    padding: 0 12px;
    margin-top: 0;
    pointer-events: none;
    overflow: hidden;
}

/* Search Mode Styles */
.prompt-textarea-toolbar .toolbar-search-elements,
.prompt-textarea-toolbar .toolbar-search-buttons {
    display: none;
}

.prompt-textarea-toolbar .toolbar-regular-buttons {
    display: flex;
    align-items: center;
    gap: 4px;
}

.prompt-textarea-toolbar.search-mode .toolbar-search-elements {
    display: flex;
    align-items: center;
    gap: 8px;
}

.prompt-textarea-toolbar.search-mode .toolbar-search-buttons {
    display: flex;
    align-items: center;
    gap: 4px;
}

.prompt-textarea-toolbar.search-mode .token-count,
.prompt-textarea-toolbar.search-mode .toolbar-regular-buttons {
    display: none;
}

/* Emphasis mode styles */
.prompt-textarea-toolbar.emphasis-mode .toolbar-regular-buttons,
.prompt-textarea-toolbar.emphasis-mode .toolbar-search-elements {
    display: none;
}

.prompt-textarea-toolbar.emphasis-mode .toolbar-emphasis-elements {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    justify-content: flex-start;
}

.prompt-textarea-toolbar .toggle-btn[data-state="on"] {
    transform: none;
}
.toolbar-emphasis-elements {
    display: none;
    align-items: center;
    gap: var(--spacing-sm);
}

.toolbar-emphasis-elements .emphasis-toolbar {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.toolbar-emphasis-elements .emphasis-value {
    font-weight: bold;
    font-variation-settings: "wght" 500;
    font-size: 1.1em;
    text-align: center;
}

.toolbar-emphasis-elements .emphasis-type {
    font-size: 0.8em;
    color: var(--text-secondary);
    padding: 2px 6px;
}

.toolbar-emphasis-elements .emphasis-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.toolbar-emphasis-elements .emphasis-btn {
    padding: 2px 12px;
    min-width: 45px;
}

.toolbar-emphasis-elements .emphasis-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-left: var(--spacing-xs);
}

.toolbar-emphasis-elements .emphasis-apply:hover {
    background: var(--success-hover-color, #218838);
    border-color: var(--success-hover-color, #218838);
}

.toolbar-emphasis-elements .emphasis-cancel:hover {
    background: var(--danger-hover-color, #c82333);
    border-color: var(--danger-hover-color, #c82333);
}

.prompt-textarea-toolbar .toolbar-search-elements .text-search-label {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-weight: bold;
    text-transform: uppercase;
    white-space: nowrap;
}

.prompt-textarea-toolbar .toolbar-search-elements .text-search-input-container {
    flex: 1;
    min-width: 150px;
}

.prompt-textarea-toolbar .toolbar-search-elements .text-search-input {
    width: 100%;
    padding: 4px 8px;
    border: 1px solid var(--border-secondary);
    border-radius: var(--border-radius-sm);
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-size: 14px;
    transition: border-color 0.2s ease;
    cursor: text;
    pointer-events: auto;
}

.prompt-textarea-toolbar .toolbar-search-elements .text-search-input:focus {
    outline: none;
    border-color: var(--border-focus);
    box-shadow: 0 0 0 2px rgba(0, 191, 255, 0.2);
}

.prompt-textarea-toolbar .toolbar-search-elements .text-search-match-count {
    font-family: var(--font-mono);
    font-weight: bold;
    padding: 2px 8px;
    border-radius: var(--border-radius-sm);
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-1);
    min-width: 40px;
    text-align: center;
    color: #96e5ff;
}

@keyframes searchModeSlideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.prompt-textarea-container.textarea-focused .prompt-textarea-toolbar {
    opacity: 1;
    max-height: 50px;
}

.toolbar-left {
    display: flex;
    align-items: center;
}

.toolbar-right {
    display: flex;
    align-items: center;
    gap: 4px;
}

.token-count {
    font-size: 0.85em;
    color: var(--text-secondary);
    font-family: var(--font-mono);
}

.toolbar-btn:focus {
    outline: none;
}

/* Loading states for dataset tag toolbar */
.dataset-tag-dropdown-wrapper.loading .custom-dropdown-btn {
    opacity: 0.7;
    cursor: wait;
}

/* Loading spinner for dataset tag toolbar */
.dataset-tag-loading-spinner {
    display: flex;
    align-items: center;
    gap: 6px;
    color: var(--text-primary);
    font-size: 14px;
    margin-right: 8px;
    padding: 4px 8px;
    background-color: rgba(0, 123, 255, 0.1);
    border-radius: 4px;
    border: 1px solid rgba(0, 123, 255, 0.2);
}

.prompt-textarea-toolbar .divider {
    border: 1px solid var(--glass-inset-bg-1);
    display: block;
    height: 24px;
    margin: 0 3px;
}

/* Prompt textarea specific height */
.prompt-textarea,
.character-prompt-textarea {
    width: 100%;
    height: auto;
    resize: none;
    min-height: 80px;
    border: 1px solid transparent;
    font-family: var(--font-mono);
    font-size: 1em;
    padding: 0.6em;
    border-radius: var(--border-radius-md);
    transition: all var(--transition-normal);
    line-height: 1.5;
    line-break: anywhere;
    background: transparent;
    position: relative;
    z-index: 2;
    overflow: hidden;
}

#manualPrompt {
    backdrop-filter: none !important;
}

.prompt-textarea:hover,
.prompt-textarea:focus,
.prompt-textarea:active,
.character-prompt-textarea:hover,
.character-prompt-textarea:focus,
.character-prompt-textarea:active {
    background: rgba(255, 255, 255, 0.25);
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid rgba(255, 255, 255, 1);
}

div#characterPromptsContainer {
    padding-top: var(--spacing-lg);
}

/* Inset textarea styling */
.textarea-inset,
.textarea-inset:hover  {
    background: #ffffff1f;
    border: 1px solid var(--glass-inset-bg-5);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    transition: all var(--transition-normal);
    position: relative;
}

.textarea-inset::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, transparent 50%, rgba(0, 0, 0, 0.1) 100%);
    border-radius: var(--border-radius-md);
    pointer-events: none;
    z-index: 1;
}

.textarea-inset:focus {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.4);
    outline: none;
}

.textarea-inset textarea {
    background: transparent;
    border: none;
    color: var(--text-primary);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    width: 100%;
    height: 100%;
    resize: none;
    outline: none;
    position: relative;
    z-index: 2;
}

.textarea-inset textarea::placeholder {
    color: var(--text-muted);
}

/* Resolution group with upscale toggle */
.resolution-group {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.resolution-group .form-control {
    flex: 1;
}

/* Custom resolution inputs */
.custom-resolution-inputs {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
    flex: auto;
}

.custom-resolution-inputs input[type="number"] {
    text-align: center;
    padding: 0.35em 0.6em;
    font-size: 1em;
    font-family: var(--font-primary);
    flex: auto;
    color: #ff8153;
    background: transparent;
    font-weight: 400;
}

.custom-resolution-inputs #manualHeight:not(:hover) {
    padding: 0.35em 1.2em 0.35em 0em;
}
.custom-resolution-inputs #manualWidth:not(:hover) {
    padding: 0.35em 0em 0.35em 1.2em;
}

.custom-resolution-inputs input[type="number"]::-webkit-outer-spin-button,
.custom-resolution-inputs input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.custom-resolution-inputs input[type="number"] {
    appearance: textfield;
    -webkit-appearance: textfield;
}

/* Seed input group with clear button and layer1 seed toggle */
.seed-input-group {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.seed-input-group .form-control {
    flex: 1;
}

/* Icon-only toggle buttons */
.toggle-btn.icon-only {
    min-width: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-normal);
}


/* Form row layout updates */
.form-row {
    display: flex;
    gap: 10px;
    align-items: flex-end;
}

.form-col {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.form-col .form-row {
    margin-bottom: 0;
}
.form-row.separator {
    border-top: 2px solid var(--border-divider);
    padding-top: 10px;
}

.form-row .form-group {
    flex: 1;
}

/* Ensure form controls have consistent sizing */
.form-row .form-control {
    width: 100%;
    box-sizing: border-box;
}


.modal-actions.btn-group {
    justify-content: flex-end;
}

#transformationRow:not(.display-image) #transformationSection {
    display: none;
}

#transformationRow .btn-danger {
    min-width: 32px;
    padding: 0.5em;
}

#transformationRow:not(.display-vibe) #vibeReferencesContainer {
    display: none;
}

#transformationRow.display-vibe:not(.display-image) .vibe-references-container {
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-areas: ". . .";
}

#transformationRow:not(.display-image):not(.display-vibe) {
    display: none;
}

#transformationDropdown.disabled {
    opacity: 0.5;
    pointer-events: none;
}

#transformationDropdown.disabled button {
    cursor: not-allowed;
}

/* Remove the old layer1 seed toggle group styles since it's now integrated */
#layer1SeedToggleGroup {
    display: none;
}

#layer1SeedToggleGroup.show {
    display: block;
}

.form-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-md);
    padding-top: var(--spacing-lg);
}
/* File Search Styles */

.file-search-container {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin-left: 0;
    position: relative;
    width: 0;
    opacity: 0;
    transform: scaleX(0);
    transform-origin: left;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1;
    gap: var(--spacing-sm);
}

.file-search-container.closed {
    width: 0;
    opacity: 0;
    transform: scaleX(0);
    overflow: hidden;
    min-height: 0;
}

.file-search-container:not(.closed) {
    width: auto;
    opacity: 1;
    transform: scaleX(1);
}

.search-input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
    justify-content: center;
}

.search-icon {
    position: absolute;
    left: 10px;
    color: var(--text-muted);
    font-size: 14px;
    pointer-events: none;
    z-index: 1;
}

.file-search-input {
    width: 500px;
    max-width: 75vw;
    min-width: 200px;
    font-family: var(--font-secondary);
    font-size: 12pt;
    padding: 0.2em 0.6em 0;
}

.file-search-input::placeholder {
    color: var(--text-muted);
}
/* File search autofill overlay positioning */
#fileSearchAutofill {
    position: fixed;
    z-index: 1000;
    overflow: hidden;
    transition: all 0.2s ease;
    min-width: 300px;
    max-width: 400px;
    /* Ensure overlay doesn't get cut off by viewport */
    max-height: min(500px, calc(100vh - 200px));
    transition: max-height 0.2s ease;
}

/* Ensure autofill popup has proper dimensions and positioning */
#fileSearchAutofill .character-autocomplete-list {
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--glass-border-2) transparent;
    flex-direction: column-reverse;
}

#fileSearchAutofill.expanded {
    max-height: min(800px, calc(100vh - 200px));
}

/* Custom scrollbar styling for webkit browsers */
#fileSearchAutofill .character-autocomplete-list::-webkit-scrollbar {
    width: 6px;
}

#fileSearchAutofill .character-autocomplete-list::-webkit-scrollbar-track {
    background: transparent;
}

#fileSearchAutofill .character-autocomplete-list::-webkit-scrollbar-thumb {
    background: var(--glass-border-2);
    border-radius: 3px;
}

#fileSearchAutofill .character-autocomplete-list::-webkit-scrollbar-thumb:hover {
    background: var(--glass-border-1);
}

#fileSearchAutofillList .character-autocomplete-item.more-indicator {
    order: -10;
}
#fileSearchAutofillList .character-autocomplete-item.search-status-display  {
    order: -5;
}

@media (max-width: 1400px) {
    .file-search-input {
        width: 240px;
    }
}

@media (max-width: 1200px) {
    .file-search-input {
        width: 200px;
    }
}

@media (max-width: 1000px) {
    
    .file-search-input {
        width: 180px;
        font-size: 13px;
    }
}

/* Responsive adjustments for manual modal */
@media (max-width: 1399px) {
    @media (min-height: 1300px) {
        .manual-modal-content {
            margin: auto;
        }
    }
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-content h2 {
    color: #ff4500;
    margin-bottom: 15px;
    text-align: center;
}

.modal-content p {
    margin-bottom: 20px;
    text-align: center;
    color: #cccccc;
}

.modal-content input {
    width: 100%;
    font-size: 1rem;
}

/* Lightbox Styles */
.lightbox-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: hsl(0 0% 0% / 75%);
    z-index: 1000;
    overflow: hidden;
    touch-action: none;
}

/* Close button overlay */
.lightbox-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: hsl(0 0% 100% / 10%);
    border: none!important;
    color: white;
    font-size: 1.5rem;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 1001;
    backdrop-filter: var(--glass-blur-2, none);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .lightbox-close-btn:hover {
        background: hsl(0 0% 100% / 20%);
        transform: scale(1.1);
    }
}
/* Move close button when prompt panel is open */
.lightbox-close-btn.prompt-panel-open {
    right: 420px; /* 400px panel width + 20px margin */
}

.lightbox-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100%;
}

/* Main content area with image and prompt panel side by side */
.lightbox-main-content {
    display: flex;
    flex: 1;
    min-height: 0;
}

/* Image and controls section */
.lightbox-image-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: initial;
}

/* Image container */
.lightbox-image-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: default;
    user-select: none;
    touch-action: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    /* Enhanced touch support */
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-manipulation: none;
    overscroll-behavior: none;
    /* Ensure touch events work properly */
    z-index: 10;
}

.lightbox-image-container.zoomed {
    cursor: grab;
}

.lightbox-image-container.zoomed:active {
    cursor: grabbing;
}

#lightboxImage {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7);
    transition: transform 0.1s ease-out;
    transform-origin: center;
    user-select: none;
    pointer-events: none;
    touch-action: none;
}

/* Lightbox Navigation Buttons */
.lightbox-navigation {
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    transform: translateY(-50%);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    pointer-events: none;
    z-index: 1002;
}

.lightbox-nav-btn {
    background: hsl(0 0% 100% / 10%);
    border: none;
    color: white;
    font-size: 1.2rem;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    backdrop-filter: var(--glass-blur-2, none);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translateZ(0);
    will-change: backdrop-filter;
    pointer-events: auto;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .lightbox-nav-btn:hover {
        background: hsl(0 0% 100% / 20%);
        transform: scale(1.1);
    }
}

.lightbox-nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* Image Preview Navigation Buttons */
.image-preview-navigation {
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    transform: translateY(-50%);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    pointer-events: none;
    z-index: 1002;
}

.image-preview-nav-btn {
    background: hsl(0 0% 100% / 10%);
    border: none;
    color: white;
    font-size: 1.2rem;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    backdrop-filter: var(--glass-blur-2, none);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translateZ(0);
    will-change: backdrop-filter;
    pointer-events: auto;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .image-preview-nav-btn:hover {
        background: hsl(0 0% 100% / 20%);
        transform: scale(1.1);
    }
}

.image-preview-nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* Metadata Section */
.lightbox-metadata-section {
    background: #1a1a1abd;
    backdrop-filter: var(--glass-blur-2, none);
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    min-height: 200px;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Metadata Table Styles */
.metadata-grid {
    display: flex;
    flex-direction: column;
    gap: 16px;
    width: 100%;
}

.metadata-row {
    display: flex;
    gap: 16px;
    width: 100%;
    flex-wrap: wrap;
}

.metadata-cell {
    display: flex;
    flex-direction: column;
    padding: 12px 16px;
    background: hsl(0 0% 100% / 5%);
    min-height: 80px;
    flex: 1 0 auto;
    min-width: 120px;
}

.metadata-cell.metadata-model-cell {
    flex: auto;
    min-width: 200px;
}

.metadata-model-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex: 1;
    gap: 12px;
}

.metadata-model-content .metadata-value {
    flex: 1;
    margin: 0;
}

.metadata-buttons {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    flex-shrink: 0;
}

.metadata-cell.metadata-small {
    min-width: 200px;
    flex: 0 1 auto;
}

.metadata-cell.metadata-very-small {
    min-width: 100px;
    flex: 0 1 auto;
}

.metadata-label {
    color: #ff6b35;
    font-weight: 600;
    font-size: 0.8em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 6px;
}

.metadata-value {
    color: white;
    font-size: 0.95em;
    word-break: break-word;
    flex: 1;
    display: flex;
    align-items: center;
}

.metadata-btn {
    background: #ff6b35;
    color: white;
    border: none;
    padding: 6px 12px;
    font-size: 0.8em;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
    min-width: 100px;
    font-weight: bold;
    border-radius: 2px;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .metadata-btn:hover {
        background: #e55a2b;
    }

    .metadata-btn:active {
        background: #d14a1f;
    }
}

/* Expandable sections */
.metadata-expanded {
    margin-top: 16px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    overflow: hidden;
}

.metadata-expanded-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: rgba(255, 107, 53, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    color: #ff6b35;
    font-weight: 600;
}

.close-expanded {
    background: none;
    border: none;
    color: #ff6b35;
    font-size: 1.2em;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .close-expanded:hover {
        background: rgba(255, 107, 53, 0.2);
    }
}

.metadata-expanded-content {
    padding: 16px;
    color: white;
    font-size: 0.9em;
    line-height: 1.5;
    max-height: 300px;
    overflow-y: auto;
    white-space: pre-wrap;
    word-break: break-word;
}

/* Controls Section */
.lightbox-controls-section {
    display: flex;
    justify-content: center;
    flex-shrink: 0;
}

.lightbox-controls {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 800px;
}

/* Metadata Dialog (Mobile Only) */
.metadata-dialog {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    overflow-y: auto;
}

.metadata-dialog-content {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: 12px;
    margin: 20px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    overflow: hidden;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.metadata-dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.metadata-dialog-header h3 {
    color: white;
    margin: 0;
    font-size: 1.2em;
}

.close-dialog {
    background: none;
    border: none;
    color: white;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .close-dialog:hover {
        background: rgba(255, 255, 255, 0.2);
    }
}

.metadata-dialog-body {
    padding: 20px;
    max-height: 70vh;
    overflow-y: auto;
}

/* Prompt Panel Styles */
.prompt-panel {
    width: 400px;
    background: transparent;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transform: translateX(100%);
    transition: transform var(--transition-normal);
}

.prompt-panel.show {
    transform: translateX(0);
}

/* Ensure prompt panel takes full height of main content */
.prompt-panel {
    height: 100%;
}

.prompt-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg) var(--spacing-xl);
    background: var(--primary-gradient);
    color: var(--text-primary);
    border-bottom: 1px solid var(--border-secondary);
}

.prompt-panel-header h3 {
    margin: 0;
    font-size: 1.2rem;
    font-weight: 600;
}

.close-panel-btn {
    background: none;
    border: none;
    color: var(--text-primary);
    font-size: 1.2rem;
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: 50%;
    transition: background-color var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .close-panel-btn:hover {
        background: rgba(255, 255, 255, 0.2);
    }
}

.prompt-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-lg);
}

.prompt-section {
    margin-bottom: var(--spacing-xl);
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
}

.prompt-section:last-child {
    margin-bottom: 0;
}

.prompt-section-header {
    background: rgba(255, 107, 53, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: var(--spacing-md) var(--spacing-lg);
}

.prompt-section-header h4 {
    margin: 0;
    color: var(--primary-color);
    font-size: 0.8em;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prompt-section-content {
    padding: var(--spacing-lg);
    background: transparent;
}

.prompt-content {
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 0.95em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-break: break-word;
    max-height: 200px;
    overflow-y: auto;
}

.prompt-content:empty::before {
    content: "No content available";
    color: var(--text-muted);
    font-style: italic;
}

.character-prompts-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.character-prompt-item-panel {
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    background: #000000ad;
}

.character-prompt-item-panel:last-child {
    margin-bottom: 0;
}

.character-prompt-item-panel .character-name {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.8em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: var(--spacing-sm);
    display: flex;
    align-items: center;
    flex-wrap: wrap;
}

.character-prompt-item-panel .character-prompt-text {
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 0.95em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-break: break-word;
    flex: 1;
}

.character-prompt-item-panel .prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-sm);
}

.prompt-header:not(:first-child) {
    align-items: flex-end;
}
.prompt-header:not(:first-child) .character-name {
    opacity: 0.5;
    color: var(--secoundary-color);
    font-size: 0.6em;
}
.character-prompt-item-panel .prompt-copy-btn {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 100%;
    flex-shrink: 0;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .character-prompt-item-panel .prompt-copy-btn:hover {
        background: var(--bg-quaternary);
        color: var(--primary-color);
    }
    .character-prompt-item-panel .prompt-copy-btn:active {
        background: var(--bg-quinary);
        color: var(--primary-color);
    }
}

.character-prompt-item-panel .prompt-divider {
    height: 2px;
    background: var(--border-primary);
    margin: var(--spacing-md) 0;
    opacity: 0.5;
}

.character-prompt-item-panel .prompt-badges {
    display: flex;
    gap: var(--spacing-xs);
    margin-left: var(--spacing-sm);
    flex-wrap: wrap;
}

.character-prompt-item-panel .prompt-badge {
    display: inline-block;
    padding: 2px 4px 4px;
    border-radius: 3px;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    text-align: center;
    line-height: 1;
}

.character-prompt-item-panel .coordinate-badge {
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 1px 3px var(--shadow-primary);
}

.character-prompt-item-panel .disabled-badge {
    background: var(--danger-gradient);
    color: var(--text-primary);
    box-shadow: 0 1px 3px var(--shadow-danger);
}
.metadata-btn-mobile {
    display: none;
}
@media (max-height: 1024px) {   
    .lightbox-metadata-section {
        display: none;
    }
    
    /* Show metadata button on mobile */
    .metadata-btn-mobile {
        display: inline-block !important;
    }
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .lightbox-container {
        flex-direction: column;
    }
    
    .lightbox-image-section {
        flex: 1;
        padding: 10px;
    }
    
    .lightbox-controls-section {
        padding: 15px;
    }
    
    .lightbox-controls {
        gap: 8px;
    }
    
    
    /* Metadata dialog styles for mobile */
    .metadata-dialog-content {
        margin: 10px;
        max-width: none;
    }
    
    .metadata-dialog-header {
        padding: 15px;
    }
    
    .metadata-dialog-body {
        padding: 15px;
        max-height: 80vh;
    }
    
    .metadata-table {
        font-size: 0.9em;
    }
    
    .metadata-cell {
        padding: 8px 10px;
        width: 50%;
    }
    
    .metadata-table tbody tr {
        display: flex;
        flex-wrap: wrap;
    }
    
    .metadata-table tbody tr td:nth-child(1),
    .metadata-table tbody tr td:nth-child(2) {
        width: 50%;
    }
    
    .metadata-table tbody tr td:nth-child(3),
    .metadata-table tbody tr td:nth-child(4) {
        width: 50%;
    }
    
    .metadata-expanded-content {
        max-height: 200px;
    }
    
    /* Mobile layout */
    .lightbox-main-content {
        flex-direction: column;
    }
    
    .lightbox-image-section {
        flex: none;
        height: 100vh;
    }
    
    /* Mobile prompt panel */
    .prompt-panel {
        width: 100%;
        height: 40vh;
        transform: translateY(100%);
    }
    
    .prompt-panel.show {
        transform: translateY(0);
    }
    
    /* Move close button down on mobile when prompt panel is open */
    .lightbox-close-btn.prompt-panel-open {
        right: 20px;
        top: 60vh; /* Move down to be above the prompt panel */
    }
}

/* Toast Notifications */
.toast-container {
    position: fixed;
    top: calc(20px + env(safe-area-inset-top, 0));
    right: 20px;
    z-index: 3000;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    pointer-events: none;
    align-items: flex-end;
}

@keyframes toastSlideIn {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes toastSlideOut {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(100%);
    }
}

.toast.removing {
    animation: toastSlideOut 0.3s ease-in forwards;
}

/* Glass-style toast notifications */
.glass-toast {
    background: var(--glass-layer-dark-4);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg);
    padding: 10px 15px;
    color: var(--text-primary);
    font-size: 0.9rem;
    font-weight: 500;
    box-shadow: var(--glass-shadow-3);
    max-width: min(75vw, 800px);
    min-width: 300px;
    display: flex;
    align-items: center;
    gap: 12px;
    pointer-events: auto;
    cursor: pointer;
    transition: all var(--transition-normal);
    transform: translateX(100%) translateZ(0px);
    will-change: transform, opacity;
    backdrop-filter: var(--glass-blur-1, none);
    opacity: 0;
}

.glass-toast.show {
    transform: translateX(0);
    opacity: 1;
}

.glass-toast.removing {
    transform: translateX(100%);
    opacity: 0;
}

.glass-toast.upload-progress {
    background: var(--glass-layer-dark-5);
    border-color: var(--glass-border-2);
    box-shadow: 0 0 20px rgb(0 0 0 / 47%);
}

.glass-toast .toast-icon {
    font-size: 1.75rem;
    flex-shrink: 0;
}

.glass-toast .toast-content {
    flex: 1;
    min-width: initial;
}

.glass-toast .toast-title {
    font-weight: 600;
    margin-bottom: 4px;
    color: var(--text-primary);
}

.glass-toast .toast-message {
    color: var(--text-secondary);
    font-size: 0.85rem;
    line-height: 1.4;
}

.glass-toast .toast-progress {
    width: 100%;
    height: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    margin-top: 8px;
    overflow: hidden;
}

.glass-toast .toast-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color), var(--primary-color-light));
    border-radius: 2px;
    transition: width var(--transition-fast);
    width: 0%;
}

.glass-toast .toast-close {
    background: none;
    border: none;
    color: #ffbaba;
    cursor: pointer;
    padding: 10px 5px;
    font-size: 1.15rem;
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    flex-shrink: 0;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .glass-toast .toast-close:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-primary);
    }
}

/* Simple one-line toast styling */
.glass-toast.simple {
    color: #ffffff;
    padding: 12px 16px;
    min-width: 200px;
    max-width: 350px;
}

.glass-toast.simple .toast-content {
    flex: 1;
    text-align: center;
}

.glass-toast.simple .toast-message {
    font-size: 0.9rem;
    font-weight: 500;
}

/* Toast Button Styles */
.toast-buttons {
    display: flex;
    gap: 8px;
    margin-top: 12px;
    justify-content: flex-end;
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    ::-webkit-scrollbar-thumb:hover {
        background: var(--primary-color-light);
    }
}

/* Autocomplete Overlay Styles */
.autocomplete-overlay {
    position: absolute;
    background: rgb(38 38 38 / 84%);
    border: 1px solid rgb(0 0 0 / 40%);
    border-radius: 5px;
    max-height: 200px;
    overflow-y: auto;
    z-index: var(--z-overlay);
    box-shadow: 0 4px 12px var(--shadow-secondary);
    min-width: 200px;
}

.character-autocomplete-item[data-type="textReplacement"] {
    display: flex;
    flex-direction: column;
}
.character-info-row {
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
}
.placeholder-desc {
    font-size: 0.8em;
    color: #9be6ffc2;
}
.placeholder-desc {
    font-size: 0.8em;
    color: #9be6ffc2;
    overflow: clip;
    text-overflow: ellipsis;
    width: 100%;
    white-space: nowrap;
}

.autocomplete-list {
    padding: 0;
    margin: 0;
}

.autocomplete-item {
    padding: 10px 15px;
    cursor: pointer;
    border-bottom: 1px solid var(--border-secondary);
    color: var(--text-primary);
    transition: background-color var(--transition-fast);
}

.autocomplete-item:hover {
    background: #ff440095;
    color: var(--text-primary);
}

.autocomplete-item.selected {
    background: #ff440048;
    color: var(--text-primary);
}

.autocomplete-item:last-child {
    border-bottom: none;
}

.autocomplete-item .placeholder-name {
    font-weight: 600;
    color: var(--primary-color-light);
}

.autocomplete-item .placeholder-desc {
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-top: 2px;
}
/* Responsive breakpoints for metadata grid */
@media (max-width: 1200px) {
    .metadata-row {
        gap: 12px;
    }
    
    .metadata-cell {
        padding: 10px 14px;
        min-height: 70px;
        min-width: 205px;
    }
    
    .metadata-cell.metadata-model-cell {
        min-width: 180px;
    }
    
    .metadata-model-content {
        gap: 8px;
    }
    .metadata-cell.metadata-small {
        min-width: 180px;
        flex: 1 0 auto;
    }
    
    .metadata-cell.metadata-very-small {
        min-width: 120px;
        flex: 1 0 auto;
    }
}

@media (max-width: 900px) {
    .metadata-row {
        gap: 10px;
    }
    
    .metadata-cell {
        padding: 8px 12px;
        min-height: 60px;
        min-width: 150px;
    }
    
    .metadata-cell.metadata-model-cell {
        min-width: 160px;
    }
    
    .metadata-model-content {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
    }
    
    .metadata-buttons {
        width: 100%;
        justify-content: flex-start;
    }
}

@media (max-width: 600px) {
    .metadata-grid {
        gap: 12px;
    }
    
    .metadata-row {
        gap: 8px;
    }
    
    .metadata-cell {
        padding: 6px 10px;
        min-height: 50px;
        min-width: 80px;
    }
    
    .metadata-cell.metadata-model-cell {
        min-width: 140px;
    }
    
    .metadata-label {
        font-size: 0.7em;
    }
    
    .metadata-value {
        font-size: 0.85em;
    }
    
    .metadata-btn {
        padding: 4px 8px;
        font-size: 0.7em;
    }
}

/* Loading Overlay Styles */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2;
}

.loading-content {
    text-align: center;
    color: var(--hover-show-colored-text);
    max-width: 400px;
    width: 300px;
    background: var(--glass-layer-5);
    border: 1px solid var(--glass-border-5);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-xl);
    margin: var(--spacing-xxl);
}

.loading-content p {
    margin: 20px 0 0 0;
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary-color);
}

.loading-spinner {
    margin-bottom: 20px;
}

.loading-spinner i {
    font-size: 40px;
    color: var(--primary-color);
}

.loading-message {
    font-size: 18px;
    margin-bottom: 15px;
    font-weight: 500;
}

.loading-progress {
    width: 100%;
    height: 12px;
    background: var(--glass-layer-4);
    border-radius: 4px;
    overflow: hidden;
    border: 1px solid var(--glass-border-4);
}

.loading-progress-bar {
    height: 100%;
    background: var(--border-primary);
    border-radius: 4px;
    transition: width 0.3s ease;
    width: 0%;
}

.loading-progress-text {
    font-size: 14px;
    color: #cccccc;
    font-weight: 500;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid var(--bg-quaternary);
    border-top: 4px solid var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Workspace Loading Overlay */
.workspace-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    z-index: 1000;
    padding-top: var(--spacing-xxl);
}

.workspace-loading-content {
    text-align: center;
    color: white;
    background: var(--glass-layer-dark-5);
    padding: 1.5rem;
    border-radius: 8px;
    backdrop-filter: var(--glass-blur-2, none);
    border: 1px solid var(--glass-border-1);
}

.workspace-loading-content img {
    width: 128px;
    height: 128px;
    margin-bottom: 0.5rem;
}

.workspace-loading-content p {
    margin: 0;
    font-size: 1rem;
    font-weight: 500;
    color: #ffffff;
}

/* Confetti Styles */
#confettiContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1500;
    overflow: hidden;
}

.confetti {
    position: absolute;
    top: -10px;
    border-radius: 2px;
    animation: confettiFall 5s linear forwards;
    transform-origin: center;
}

@keyframes confettiFall {
    0% {
        transform: translateY(-10px) rotate(0deg);
        opacity: 1;
    }
    50% {
        transform: translateY(50vh) rotate(360deg);
        opacity: 0.8;
    }
    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

/* Confetti variations for more dynamic effect - slower timing for longer screen presence */
.confetti:nth-child(odd) {
    animation-duration: 4.5s;
    animation-delay: 0.1s;
}

.confetti:nth-child(even) {
    animation-duration: 5.5s;
    animation-delay: 0.2s;
}

.confetti:nth-child(3n) {
    animation-duration: 4.8s;
    animation-delay: 0.3s;
}

.confetti:nth-child(4n) {
    animation-duration: 5.2s;
    animation-delay: 0.4s;
}

.confetti:nth-child(5n) {
    animation-duration: 4.7s;
    animation-delay: 0.5s;
}

.confetti:nth-child(6n) {
    animation-duration: 5.8s;
    animation-delay: 0.6s;
}

.confetti:nth-child(7n) {
    animation-duration: 4.3s;
    animation-delay: 0.7s;
}

/* Disable scroll arrows (spinners) in number inputs */
.form-control[type="number"]::-webkit-outer-spin-button,
.form-control[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* Remove selection borders and highlights across all browsers */
input:focus,
select:focus,
textarea:focus,
button:focus {
    outline: none !important;
    appearance: none!important;
    -webkit-appearance: none !important;
    -webkit-tap-highlight-color: transparent !important;
}

/* Remove iOS Safari specific styling */
input[type="text"],
input[type="number"] {
    appearance: none;
    -webkit-appearance: none;
    -webkit-border-radius: 0;
    border-radius: 3px;
    -webkit-tap-highlight-color: transparent;
}

/* Set specific width for Steps, Guidance, and Rescale inputs on desktop/tablet */
@media (max-width: 1399px) {
    .full-viewport {
        display: none!important;
    }

    .form-row .form-group:has(#manualSteps) input,
    .form-row .form-group:has(#manualGuidance) input,
    .form-row .form-group:has(#manualRescale) .percentage-input-container {
        width: 58px;
    }
    
    .form-row .form-group:has(#manualSteps),
    .form-row .form-group:has(#manualGuidance),
    .form-row .form-group:has(#manualRescale) {
        flex: none;
    }

    .form-section.model-control .control-holder {
        flex-direction: row;
        gap: var(--spacing-md);
    }

    .form-section.model-control .control-holder .form-row.control-row-0 {
        order: 0;
    }
    .form-section.model-control .control-holder .form-row.control-row-1 {
        order: 1;
    }
    .form-section.model-control .control-holder .form-row.control-row-2 {
        order: 2;
        flex: 1 0 auto;
    }
    .form-section.model-control .control-holder .form-row.control-row-3 {
        order: 3;
    }
    .form-section.model-control .control-holder .form-row.control-row-4 {
        order: 4;
        flex: 1 0 auto;
    }
    .form-section.model-control .control-holder .form-row.control-row-5 {
        order: 5;
    }
}

/* Add border to all inputs and buttons except lightbox buttons */
input, 
button, 
select, 
textarea {
    border: 1px solid rgba(255, 69, 0, 0.58);
    padding: 0.6em;
    border-radius: var(--border-radius-md);
    background: transparent;
    transition: all var(--transition-normal);
    box-sizing: border-box;
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
}

select:hover,
select:focus,
textarea:hover,
textarea:focus {
    background: rgba(255, 255, 255, 0.25);
    padding: 0.6em;
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid rgba(255, 255, 255, 1);
}

/* Badge styles */
.badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    font-variation-settings: "wght" var(--wght-semibold);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: var(--badge-bg);
    color: var(--badge-text);
    box-shadow: var(--badge-shadow);
    white-space: pre;
}

.upscaled-badge {
    background: var(--badge-bg);
    color: var(--badge-text);
    box-shadow: var(--badge-shadow);
}

/* Variety icon styles */
.variety-icon {
    color: #32cd32; /* Lime green */
    margin-left: var(--spacing-sm);
    font-size: 0.9rem;
    animation: splotch-pulse 2s ease-in-out infinite;
}

@keyframes splotch-pulse {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.7;
        transform: scale(1.1);
    }
}

/* Character Autocomplete Styles */
.character-autocomplete-overlay {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    max-height: min(500px, 75vh);
    overflow-y: auto;
    min-width: 300px;
    max-width: 500px;
    width: 400px; /* Fixed width for consistency */
    scroll-behavior: smooth;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.character-autocomplete-list {
    padding: 0;
    display: flex;
    flex-direction: column;
}

.character-autocomplete-item {
    padding: 0.2em 0.5em;
    cursor: pointer;
    border-bottom: 1px solid var(--border-secondary);
    transition: background-color var(--transition-fast);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.character-autocomplete-item:hover {
    background: #3a3a3a;
}

.character-autocomplete-item.selected {
    background: var(--primary-color);
    color: var(--text-primary);
}

.character-autocomplete-item:last-child {
    border-bottom: none;
}

.character-autocomplete-item .character-name {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-start;
    font-weight: 600;
    font-size: 11px;
    color: var(--primary-color);
}

.character-autocomplete-item[data-type="character"] .character-name,
.character-autocomplete-item[data-type="tag"] .character-name {
    text-transform: uppercase;
}

.character-autocomplete-item .character-copyright {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-end;
    font-size: 0.7rem;
    color: var(--text-muted);
}


.character-autocomplete-item .tag-count-dots {
    display: flex;
    align-items: center;
    gap: 3px;
    margin-left: 6px;
    border-radius: 50%;
    flex-direction: row;
}

.character-autocomplete-item .tag-count-dots .count-dot {
    aspect-ratio: 1;
    padding: 5px;
    background: rgba(183, 159, 255, 0.0);
    border-radius: 100%;
    border: 1px solid rgb(255 255 255 / 60%);
}

/* Character items (default styling) */
.character-autocomplete-item .character-name {
    color: #ff4500; /* Orange for characters */
}

.character-autocomplete-item .character-copyright {
    color: #ff9b7a; /* Gray for character copyright */
}

/* Different colors for different item types */ 
.character-autocomplete-item[data-type="tag"] .character-name {
    color: #ffc1c1; /* Light blue for text replacements */
}
.character-autocomplete-item[data-type="tag"] .badge {
    background: #ff5113;
}

.character-autocomplete-item[data-type="tag"] .character-copyright {
    color: #ff8282; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="tag"]:hover {
    background: #4a1a1a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="tag"].selected {
    background: #cd5200; /* Orange background when selected */
}

/* Different colors for different item types */ 
.character-autocomplete-item[data-type="tag"][data-model-type="furry"] .character-name {
    color: #fb82ff; /* Light blue for text replacements */
}
.character-autocomplete-item[data-type="tag"][data-model-type="furry"] .badge {
    background: #a913ff;
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"] .character-copyright {
    color: #d382ff; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"]:hover {
    background: #3a1a4a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected {
    background: #ae00cd; /* Orange background when selected */
}

.character-autocomplete-item[data-type="tag"].global-match:hover {
    background: #5f4900; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="tag"].global-match.selected {
    background: #a27c00;
}

.character-autocomplete-item[data-type="tag"].global-match .character-name  {
    color: #ffe499;
}

.character-autocomplete-item[data-type="tag"].global-match.selected .character-name {
    color: #fffaf0;
}

.character-autocomplete-item[data-type="character"] .character-name {
    color: #74d471;
}

.character-autocomplete-item[data-type="character"] .character-copyright {
    color: #92b691; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="character"]:hover {
    background: #1c4a1a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="character"].selected {
    background: #00811e; /* Orange background when selected */
}

.character-autocomplete-item[data-type="character"].selected .character-name {
    color: #e7ffea;
}

.character-autocomplete-item[data-type="character"].selected .character-copyright {
    color: #64cc70 /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="textReplacement"] .character-name {
    color: #beeaff; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="textReplacement"] .character-copyright {
    color: #4fc3f7; /* Lighter blue for text replacement labels */
}

.character-autocomplete-item[data-type="textReplacement"]:hover {
    background: #1a3a4a; /* Darker blue background on hover */
}

.character-autocomplete-item[data-type="textReplacement"].selected {
    background: #0085cd; /* Orange background when selected */
}

/* Match type badges for text replacements */
.match-type-badge {
    display: inline-block;
    background: rgba(79, 195, 247, 0.2);
    color: #4fc3f7;
    font-size: 0.7em;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 8px;
    font-weight: 500;
    border: 1px solid rgba(79, 195, 247, 0.3);
}

.character-autocomplete-item[data-type="textReplacement"]:hover .match-type-badge {
    background: rgba(79, 195, 247, 0.3);
    border-color: rgba(79, 195, 247, 0.5);
}

.character-autocomplete-item[data-type="textReplacement"].selected .match-type-badge {
    background: rgba(79, 195, 247, 0.4);
    border-color: rgba(79, 195, 247, 0.6);
    color: #ffffff;
}

/* Show more indicator */
.character-autocomplete-item.more-indicator {
    background: var(--glass-layer-dark-3);
    border-top: 2px solid var(--primary-color);
    opacity: 0.8;
    order: 9999;
}

.character-autocomplete-item.more-indicator:hover {
    background: var(--glass-layer-dark-4);
}

.character-autocomplete-item.more-indicator .character-name {
    color: var(--text-muted);
    font-weight: normal;
}

/* Emphasis tooltip in autocomplete */
.character-autocomplete-tooltip {
    background: var(--glass-layer-dark-3);
    border-top: 1px solid var(--glass-border-2);
    padding: 6px 10px;
    text-align: center;
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
    opacity: 0.8;
}

.character-autocomplete-tooltip span {
    color: var(--primary-color);
    font-weight: 600;
}

/* Search status display styles */
.search-status-display {
    padding: 6px 8px;
    background: var(--glass-layer-2);
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: space-between;
    order: 9980;
}

#characterAutocompleteOverlay.expanded .search-status-display {
    position: sticky;
    bottom: 0;
    background: var(--glass-layer-dark-5);
}

/* Animation for search done state */
@keyframes searchDoneFade {
    0% { display: flex; }
    99% { display: flex; }
    100% { display: none; }
}

.search-status-display.search-done {
    animation: searchDoneFade 10s ease-out forwards;
}

.search-service-indicators {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: flex-end;
    gap: var(--spacing-sm);
    font-size: 0.75em;
}

.search-service-status {
    min-width: 14px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: var(--text-primary);
    opacity: 0.5;
}

.search-status-header {
    display: inline-flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: flex-start;
    gap: var(--spacing-xs);
    color: var(--primary-color-light);
    font-size: 0.8em;
}
.search-status-header i {
    min-width: 20px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.search-status-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.search-done .search-status-header {
    color: #d6ffdb;
}

.search-status-text {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.9em;
    font-weight: 500;
}

.search-service-status.status-searching {
    opacity: 1;
    color: #65afff;
}

.search-service-status.status-completed {
    opacity: 1;
    color: #8fff97;
}

.search-service-status.status-stalled {
    opacity: 1;
    color: #ff729e;
}

.search-service-icons {
    display: flex;
    gap: 8px;
    align-items: center;
}

.search-service-icon {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    color: white;
    position: relative;
}

.search-service-icon::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50%;
    background: currentColor;
    opacity: 0.3;
}

.search-service-icon.status-searching {
    animation: pulse 1.5s infinite;
}

.search-service-icon.status-completed {
    background: #4CAF50;
}

.search-service-icon.status-error {
    background: #f44336;
}

.search-service-icon.status-unknown {
    background: #9E9E9E;
}

/* Service-specific icon styles */
.search-service-icon.nai-sakura {
    background: #ff6b9d;
}

.search-service-icon.nai-paw {
    background: #ff9b35;
}

.search-service-icon.fas.fa-user {
    background: #4CAF50;
}

.search-service-icon.fas.fa-tag {
    background: #2196F3;
}

.search-service-icon.fas.fa-language {
    background: #9C27B0;
}

.search-service-icon.fas.fa-spell-check {
    background: #FF5722;
}

.search-service-icon.fas.fa-database {
    background: #607D8B;
}

.search-service-icon.fas.fa-question {
    background: #9E9E9E;
}

@keyframes pulse {
    0% {
        opacity: 0.3;
        transform: scale(1);
    }
    50% {
        opacity: 0.7;
        transform: scale(1.1);
    }
    100% {
        opacity: 0.3;
        transform: scale(1);
    }
}

/* Spell Check Styles */
.spell-check-section {
    background: var(--glass-layer-2);
    border-bottom: 1px solid var(--glass-border-2);
    padding: 6px 8px;
}

.spell-check-header {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.8rem;
    color: #ff6b6b;
    margin-bottom: 6px;
    font-weight: 500;
}

.spell-check-header i {
    color: #ff6b6b;
}

.spell-check-header .original-text {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
    margin-top: 2px;
    padding: 2px 4px;
    background: var(--glass-layer-dark-2);
    border-radius: var(--border-radius-sm);
    border: 1px solid var(--glass-border-1);
}

.misspelled-word {
    font-size: 0.85rem;
    color: #ff9c7d;
    font-weight: 500;
    margin-bottom: 8px;
    font-style: italic;
}

.suggestions-list {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
}

.suggestion-btn {
    background: rgb(163 27 0 / 20%);
    border: 1px solid rgb(207 132 37 / 31%);
    color: rgb(255 212 182 / 76%);
    padding: 2px 5px;
    border-radius: var(--border-radius-md);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.suggestion-btn:hover {
    background: rgb(141 49 0 / 95%);
    border-color: var(--glass-border-3);
    color: #ffdfd3;
}

.add-word-btn {
    background: var(--glass-layer-dark-3);
    border: 1px solid var(--glass-border-2);
    color: var(--text-muted);
    padding: 2px 6px;
    border-radius: var(--border-radius-sm);
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 3px;
}

.add-word-btn:hover {
    background: var(--glass-layer-dark-4);
    border-color: var(--glass-border-3);
    color: var(--text-primary);
}

.add-word-btn i {
    font-size: 0.7rem;
}

/* Spell check selection styles */
.spell-check-word.selected {
    border-radius: var(--border-radius-md);
    padding: 0px;
}

.suggestion-btn.selected {
    background: #c03400 !important;
    color: white !important;
    border-color: #fe500f !important;
}

.emphasis-header {
    display: flex;
    align-items: center;
    gap: 8px;
}

.emphasis-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
}

.emphasis-type {
    font-size: 0.8rem;
    color: var(--text-muted);
    padding: 2px 6px;
    white-space: nowrap;
    width: 100%;
    height: -webkit-fill-available;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    text-transform: uppercase;
    font-weight: bold;
}

.emphasis-type.mode-normal {
    color: #87ceeb; /* Light blue for new groups */
}

.emphasis-type.mode-brace {
    color: #ff8c00; /* Orange for brace blocks */
}

.emphasis-type.mode-group {
    color: #98fb98; /* Light green for existing groups */
}

.emphasis-text {
    font-family: var(--font-mono);
    font-size: 0.7rem;
    color: var(--text-secondary);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
    text-align: left;
}

.emphasis-value {
    font-family: var(--font-mono);
    font-size: 1.2rem;
    font-weight: bold;
    padding: 2px 8px;
    border-radius: var(--border-radius-sm);
    background: var(--glass-layer-dark-3);
    border: 1px solid var(--glass-border-2);
    min-width: 60px;
    text-align: right;
}

.emphasis-controls {
    display: flex;
    gap: 2px;
}


.emphasis-btn.emphasis-up:hover {
    background: #4ecdc4;
    border-color: #4ecdc4;
    color: white;
}

.emphasis-btn.emphasis-down:hover {
    background: #ff6b35;
    border-color: #ff6b35;
    color: white;
}

.emphasis-btn.emphasis-left:hover,
.emphasis-btn.emphasis-right:hover {
    background: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected .character-name,
.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected .character-copyright,
.character-autocomplete-item.selected .character-name,
.character-autocomplete-item.selected .character-copyright {
    color: var(--text-primary);
    opacity: 1;
    background: none;
}

.character-autocomplete-item[data-type="tag"][data-model-type="furry"].selected .badge,
.character-autocomplete-item.selected .badge,
.character-autocomplete-item.selected .tag-category-badge {
    color: var(--text-primary);
    opacity: 1;
    background: #303030;
}

/* Preset Autocomplete Styles */
.preset-autocomplete-overlay {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    overflow-y: auto;
    min-width: 300px;
    max-width: 500px;
    width: 400px;
    font-size: 0.9em;
    transform-origin: bottom center;
    scroll-behavior: smooth;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

/* Preset Autocomplete Size Classes */
.preset-autocomplete-overlay.size-small {
    max-height: min(200px, 30vh);
}

.preset-autocomplete-overlay.size-medium {
    max-height: min(300px, 40vh);
}

.preset-autocomplete-overlay.size-large {
    max-height: min(400px, 50vh);
}

.preset-autocomplete-list {
    padding: 0;
    display: flex;
    flex-direction: column;
}

.preset-autocomplete-item {
    padding: 6px 10px;
    cursor: pointer;
    border-bottom: 1px solid var(--border-secondary);
    transition: background-color var(--transition-fast);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85em;
}

.preset-autocomplete-item:hover {
    background: #3a3a3a;
}

.preset-autocomplete-item.selected {
    background: var(--primary-color);
    color: var(--text-primary);
}

.preset-autocomplete-item:last-child {
    border-bottom: none;
}

.preset-autocomplete-item .preset-name {
    font-weight: 600;
    color: #00bfff; /* Light blue for presets */
}

.preset-autocomplete-item .preset-details {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
}

.preset-autocomplete-item.selected .preset-name,
.preset-autocomplete-item.selected .preset-details {
    color: var(--text-primary);
}

/* Character Detail Overlay Styles */
.character-detail-overlay {
    position: absolute;
    background: #2a2a2a;
    border: 2px solid #ff4500;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
    z-index: 2001;
    min-width: 400px;
    max-width: 600px;
    max-height: 80vh;
    overflow: hidden;
    /* Ensure it stays within viewport */
    max-width: calc(100vw - 40px);
    max-height: calc(100vh - 40px);
}

/* Character detail content when inside autocomplete overlay */
.character-detail-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    max-height: 400px;
}

/* Ensure the character detail content takes full height of the autocomplete overlay */
.character-autocomplete-overlay .character-detail-content {
    height: 100%;
    max-height: 400px;
}

.character-detail-content {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.character-detail-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-sm);
    background: #ff450078;
    color: white;
    border-bottom: 1px solid #ff8e6a70;
    text-transform: uppercase;
    font-size: 0.8rem;
}

.character-name-copyright {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex: 1;
    gap: 20px;
}

.character-name {
    font-weight: 600;
}

.character-copyright {
    font-size: 0.75rem;
    opacity: 0.9;
    gap: 0.5em;
}

.close-character-detail {
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    width: 35px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s ease;
}

.close-character-detail:hover {
    background: rgba(255, 255, 255, 0.2);
}

.character-detail-body {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
    max-height: calc(80vh - 80px); /* Account for header height */
}

/* When inside autocomplete overlay, take full available height */
.character-autocomplete-overlay .character-detail-body {
    max-height: calc(400px - 60px); /* Account for header height */
    overflow-y: auto;
}
.character-autocomplete-item span.badge {
    background: #fb4400;
    color: white;
    border-radius: 0.4em;
    padding: 0.3em 0.5em;
    line-height: 1;
    opacity: 0.45;
    font-size: 0.75em;
    text-transform: none;
}

.character-prompt {
    padding-bottom: 12px;
}

.character-prompt strong {
    color: #ff4500;
    display: block;
    margin-bottom: 8px;
}

.character-prompt span {
    color: #ff885e;
    line-height: 1.5;
    font-style: italic;
}


.character-enhancers strong {
    color: #ff4500;
    display: block;
    margin-bottom: 12px;
}

.enhancers-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-height: 300px;
    overflow-y: auto;
    padding-right: 5px;
}

/* When inside autocomplete overlay, take full available height */
.character-autocomplete-overlay .enhancers-list {
    max-height: none;
    flex: 1;
    overflow-y: visible;
}

/* Custom scrollbar for enhancers list */
.enhancers-list::-webkit-scrollbar {
    width: 6px;
}

.enhancers-list::-webkit-scrollbar-track {
    background: #1a1a1a;
    border-radius: 3px;
}

.enhancers-list::-webkit-scrollbar-thumb {
    background: #ff4500;
    border-radius: 3px;
}

.enhancers-list::-webkit-scrollbar-thumb:hover {
    background: #ff6347;
}

.enhancer-group {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    border-radius: 6px;
    padding: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.enhancer-group:hover {
    border-color: #8c2500;
    background: rgba(104, 28, 0, 0.532);
}

.enhancer-group.selected {
    border-color: #b53100;
    background: rgb(125 34 0 / 42%);
}

.enhancer-group-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.enhancer-group[data-enhancer-group="null"] .enhancer-group-header {
    margin-bottom: 0px;
}
.enhancer-group[data-enhancer-group="null"] .enhancer-group-count {
    display: none;
}

.enhancer-group-name {
    font-weight: 600;
    color: #ffe4da;
    font-size: 0.9rem;
}

.enhancer-group-count {
    background: #444;
    color: #ccc;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 0.8rem;
}

.enhancer-items {
    display: flex;
    flex-wrap: wrap;
    gap: 2px;
}

.enhancer-item {
    background: #37150f;
    color: #ffa38c;
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 0.8rem;
    border: 1px solid #672c0e;
}

.enhancer-item.negative {
    background: #4a1a1a;
    color: #ff6b6b;
    border-color: #8b2a2a;
}

/* Mobile responsiveness for character overlays */
@media (max-width: 768px) {
    .character-autocomplete-overlay,
    .character-detail-overlay {
        min-width: 280px;
        max-width: 90vw;
    }
    
    .character-name-copyright {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }
    
    .character-detail-body {
        padding: 15px;
    }
    
    .enhancer-group {
        padding: 10px;
    }
    
    .enhancer-items {
        gap: 4px;
    }
    
    .enhancer-item {
        font-size: 0.75rem;
        padding: 3px 6px;
    }
}

/* Variation image container */
.variation-image-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0;
    max-height: inherit;
    border-bottom: 1px solid #8d8d8d;
    border-bottom-left-radius:  var(--border-radius-md);
    border-bottom-right-radius: var(--border-radius-md);
    background: #929292ab;
    box-shadow: 0px 0px 14px #00000054;
    position: relative;
    overflow: hidden;
    width: 100%;
    height: 100%;
}

.variation-image-container > .variation-image {
    max-width: -webkit-fill-available;
    max-height: -webkit-fill-available;
    object-fit: contain;
}

#maskPreviewCanvas {
    position: absolute;
    pointer-events: none;
    z-index: 1;
}

/* Request Type Toggle */
.request-type-toggle {
    display: flex;
    gap: 10px;
    align-items: center;
}

.request-type-toggle .toggle-btn {
    flex: 1;
    min-width: 120px;
    justify-content: center;
}

/* Lightbox Toggle Base Image Button (Top Left) */
.lightbox-toggle-btn {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 1001;
    background: linear-gradient(45deg, #17a2b8, #20c997);
    color: white;
    border: 2px solid #17a2b8;
    border-radius: 3px;
    padding: 10px 16px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    background: rgba(23, 162, 184, 0.9);
}

.lightbox-toggle-btn:hover {
    background: linear-gradient(45deg, #138496, #1ea085);
    box-shadow: 0 6px 20px rgba(23, 162, 184, 0.5);
}

.lightbox-toggle-btn[data-state="base"] {
    background: linear-gradient(45deg, #6f42c1, #e83e8c);
    border-color: #6f42c1;
    background: rgba(111, 66, 193, 0.9);
}

.lightbox-toggle-btn[data-state="base"]:hover {
    background: linear-gradient(45deg, #5a32a3, #d63384);
    box-shadow: 0 6px 20px rgba(111, 66, 193, 0.5);
}

.lightbox-toggle-btn i {
    margin-right: 6px;
}

/* Image Preview Modal Styles */
.image-preview-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.75);
    z-index: 1000;
    overflow: hidden;
    touch-action: none;
}

/* Close button overlay */
.image-preview-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: none!important;
    color: white;
    font-size: 1.5rem;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 1001;
    backdrop-filter: var(--glass-blur-2, none);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .image-preview-close-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
    }
}

.image-preview-container {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
    width: 100%;
    padding: 20px;
}

.image-preview-image-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: default;
    user-select: none;
    touch-action: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    /* Enhanced touch support */
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-manipulation: none;
    overscroll-behavior: none;
}

.image-preview-image-container.zoomed {
    cursor: grab;
}

.image-preview-image-container.zoomed:active {
    cursor: grabbing;
}

/* Touch gesture visual feedback */
.image-preview-image-container::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 60px;
    height: 60px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 1;
}

.image-preview-image-container.zoomed::before {
    opacity: 1;
}

/* Balance Display */
.balance-display {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-weight: 600;
    font-variation-settings: "wght" 600;
    font-size: 1.15em;
    cursor: default;
    filter: drop-shadow(0px 0px 3px black);
    font-family: 'Oxanium';
    line-height: 1;
}

.balance-display.low-credits {
    color: #fd7e14;
}

.balance-display .balanceAmount {
    margin-bottom: -0.15em;
}

.price-list {
    font-family: 'Oxanium';
    line-height: 1;
    margin-bottom: -0.15em;
}

/* Error Sub-Header */
.error-sub-header {
    position: fixed;
    top: 56px;
    right: 60px;
    z-index: 2;
    background: var(--danger-glass-color);
    backdrop-filter: var(--glass-blur-2, none);
    border: 1px solid var(--danger-glass-border);
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.2);
    transform: translateY(-100%);
    transition: transform 0.3s ease-in-out;
    width: min-content;
    border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
    border-top: none;
}

.error-sub-header.show {
    transform: translateY(0);
}

.error-sub-header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 24px;
    max-width: 100%;
}

.error-sub-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
    min-width: initial;
}

.error-sub-header-icon {
    font-size: 18px;
    color: #fff;
    flex-shrink: 0;
}

.error-sub-header-text {
    color: #fff;
    font-weight: 500;
    font-size: 14px;
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.error-sub-header-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.error-sub-header-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    border-radius: 6px;
    color: #fff;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 12px;
}

.error-sub-header-close:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.05);
}

.error-sub-header-close:active {
    transform: scale(0.95);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .error-sub-header {
        top: 50px;
    }
    
    .error-sub-header-content {
        padding: 10px 16px;
    }
    
    .error-sub-header-text {
        font-size: 13px;
    }
}

@media (max-width: 480px) {
    .error-sub-header-content {
        padding: 8px 12px;
    }
    
    .error-sub-header-text {
        font-size: 12px;
    }
    
    .error-sub-header-icon {
        font-size: 16px;
    }
    
    .error-sub-header-close {
        width: 24px;
        height: 24px;
        font-size: 11px;
    }
}

/* Legacy toggle button styles (for backward compatibility) */
.toggle-base-btn {
    background: linear-gradient(45deg, #17a2b8, #20c997);
    color: white;
    border: 2px solid #17a2b8;
}

.toggle-base-btn:hover {
    background: linear-gradient(45deg, #138496, #1ea085);
    box-shadow: 0 5px 15px rgba(23, 162, 184, 0.4);
}

.toggle-base-btn[data-state="base"] {
    background: linear-gradient(45deg, #6f42c1, #e83e8c);
    border-color: #6f42c1;
}

.toggle-base-btn[data-state="base"]:hover {
    background: linear-gradient(45deg, #5a32a3, #d63384);
    box-shadow: 0 5px 15px rgba(111, 66, 193, 0.4);
}
.header-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

/* Workspace Controls */
.workspace-controls,
.button-group {
    display: flex;
    align-items: center;
    gap: 0;
    box-shadow: var(--glass-shadow-2);
}
.workspace-controls .btn-secondary,
.button-group [class^="btn-"] {
    box-shadow: none;
}
.workspace-controls .btn-secondary:not(:first-child):not(:last-child),
.button-group [class^="btn-"]:not(:first-child):not(:last-child):not(:only-child) {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-left: none;
}
.workspace-controls .btn-secondary:first-child,
.button-group [class^="btn-"]:first-child:not(:last-child) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
.workspace-controls .btn-secondary:last-child,
.button-group [class^="btn-"]:last-child:not(:first-child) {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
}

.button-group > button:not(:has(span)),
.button-group > button:not(:has(span)):has(.mdi-1-5, .mdi-1-25, .mdi-1-35, .mdi-1-45) {
    padding: 0.25em 0.5em;
    min-width: 36px;
}
.workspace-option-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    gap: var(--spacing-sm);
}

#clearPresetBtn {
    border-right-color: var(--primary-glass-border);
    padding: 0.15em 0.5em;
    min-width: 8px;
    font-size: 18px;
}

#genEditorLabel {
    display: none;
}

#generationControls:has(#generatePresetBtn:not([disabled])) #genCreatorLabel {
    display: none;
}
#generationControls:has(#generatePresetBtn:not([disabled])) #genEditorLabel {
    display: inline-flex;
}


.workspace-name {
    font-weight: 500;
}

.workspace-counts {
    font-size: 0.8em;
    color: #8c8c8c;
    opacity: 0.8;
}
.workspace-controls > button,
.workspace-controls > #workspaceDropdown > button {
    padding: 0.5em 0.5em;
    min-width: 35px;
}

/* Bulk Actions Bar */
.bulk-actions-bar {
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-4);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-lg) var(--spacing-xl);
    margin: 0 var(--spacing-xxl) var(--spacing-xl) var(--spacing-xxl);
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: var(--glass-shadow-4);
    color: var(--text-primary);
    position: sticky;
    top: calc(1em + env(safe-area-inset-top, 0px));
    z-index: var(--z-layer-5);
}

.bulk-actions-info {
    font-weight: 600;
    font-size: 1.1rem;
}

.bulk-actions-info span {
    color: #ffd700;
    font-weight: 700;
}

.bulk-actions-buttons {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
}

/* Gallery Item Selection */
.gallery-item {
    position: relative;
}

/* Selection mode styles */
.gallery.selection-mode .gallery-item {
    cursor: pointer;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery.selection-mode .gallery-item:not(.selected):not(:hover) {
        opacity: 0.7;
        scale: 0.9;
    }
}

.gallery-item-checkbox {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 15;
    width: 22px;
    height: 22px;
    cursor: pointer;
    accent-color: #007bff;
    transform: scale(1.3);
    opacity: 0;
    transition: opacity 0.3s ease;
    background: var(--glass-layer-dark-5);
    border-color: var(--glass-border-5);
    border-radius: 50%;
    padding: 2px;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .gallery-item:hover .gallery-item-checkbox {
        opacity: 1;
    }
}

.gallery-item-checkbox:checked {
    opacity: 1;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 2px 8px rgba(0, 123, 255, 0.4);
}

.gallery-item.selected {
    border: 4px solid #ff9e75;
    box-shadow: 0 0 20px rgba(255, 128, 0, 0.5);
}

.gallery-item.selected .gallery-item-checkbox {
    opacity: 1;
    background: rgb(214, 79, 0);
    box-shadow: 0 2px 8px rgba(255, 123, 0, 0.4);
}

.gallery.selection-mode .gallery-item:hover {
    transform: scale(1.02);
}

/* Responsive adjustments for bulk actions */
@media (max-width: 768px) {
    .bulk-actions-bar {
        flex-wrap: wrap;
        gap: 12px;
        text-align: center;
    }
    
    .bulk-actions-buttons {
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .bulk-actions-buttons button {
        font-size: 0.9rem;
        padding: 8px 12px;
    }
}

/* Character Prompts Section */
.character-prompts-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.character-prompts-title {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.95rem;
    text-transform: uppercase;
}

.character-prompts-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

/* Button group styling for transformation section */
.character-prompts-controls .btn-group {
    display: flex;
    border-radius: var(--border-radius-md);
    overflow: hidden;
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    transition: all var(--transition-normal);
    z-index: var(--z-layer-3);
    gap: 0;
    box-sizing: border-box;
}

.character-prompts-controls .btn-group .btn-secondary {
    border-radius: 0;
    border: none;
    margin: 0;
    position: relative;
    background: transparent;
    color: #ffffff;
    font-weight: 600;
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all var(--transition-normal);
    min-width: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    box-sizing: border-box;
}

.character-prompts-controls .btn-group .btn-secondary:first-child {
    border-top-left-radius: var(--border-radius-md);
    border-bottom-left-radius: var(--border-radius-md);
}

.character-prompts-controls .btn-group .btn-secondary:last-child {
    border-top-right-radius: var(--border-radius-md);
    border-bottom-right-radius: var(--border-radius-md);
}

.character-prompts-controls .btn-group .btn-secondary:not(:last-child) {
    border-right: 1px solid var(--glass-border-3);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
.character-prompts-controls .btn-group .btn-secondary:hover:not(:disabled) {
    background: var(--glass-layer-4);
    color: #ffffff;
    z-index: var(--z-layer-4);
}
}

.character-prompts-controls .btn-group .btn-secondary[data-state="on"] {
    background: rgb(255 133 47 / 52%);
    color: var(--text-primary);
    border: none;
    box-shadow: inset 0 2px 4px rgb(62 24 0 / 58%), inset 0 0 8px rgb(83 38 0 / 19%), 0 0 0 1px rgb(0 0 0 / 32%);
    font-weight: 600;
    z-index: var(--z-layer-1);
    transform: none;
    position: relative;
}

.character-prompts-controls .btn-group .btn-secondary[data-state="on"]::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 69, 0, 0.15) 0%, transparent 50%, rgba(0, 0, 0, 0.15) 100%);
    border-radius: var(--border-radius-md);
    pointer-events: none;
    z-index: 1;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .character-prompts-controls .btn-group .btn-secondary[data-state="on"]:hover {
        background: rgb(255 154 83 / 52%);
        color: var(--text-primary);
        z-index: var(--z-layer-1);
    }
    .character-prompts-controls .btn-group .btn-secondary[data-state="off"]:hover {
        background: var(--glass-layer-4);
        border-color: var(--glass-border-4);
    }

    .character-prompts-controls .btn-group:hover {
        background: var(--glass-layer-4);
        border-color: var(--glass-border-4);
        box-shadow: var(--glass-shadow-4);
        z-index: var(--z-layer-4);
    }
}


.auto-position-toggle {
    display: flex;
    align-items: center;
}

.character-prompt-item {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    margin-bottom: var(--spacing-sm);
    position: relative;
    border-radius: var(--border-radius-md);
}

.character-prompt-item:last-child {
    margin-bottom: 0;
}

.character-prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.character-prompt-title {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.9rem;
    text-transform: uppercase;
}
.character-prompts-title-group {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: flex-start;
    gap: var(--spacing-xs);
}

.character-prompt-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.character-prompt-toggle {
    display: flex;
    align-items: center;
    position: relative;
    cursor: pointer;
}

.character-prompt-toggle input[type="checkbox"] {
    opacity: 0;
    position: absolute;
    cursor: pointer;
}

.character-prompt-toggle .checkmark {
    height: 16px;
    width: 16px;
    background: var(--bg-quaternary);
    border: 1px solid var(--border-secondary);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
}

.character-prompt-toggle input:checked ~ .checkmark {
    background: var(--primary-color);
    border-color: var(--primary-color);
}

.character-prompt-toggle .checkmark:after {
    content: "";
    position: absolute;
    display: none;
    left: 4px;
    top: 1px;
    width: 4px;
    height: 8px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
}

.character-prompt-toggle input:checked ~ .checkmark:after {
    display: block;
}

.character-prompt-delete {
    background: var(--danger-gradient);
    color: var(--text-primary);
    border: none;
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all var(--transition-fast);
    min-width: 60px;
    border-radius: var(--border-radius-sm);
    box-shadow: 0 2px 8px var(--shadow-danger);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .character-prompt-delete:hover {
        box-shadow: 0 5px 15px var(--shadow-danger);
    }
}

.character-prompt-fields {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.character-prompt-disabled {
    opacity: 0.6;
}

.character-prompt-disabled .character-prompt-fields {
    filter: grayscale(1);
}

/* Position Dialog Styles */
.position-dialog-content {
    max-width: min-content;
    height: min-content;
}

.position-dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 15px;
}

.position-dialog-header h3 {
    color: var(--primary-color);
    margin: 0;
    text-transform: uppercase;
}

.position-dialog-body {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xl);
}

.position-grid {
    display: flex;
    flex-direction: column;
    gap: 4px;
    align-items: center;
}

.position-row {
    display: flex;
    gap: 4px;
}

.position-cell {
    width: 60px;
    height: 60px;
    border: 2px solid var(--border-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-tertiary);
    color: var(--text-primary);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-normal);
    font-size: 0.9rem;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .position-cell:hover {
        border-color: var(--primary-color);
        background: var(--bg-quaternary);
    }
}

.position-cell.selected {
    border-color: var(--primary-color);
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 2px 8px var(--shadow-primary);
}

.position-dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-md);
}

/* Responsive adjustments for character prompts */
@media (max-width: 768px) {
    .character-prompt-fields {
        grid-template-columns: 1fr;
    }
    
    .character-prompts-controls {
        gap: 8px;
        align-items: flex-end;
    }
    
    .position-btn {
        min-width: 70px;
        font-size: 0.75rem;
    }
}

.hover-show.colored,
.percentage-input-container.hover-show.colored {
    color: var(--hover-show-colored-text);
    font-weight: bold;
    font-variation-settings: "wght" 700;
    font-family: var(--font-secondary);
    font-size: 1em;
    letter-spacing: 0.5px;
}
#manualPresetToggleBtn.hover-show #manualPresetToggleIcon {
    display: none;
}

.hover-show span#manualPresetToggleText {
    color: var(--hover-show-colored-text, var(--text-primary));
    font-weight: 500;
    opacity: 0.75;
    transition: all var(--transition-normal);
}


.hover-show:hover span#manualPresetToggleText {
    opacity: 1;
    color: var(--text-primary);
    transition: all var(--transition-normal);
}

/* Custom Resolution Dropdown Styles */
.custom-dropdown {
    position: relative;
    display: inline-block;
    font-family: inherit;
    width: inherit;
}
.custom-dropdown-btn {
    width: 100%;
    background: var(--glass-layer-2);
    color: #fff;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    padding: 0.6em 1.8em 0.6em 0.8em;
    font-size: 1rem;
    text-align: left;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all var(--transition-normal);
    min-height: 32px;
    box-shadow: var(--glass-shadow-2);
    position: relative;
    z-index: var(--z-layer-2);
}

.custom-dropdown-btn > span {
    display: flex;
    align-items: center;
    gap: 4px;
}

.custom-dropdown-btn:hover {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
}

.custom-dropdown-btn:focus,
.custom-dropdown-btn.active {
    background: rgba(255, 255, 255, 0.25);
    border: 1px solid rgba(255, 255, 255, 1);
    outline: none;
    z-index: var(--z-layer-4);
}
.custom-dropdown-menu {
    position: absolute;
    top: 110%;
    left: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: var(--glass-blur-4, none);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--border-radius-lg);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    z-index: var(--z-layer-6);
    line-height: 1.75;
    padding: 0.25em 0;
    max-height: 340px;
    overflow-y: auto;
    min-width: 165px;
    width: auto;
    transform: translateZ(0);
    will-change: backdrop-filter;
    overscroll-behavior: contain;
}

.dark .custom-dropdown-menu {
    color: var(--text-primary);
    background: var(--glass-layer-dark-2);
    border: 1px solid var(--glass-border-dark-2);
}

.dropright {
    right: 0;
    left: unset;
}

#manualResolutionGroup .custom-dropdown-menu,
#manualModelDropdown .custom-dropdown-menu {
    min-width: 225px;
}
.vibe-reference-info .custom-dropdown-menu {
    min-width: 75px;
    width: auto;
}

/* Custom scrollbar for dropdown menus */
.custom-dropdown-menu::-webkit-scrollbar {
    width: 8px;
}

.custom-dropdown-menu::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 4px;
}

.custom-dropdown-menu::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.8);
    border-radius: 4px;
}

.custom-dropdown-menu::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 1);
}
.custom-dropdown-group {
    padding: 0.2em 0.2em 0.2em 1em;
    font-size: 0.6em;
    color: #8c8c8c;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.85;
}
.custom-dropdown-option {
    padding: 0.25em 1em;
    background: none;
    color: #1a1a1a;
    font-size: 0.85em;
    cursor: pointer;
    border: none;
    width: 100%;
    text-align: left;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: background 0.15s, color 0.15s;
}
.custom-dropdown-option:hover,
.custom-dropdown-option:focus {
    background: var(--dropdown-hover-bg, var(--primary-glass-border));
    color: #fff;
}
.custom-dropdown-option.selected {
    background: var(--dropdown-selected-bg, var(--primary-glass-color));
    color: #fff;
    font-weight: bold;
}

/* Font preview tweaks inside custom dropdown */
.custom-dropdown-option span + span {
    margin-top: 2px;
}

/* Keyboard navigation highlighting */
.custom-dropdown-option.keyboard-selected {
    background: var(--dropdown-keyboard-selected-bg, var(--primary-glass-color)) !important;
    color: white !important;
    border-left: 3px solid var(--dropdown-keyboard-selected-border, var(--primary-glass-border)) !important;
}

/* Dataset dropdown specific styles */
.dataset-dropdown-option {
    padding: 0.2em 0.5em 0.2em 1em;
}

.dataset-option-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: 0.5em;
}

.dataset-option-left {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5em;
    flex: 1;
    cursor: pointer;
}

.dataset-name {
    font-weight: 500;
}

.dataset-check-icon {
    color: var(--primary-color);
    font-size: 0.9em;
}

.dataset-option-right {
    display: flex;
    align-items: center;
}

.dataset-bias-controls {
    display: flex;
    align-items: center;
    gap: 0.25em;
}

.dataset-bias-decrease,
.dataset-bias-increase {
    background: var(--glass-layer-5);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-sm);
    color: var(--text-primary);
    width: 1.5em;
    height: 1.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 0.8em;
    transition: all 0.15s ease;
}

.dataset-bias-decrease:hover,
.dataset-bias-increase:hover {
    background: var(--glass-layer-dark-4);
    border-color: var(--primary-color);
    color: var(--primary-color);
}

.dataset-bias-value {
    min-width: 3em;
    text-align: center;
    font-size: 0.85em;
    font-weight: 500;
    color: var(--text-primary);
    cursor: pointer;
    border-radius: var(--border-radius-md);
    transition: all 0.15s ease;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-2);
    user-select: none;
    position: relative;
}

.dataset-bias-value:hover {
    background: var(--glass-layer-dark-3);
    border-color: var(--primary-color);
    color: var(--primary-color);
}

.dataset-bias-value:active {
    background: var(--glass-layer-dark-4);
    transform: scale(0.95);
}

/* Add a subtle pulse animation when scrolling */
@keyframes biasValuePulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.dataset-bias-value.scrolling {
    animation: biasValuePulse 0.2s ease-in-out;
}

/* Ensure bias controls don't interfere with dropdown selection */
.dataset-bias-controls button {
    pointer-events: auto;
}

.dataset-bias-controls span {
    pointer-events: auto;
}

div#datasetDropdownMenu {
    min-width: 230px;
}

/* Sub Toggles Dropdown Styles */
div#subTogglesDropdownMenu {
    min-width: 200px;
    max-width: 350px;
}

.sub-toggle-dataset-group {
    border-bottom: 1px solid var(--glass-border-2);
}

.sub-toggle-dataset-group:last-child {
    border-bottom: none;
    padding-bottom: 0;
    margin-bottom: 0;
}

.sub-toggle-dataset-header {
    font-weight: 600;
    color: var(--badge-bg);
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: 0.6em;
    text-transform: uppercase;
}
/* Dataset tag search container */
.dataset-tag-search-container {
    display: flex;
    flex-direction: column;
}

.dataset-tag-search-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
    color: var(--primary-color);
    font-weight: 600;
}

.dataset-tag-search-input {
    background: var(--glass-layer-dark-3);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-sm);
    padding: var(--spacing-sm);
    color: var(--text-primary);
    font-size: 14px;
    width: 200px;
}

.dataset-tag-search-input:focus {
    outline: none;
    border-color: var(--primary-color);
}

.dataset-tag-search-results {
    max-height: 300px;
    overflow-y: auto;
}

.dataset-tag-search-hint {
    text-align: center;
    color: var(--text-secondary);
    font-style: italic;
    padding: var(--spacing-lg);
}

.dataset-tag-search-result {
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.dataset-tag-search-result:hover,
.dataset-tag-search-result.selected {
    background: var(--glass-layer-dark-3);
}

.dataset-tag-search-tag {
    font-weight: 600;
    color: var(--text-accent);
    line-height: 1.25;
}

.dataset-tag-search-path {
    font-size: 12px;
    color: var(--text-secondary);
}

/* Search dropdown positioning */
.dataset-tag-search-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    width: 300px;
    z-index: 1001;
    max-height: 300px;
    overflow-y: auto;
}

.dataset-tag-search-input-container {
    position: relative;
}

.custom-dropdown-badge {
    display: inline-flex;
    background: var(--custom-dropdown-badge-bg);
    color: var(--custom-dropdown-badge-text);
    border-radius: 3px;
    font-size: 0.7em;
    font-weight: 400;
    padding: 2px 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-family: 'Noto Sans', sans-serif;
    align-items: center;
    justify-content: center;
    white-space: pre;
}

.custom-dropdown-badge.free-badge {
    background: linear-gradient(45deg, #358b53, #00b152);
}
.custom-dropdown-badge.legacy-badge {
    background: linear-gradient(45deg, #323232, #000000);
}
.custom-dropdown-badge.legacy-furry-badge {
    background: linear-gradient(45deg, #46005a, #63004e);
}
.custom-dropdown-badge.curated-badge {
    background: linear-gradient(45deg, #0045bd, #004fd8);
}

.preset-menu .preset-model.curated-badge:has(:nth-child(2)) span:nth-child(2) {
    border-color: #3780ff;
    background: linear-gradient(45deg, #0045bd, #004fd8);
}


.preset-menu .preset-model.full-model-badge:has(:nth-child(2)) span:nth-child(2) {
    border-color: #ff8837;
    background: linear-gradient(45deg, #bd6300, #d85a00);
}

.custom-dropdown-badge .subscript {
    font-size: 6pt;
    align-self: end;
}

.scale-ratio-badge {
    background: #0a7961;
    color: white;
    box-shadow: 0 1px 3px rgb(19 214 173 / 38%);
    gap: 0.125em;
}

#manualResolutionGroup.expanded {    
    min-width: 250px;
}
#manualModal .custom-dropdown {
    flex: auto; ;
}
/* Dropup for custom dropdowns */
.custom-dropdown.dropup .custom-dropdown-menu {
    top: auto;
    bottom: 100%;
    margin-top: 0;
}
.custom-dropdown.dropright .custom-dropdown-menu {
    right: 0;
    left: auto;
}
#manualModal #manualModelDropdown {
    min-width: 85px;
}

/* Custom Preset Dropdown Styles */
.custom-dropdown-header {
    padding: 0.4em 1.2em 0.2em 1.2em;
    font-size: 0.8em;
    color: #8c8c8c;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.85;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    margin-bottom: 0.5em;
}

.custom-dropdown-header i {
    margin-right: 0.5em;
}

.preset-option-content {
    display: flex;
    flex-direction: column;
    gap: 0.3em;
    width: 100%;
}

.preset-option-content-two-rows {
    display: flex;
    flex-direction: column;
    gap: 0.75em;
    width: 100%;
}

.preset-option-row-1 {
    display: flex;
    align-items: center;
    width: 100%;
}

.preset-option-row-2 {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.5em;
    font-size: 1em;
    color: unset;
}

.preset-option-left {
    display: flex;
    gap: 0.25em;
    align-items: center;
}

.preset-name {
    font-weight: bold;
    color: #1a1a1a;
    font-size: 1em;
    overflow-x: clip;
    text-overflow: ellipsis;
}

/* Compact preset dropdown name */
.preset-menu .preset-name {
    font-size: 1em;
    font-weight: 300;
    font-variation-settings: "wght" 300;
    color: unset;
    width: 100%;
    line-height: 1;
}

/* Preset dropdown model and resolution */
.preset-menu .preset-model:not(:has(:nth-child(2))),
.preset-menu .preset-resolution {
    font-size: 0.75em;
    color: unset;
    opacity: 0.8;
    padding: 0.25em 0.5em;
    margin: 0;
    font-weight: 700;
    font-variation-settings: "wght" 700;
    line-height: 1;
}

.preset-menu .preset-model:has(:nth-child(2)) {
    font-size: 0.75em;
    color: unset;
    opacity: 0.8;
    padding: 0;
    margin: 0;
    font-weight: 700;
    font-variation-settings: "wght" 700;
    line-height: 1;
    gap: 0;
    border: none;
    background: none;
}

.preset-menu .preset-model:has(:nth-child(2)) span:nth-child(1) {
    padding-left: 0.5em;
    padding-right: 0.5em;
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    background-color: var(--glass-layer-3);
    border-radius: var(--border-radius-md);
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border: 1px solid var(--glass-border-3);
    color: var(--text-primary);
    margin: 0;
    border-right: none;
}

.preset-menu .preset-model:has(:nth-child(2)) span:nth-child(2) {
    padding-left: 0.5em;
    padding-right: 0.5em;
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    background-color: var(--primary-glass-color);
    border-radius: var(--border-radius-md);
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
    margin: 0;
}

.preset-menu .preset-resolution:has(:nth-child(2)) {
    font-size: 0.75em;
    color: unset;
    opacity: 0.8;
    padding: 0;
    margin: 0;
    font-weight: 700;
    font-variation-settings: "wght" 700;
    line-height: 1;
    gap: 0;
    border: none;
    background: none;
}

.preset-menu .preset-resolution:has(:nth-child(2)) > span:nth-child(1) {
    padding-left: 0.5em;
    padding-right: 0.5em;
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    background-color: var(--primary-glass-color);
    border-radius: var(--border-radius-md);
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
    margin: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.15rem;
}

.preset-menu .preset-resolution:has(:nth-child(2)) > span:nth-child(2) {
    padding-left: 0.5em;
    padding-right: 0.5em;
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    background-color: var(--glass-layer-3);
    border-radius: var(--border-radius-md);
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border: 1px solid var(--glass-border-3);
    color: var(--text-primary);
    margin: 0;
    border-left: none;
}

.text-replacement-name-container {
    display: flex;
    align-items: center;
    gap: 0.3em;
    flex: 1;
    min-width: 0;
}

.preset-details {
    display: flex;
    flex-direction: row;
    gap: var(--spacing-sm);
    font-size: 0.85em;
    align-items: center;
    justify-content: space-between;
}

.preset-details .indicators-row {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}

.preset-details .icons-row {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: var(--spacing-sm);
}

.preset-icons {
    display: flex;
    gap: 0.3em;
    align-items: center;
}

.preset-icons i {
    font-size: 0.8em;
    color: #ff6347;
    opacity: 0.8;
}

/* Compact preset dropdown icons */
.preset-menu .preset-icons {
    display: flex;
    gap: 0.2em;
    align-items: center;
    flex-shrink: 0;
}

.preset-menu .preset-icons i {
    font-size: 1em;
    color: var(--border-primary);
}

.preset-menu .preset-icons .uc-boxes {
    gap: 2px;
    flex-direction: row-reverse;
    margin-left: 0.25rem;
}

.preset-menu .preset-icons .uc-box {
    width: 10px;
    height: 10px;
}
.preset-menu .preset-icons .uc-boxes[data-uc-level="1"] .uc-box[data-level="1"],
.preset-menu .preset-icons .uc-boxes[data-uc-level="2"] .uc-box[data-level="1"],
.preset-menu .preset-icons .uc-boxes[data-uc-level="2"] .uc-box[data-level="2"],
.preset-menu .preset-icons .uc-boxes[data-uc-level="3"] .uc-box[data-level="1"],
.preset-menu .preset-icons .uc-boxes[data-uc-level="3"] .uc-box[data-level="2"],
.preset-menu .preset-icons .uc-boxes[data-uc-level="3"] .uc-box[data-level="3"] {
    background: var(--border-primary);
}

/* Compact preset dropdown option styling */
.preset-menu .custom-dropdown-option {
    padding: 0.5em 0.6em;
    transition: background-color 0.2s ease;
}

.preset-menu .custom-dropdown-option:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.preset-menu .custom-dropdown-option.selected {
    background-color: rgba(255, 255, 255, 0.2);
}

.resolution-content {
    display: flex;
    align-items: center;
    gap: 4px;
}

.steps-content {
    display: flex;
    align-items: center;
    gap: 4px;
}

.preset-dataset-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ff6347;
    opacity: 0.8;
}
.layer-type {
    color: #8c8c8c;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 0.7em;
    letter-spacing: 0.5px;
}

.layer-value {
    color: #666;
    font-style: italic;
}

.preset-menu .custom-dropdown-menu {
    min-width: 300px;
}

.dark .custom-dropdown-menu {
    background: var(--glass-layer-dark-menu);
}

.dark .custom-dropdown-option {
    color: var(--text-primary);
}

/* Update preset dropdown option hover and selected states to match custom dropdown */
.preset-menu .custom-dropdown-option:hover,
.preset-menu .custom-dropdown-option:focus {
    background: rgb(4 4 4 / 50%);
    color: #fff;
}

.preset-menu .custom-dropdown-option:hover .preset-name,
.preset-menu .custom-dropdown-option:focus .preset-name {
    color: #fff;
}

.preset-menu .custom-dropdown-option.selected {
    background: var(--dropdown-selected-bg, var(--primary-glass-color));
    color: #fff;
    font-weight: bold;
}

.preset-menu .custom-dropdown-option.selected .preset-name,
.preset-menu .custom-dropdown-option.selected .preset-resolution,
.preset-menu .custom-dropdown-option.selected .layer-value {
    color: #ccc;
}

/* Prompt Tabs Styling */
.prompt-tabs {
    border: none;
    border-radius: 0 0 6px 6px;
    overflow: visible;
    padding-top: var(--spacing-lg);
}

.tab-header {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    padding: 0;
    margin-bottom: 10px;
}

.tab-buttons {
    display: flex;
    flex: 0 1 auto;
    gap: 8px;
}

/* Main Tab Buttons - Gallery Toggle Group Design */
#manualModal .gallery-toggle-group {
    grid-template-columns: 1fr 1fr;
}

#manualModal .gallery-toggle-group .gallery-toggle-btn {
    position: relative;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 0px var(--spacing-md);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-sm);
    min-height: 32px;
    transition: all var(--transition-normal);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    #manualModal .gallery-toggle-group .gallery-toggle-btn:hover {
        color: var(--text-primary);
    }
}

#manualModal .gallery-toggle-group .gallery-toggle-btn.active {
    color: var(--text-primary);
}

.gallery-toggle-group .gallery-toggle-btn i {
    transition: transform var(--transition-normal);
}

.gallery-toggle-group .gallery-toggle-btn .tab-text {
    transition: transform var(--transition-normal);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 120px;
}

#manualModal .gallery-toggle-group .gallery-toggle-slider {
    width: calc(50% - 2px);
}


#manualModal .character-prompt-tabs .gallery-toggle-group {
    position: relative;
    display: grid;
    grid-template-columns: 1fr 1fr;
}

#manualModal .character-prompt-tabs .gallery-toggle-group .gallery-toggle-slider {
    width: calc(50% - 2px);
}

#manualModal .character-prompt-tabs .gallery-toggle-group[data-active="uc"] .gallery-toggle-slider {
    transform: translateX(100%);
}

#manualModal .prompt-tabs .gallery-toggle-group[data-active="prompt"] .gallery-toggle-slider {
    background:rgba(174, 255, 171, 0.3);
    border-color: rgb(211 255 203 / 30%);
}

#manualModal .prompt-tabs .gallery-toggle-group[data-active="prompt"] .gallery-toggle-btn.active {
    color: rgb(229, 255, 228);
}

#manualModal .prompt-tabs .gallery-toggle-group[data-active="uc"] .gallery-toggle-slider {
    transform: translateX(calc(100% + 1px));
    background:rgb(255 25 25 / 30%);
    border-color: rgb(250 82 82 / 30%);
}

#manualModal .prompt-tabs .gallery-toggle-group[data-active="uc"] .gallery-toggle-btn.active {
    color: rgb(255 228 228);
}

#manualModal .prompt-tabs .gallery-toggle-group[data-active="settings"] .gallery-toggle-slider {
    transform: translateX(calc(200% + 2px));
    background:rgb(0 121 255 / 30%);
    border-color: rgb(83 120 255 / 30%);
}

#manualModal .prompt-tabs .gallery-toggle-group[data-active="settings"] .gallery-toggle-btn.active {
    color: rgb(209, 233, 255);
}

.extra-buttons {
    display: flex;
    flex: 0 1 auto;
    gap: 4px;
    margin-left: auto;
}


.tab-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    z-index: var(--z-layer-3);
}

.show-both-btn {
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--bg-quaternary);
    color: var(--text-secondary);
    font-size: 14px;
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid var(--border-secondary);
    min-width: 50px;
    border-radius: var(--border-radius-md);
}

.show-both-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border-color: var(--border-tertiary);
}

.show-both-btn.active {
    background: var(--primary-gradient);
    color: var(--text-primary);
    box-shadow: 0 2px 8px var(--shadow-primary);
    border-color: var(--primary-color);
}

.show-both-btn.active:hover {
    box-shadow: 0 5px 15px var(--shadow-primary);
}

.tab-content {
    position: relative;
}

.tab-pane {
    display: none;
}

.tab-pane.active {
    display: block;
}

.tab-pane textarea {
    width: 100%;
    min-height: 120px;
    resize: none;
    outline: none;
}

.tab-pane textarea::placeholder {
    color: #484848;
}

/* Ensure prompt textarea maintains its styling */
.tab-pane #manualPrompt {
    min-height: 80px;
    font-family: var(--font-mono);
    font-size: 1em;
}

.tab-pane #manualUc {
    min-height: 80px;
    font-family: var(--font-mono);
    font-size: 1em;
}

/* Show both panes layout */
.prompt-tabs.show-both .tab-content {
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-items: stretch;
}
.character-prompt-textarea-container {
    position: relative;
}

.prompt-tabs.show-both .tab-pane {
    display: block;
    flex: 1;
}

/* Character Prompt Tabs Styling */
.character-prompt-tabs {
    border: none;
    border-radius: 0px;
    overflow: hidden;
    gap: 10px;
    padding: var(--spacing-sm);
    display: flex;
    flex-direction: column;
}

.character-prompt-tabs .tab-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0;
    margin-bottom: 0px;
}

.character-prompt-tabs .tab-buttons {
    display: flex;
    flex: 0 1 auto;
}

.character-prompt-tabs .tab-header .toggle-btn[data-state="on"] {
    transform: none;
}

.character-prompt-controls {
    display: flex;
    align-items: center;
    gap: 5px;
}

/* Additional icon-only toggle button sizing */
.toggle-btn.icon-only {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}


.btn-secondary:disabled,
.pswp__button--custom:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    pointer-events: none;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .btn-secondary:disabled:hover,
    .pswp__button--custom:disabled:hover {
        transform: none;
        background: var(--bg-secondary);
        border-color: var(--border-color);
    }
}

.character-name-editable {
    display: flex;
    align-items: center;
}

.character-name-text {
    font-size: 14px;
    font-weight: 500;
    color: #fff;
}

.character-name-input.hover-show {
    font-size: 0.9em;
    font-weight: 100;
    color: #c7c7c7;
}

.character-name-input.hover-show:hover {
    font-size: 1em;
}

.character-prompt-item.collapsed .character-name-input,
.character-prompt-item:not(.collapsed) .character-name-input-placeholder {
    display: none;
}

.character-prompt-item .character-name-input-placeholder {
    color: #ffffffcf;
}

div#manualResolutionDropdownMenu {
    width: 210px;
}

.character-prompt-tabs .tab-pane textarea::placeholder {
    color: #888;
}

.prompt-tabs.show-both .tab-pane textarea {
    min-height: 100px;
}

.inset-badge {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    height: -webkit-fill-available;
    font-size: 1em;
    font-variation-settings: "wght" var(--wght-semibold);
    padding: 2px 0.8em;
    background: var(--glass-inset-bg-3);
    margin-left: 0;
    border-radius: var(--border-radius-md);
    transition: all 0.3s ease;
    color: var(--text-secondary);
    border: 1px solid var(--glass-border-1);
    box-shadow: inset 2px 2px 6px rgb(0 0 0 / 40%);
}

#manualBalanceDisplay {
    border-left: 2px dotted;
    padding-left: var(--spacing-sm);
}

.inset-badge.price-display {
    background: #ff980026;
    color: #ffde7b;
    border-color: #ffeaad3d;
}

.inset-badge.price-display.free {
    background: #93e19517;
    color: #98ff8a4f;
    border-color: #82948294;
}
.price-label {
    font-weight: 500;
}

/* NovelAI SVG Icons - Using CSS Masks for Color Inheritance */
.nai-variations { 
    -webkit-mask: url('/dist/nai-svg/variations.d35c8a3a.svg') no-repeat center;
    mask: url('/dist/nai-svg/variations.d35c8a3a.svg') no-repeat center;
}
.nai-vibe-transfer { 
    -webkit-mask: url('/dist/nai-svg/vibe_transfer.d54b4b78.svg') no-repeat center;
    mask: url('/dist/nai-svg/vibe_transfer.d54b4b78.svg') no-repeat center;
}
.nai-wand-sparkles { 
    -webkit-mask: url('/dist/nai-svg/wand_sparkles.8c4d1c4e.svg') no-repeat center;
    mask: url('/dist/nai-svg/wand_sparkles.8c4d1c4e.svg') no-repeat center;
}
.nai-text { 
    -webkit-mask: url('/dist/nai-svg/text.995ae72b.svg') no-repeat center;
    mask: url('/dist/nai-svg/text.995ae72b.svg') no-repeat center;
}
.nai-thin-cross { 
    -webkit-mask: url('/dist/nai-svg/thin_cross.6cfb084f.svg') no-repeat center;
    mask: url('/dist/nai-svg/thin_cross.6cfb084f.svg') no-repeat center;
}
.nai-trash { 
    -webkit-mask: url('/dist/nai-svg/trash.72ef2ba9.svg') no-repeat center;
    mask: url('/dist/nai-svg/trash.72ef2ba9.svg') no-repeat center;
}
.nai-upscale { 
    -webkit-mask: url('/dist/nai-svg/upscale.21e62f81.svg') no-repeat center;
    mask: url('/dist/nai-svg/upscale.21e62f81.svg') no-repeat center;
}
.nai-small-cross { 
    -webkit-mask: url('/dist/nai-svg/small_cross.8d803d20.svg') no-repeat center;
    mask: url('/dist/nai-svg/small_cross.8d803d20.svg') no-repeat center;
}
.nai-sparkles { 
    -webkit-mask: url('/dist/nai-svg/sparkles.b1e1a420.svg') no-repeat center;
    mask: url('/dist/nai-svg/sparkles.b1e1a420.svg') no-repeat center;
}
.nai-pin { 
    -webkit-mask: url('/dist/nai-svg/pin.8a391c7b.svg') no-repeat center;
    mask: url('/dist/nai-svg/pin.8a391c7b.svg') no-repeat center;
}
.nai-plus { 
    -webkit-mask: url('/dist/nai-svg/plus.dc778eb7.svg') no-repeat center;
    mask: url('/dist/nai-svg/plus.dc778eb7.svg') no-repeat center;
}
.nai-quick-start-gallery { 
    -webkit-mask: url('/dist/nai-svg/quick_start_gallery.602a1b35.svg') no-repeat center;
    mask: url('/dist/nai-svg/quick_start_gallery.602a1b35.svg') no-repeat center;
}
.nai-sakura { 
    -webkit-mask: url('/dist/nai-svg/sakura.685bbe60.svg') no-repeat center;
    mask: url('/dist/nai-svg/sakura.685bbe60.svg') no-repeat center;
}
.nai-paw {
    -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg>');
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg>');
}
.nai-save { 
    -webkit-mask: url('/dist/nai-svg/save.36b86afc.svg') no-repeat center;
    mask: url('/dist/nai-svg/save.36b86afc.svg') no-repeat center;
}
.nai-seed { 
    -webkit-mask: url('/dist/nai-svg/seed.8a1df676.svg') no-repeat center;
    mask: url('/dist/nai-svg/seed.8a1df676.svg') no-repeat center;
}
.nai-settings { 
    -webkit-mask: url('/dist/nai-svg/settings.37ac2cdf.svg') no-repeat center;
    mask: url('/dist/nai-svg/settings.37ac2cdf.svg') no-repeat center;
}
.nai-shelficon { 
    -webkit-mask: url('/dist/nai-svg/shelficon.51f6a18f.svg') no-repeat center;
    mask: url('/dist/nai-svg/shelficon.51f6a18f.svg') no-repeat center;
}
.nai-small-arrow { 
    -webkit-mask: url('/dist/nai-svg/small_arrow.1099f431.svg') no-repeat center;
    mask: url('/dist/nai-svg/small_arrow.1099f431.svg') no-repeat center;
}
.nai-person { 
    -webkit-mask: url('/dist/nai-svg/person.8fffa0a6.svg') no-repeat center;
    mask: url('/dist/nai-svg/person.8fffa0a6.svg') no-repeat center;
}
.nai-opus { 
    -webkit-mask: url('/dist/nai-svg/opus.e28dcb4d.svg') no-repeat center;
    mask: url('/dist/nai-svg/opus.e28dcb4d.svg') no-repeat center;
}
.nai-pen-tip-light { 
    -webkit-mask: url('/dist/nai-svg/pen-tip-light.47883c90.svg') no-repeat center;
    mask: url('/dist/nai-svg/pen-tip-light.47883c90.svg') no-repeat center;
}
.nai-pen { 
    -webkit-mask: url('/dist/nai-svg/pen.87137c5d.svg') no-repeat center;
    mask: url('/dist/nai-svg/pen.87137c5d.svg') no-repeat center;
}
.nai-penwriting { 
    -webkit-mask: url('/dist/nai-svg/penwriting.3c214126.svg') no-repeat center;
    mask: url('/dist/nai-svg/penwriting.3c214126.svg') no-repeat center;
}
.nai-help { 
    -webkit-mask: url('/dist/nai-svg/help.98e947de.svg') no-repeat center;
    mask: url('/dist/nai-svg/help.98e947de.svg') no-repeat center;
}
.nai-history { 
    -webkit-mask: url('/dist/nai-svg/history.b9b000e8.svg') no-repeat center;
    mask: url('/dist/nai-svg/history.b9b000e8.svg') no-repeat center;
}
.nai-image-count { 
    -webkit-mask: url('/dist/nai-svg/image_count.de68b045.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_count.de68b045.svg') no-repeat center;
}
.nai-image-placeholder-even { 
    -webkit-mask: url('/dist/nai-svg/image_placeholder_even.e513ece2.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_placeholder_even.e513ece2.svg') no-repeat center;
}
.nai-image-placeholder-odd { 
    -webkit-mask: url('/dist/nai-svg/image_placeholder_odd.953f280d.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_placeholder_odd.953f280d.svg') no-repeat center;
}
.nai-import { 
    -webkit-mask: url('/dist/nai-svg/import.a2828e2c.svg') no-repeat center;
    mask: url('/dist/nai-svg/import.a2828e2c.svg') no-repeat center;
}
.nai-inpaint { 
    -webkit-mask: url('/dist/nai-svg/inpaint.aaefedb9.svg') no-repeat center;
    mask: url('/dist/nai-svg/inpaint.aaefedb9.svg') no-repeat center;
}
.nai-lang-en { 
    -webkit-mask: url('/dist/nai-svg/lang_en.c6828b78.svg') no-repeat center;
    mask: url('/dist/nai-svg/lang_en.c6828b78.svg') no-repeat center;
}
.nai-logout { 
    -webkit-mask: url('/dist/nai-svg/logout.0b906fff.svg') no-repeat center;
    mask: url('/dist/nai-svg/logout.0b906fff.svg') no-repeat center;
}
.nai-magglass { 
    -webkit-mask: url('/dist/nai-svg/magglass.28078752.svg') no-repeat center;
    mask: url('/dist/nai-svg/magglass.28078752.svg') no-repeat center;
}
.nai-discord { 
    -webkit-mask: url('/dist/nai-svg/discord.9998396f.svg') no-repeat center;
    mask: url('/dist/nai-svg/discord.9998396f.svg') no-repeat center;
}
.nai-dotdotdot { 
    -webkit-mask: url('/dist/nai-svg/dotdotdot.97bb8a73.svg') no-repeat center;
    mask: url('/dist/nai-svg/dotdotdot.97bb8a73.svg') no-repeat center;
}
.nai-easel { 
    -webkit-mask: url('/dist/nai-svg/easel.a9aec978.svg') no-repeat center;
    mask: url('/dist/nai-svg/easel.a9aec978.svg') no-repeat center;
}
.nai-export { 
    -webkit-mask: url('/dist/nai-svg/export.235cebdc.svg') no-repeat center;
    mask: url('/dist/nai-svg/export.235cebdc.svg') no-repeat center;
}
.nai-funnel-empty { 
    -webkit-mask: url('/dist/nai-svg/funnelEmpty.8b01f76a.svg') no-repeat center;
    mask: url('/dist/nai-svg/funnelEmpty.8b01f76a.svg') no-repeat center;
}
.nai-hamburger-alt { 
    -webkit-mask: url('/dist/nai-svg/hamburger_alt.ec19c7ae.svg') no-repeat center;
    mask: url('/dist/nai-svg/hamburger_alt.ec19c7ae.svg') no-repeat center;
}
.nai-heart-disabled { 
    -webkit-mask: url('/dist/nai-svg/heart_disabled.208bfe74.svg') no-repeat center;
    mask: url('/dist/nai-svg/heart_disabled.208bfe74.svg') no-repeat center;
}
.nai-heart-enabled { 
    -webkit-mask: url('/dist/nai-svg/heart_enabled.3dfca10c.svg') no-repeat center;
    mask: url('/dist/nai-svg/heart_enabled.3dfca10c.svg') no-repeat center;
}
.nai-clipboard { 
    -webkit-mask: url('/dist/nai-svg/clipboard.579cb9e6.svg') no-repeat center;
    mask: url('/dist/nai-svg/clipboard.579cb9e6.svg') no-repeat center;
}
.nai-detatch-up { 
    -webkit-mask: url('/dist/nai-svg/detatch_up.5a8391cb.svg') no-repeat center;
    mask: url('/dist/nai-svg/detatch_up.5a8391cb.svg') no-repeat center;
}
.nai-dice { 
    -webkit-mask: url('/dist/nai-svg/dice.d52243c6.svg') no-repeat center;
    mask: url('/dist/nai-svg/dice.d52243c6.svg') no-repeat center;
}
.nai-directional-arrow-down { 
    -webkit-mask: url('/dist/nai-svg/directional_arrow_down.3046336d.svg') no-repeat center;
    mask: url('/dist/nai-svg/directional_arrow_down.3046336d.svg') no-repeat center;
}
.nai-directional-arrow-left { 
    -webkit-mask: url('/dist/nai-svg/directional_arrow_left.d2437171.svg') no-repeat center;
    mask: url('/dist/nai-svg/directional_arrow_left.d2437171.svg') no-repeat center;
}
.nai-directional-arrow-right { 
    -webkit-mask: url('/dist/nai-svg/directional_arrow_right.7d4cdcfe.svg') no-repeat center;
    mask: url('/dist/nai-svg/directional_arrow_right.7d4cdcfe.svg') no-repeat center;
}
.nai-directional-arrow-up { 
    -webkit-mask: url('/dist/nai-svg/directional_arrow_up.22936b44.svg') no-repeat center;
    mask: url('/dist/nai-svg/directional_arrow_up.22936b44.svg') no-repeat center;
}
.nai-anla { 
    -webkit-mask: url('/dist/nai-svg/anla.23c99491.svg') no-repeat center;
    mask: url('/dist/nai-svg/anla.23c99491.svg') no-repeat center;
}
.nai-book-open { 
    -webkit-mask: url('/dist/nai-svg/book-open.e6d9fcb0.svg') no-repeat center;
    mask: url('/dist/nai-svg/book-open.e6d9fcb0.svg') no-repeat center;
}
.nai-check { 
    -webkit-mask: url('/dist/nai-svg/check.c906eb0a.svg') no-repeat center;
    mask: url('/dist/nai-svg/check.c906eb0a.svg') no-repeat center;
}
.nai-aa { 
    -webkit-mask: url('/dist/nai-svg/Aa.1034ae44.svg') no-repeat center;
    mask: url('/dist/nai-svg/Aa.1034ae44.svg') no-repeat center;
}
.nai-circles-centered { 
    -webkit-mask: url('/dist/nai-svg/circles_centered.1238f30d.svg') no-repeat center;
    mask: url('/dist/nai-svg/circles_centered.1238f30d.svg') no-repeat center;
}
.nai-cross { 
    -webkit-mask: url('/dist/nai-svg/cross.fac5a02a.svg') no-repeat center;
    mask: url('/dist/nai-svg/cross.fac5a02a.svg') no-repeat center;
}
.nai-dropper { 
    -webkit-mask: url('/dist/nai-svg/dropper.78b85b64.svg') no-repeat center;
    mask: url('/dist/nai-svg/dropper.78b85b64.svg') no-repeat center;
}
.nai-empty-sparkles { 
    -webkit-mask: url('/dist/nai-svg/empty_sparkles.4c1b822d.svg') no-repeat center;
    mask: url('/dist/nai-svg/empty_sparkles.4c1b822d.svg') no-repeat center;
}
.nai-eraser { 
    -webkit-mask: url('/dist/nai-svg/eraser.0ec62cc8.svg') no-repeat center;
    mask: url('/dist/nai-svg/eraser.0ec62cc8.svg') no-repeat center;
}
.nai-fold { 
    -webkit-mask: url('/dist/nai-svg/fold.faaf6d0f.svg') no-repeat center;
    mask: url('/dist/nai-svg/fold.faaf6d0f.svg') no-repeat center;
}
.nai-image-tool-colorize { 
    -webkit-mask: url('/dist/nai-svg/image_tool_colorize.6baf2425.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_tool_colorize.6baf2425.svg') no-repeat center;
}
.nai-image-tool-declutter { 
    -webkit-mask: url('/dist/nai-svg/image_tool_declutter.7848744c.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_tool_declutter.7848744c.svg') no-repeat center;
}
.nai-image-tool-emotion { 
    -webkit-mask: url('/dist/nai-svg/image_tool_emotion.bca3218f.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_tool_emotion.bca3218f.svg') no-repeat center;
}
.nai-image-tool-line-art { 
    -webkit-mask: url('/dist/nai-svg/image_tool_line_art.99b08a4e.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_tool_line_art.99b08a4e.svg') no-repeat center;
}
.nai-image-tool-remove-bg { 
    -webkit-mask: url('/dist/nai-svg/image_tool_remove_bg.be09ccf1.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_tool_remove_bg.be09ccf1.svg') no-repeat center;
}
.nai-image-tool-sketch { 
    -webkit-mask: url('/dist/nai-svg/image_tool_sketch.8bd2cc8b.svg') no-repeat center;
    mask: url('/dist/nai-svg/image_tool_sketch.8bd2cc8b.svg') no-repeat center;
}
.nai-img2img { 
    -webkit-mask: url('/dist/nai-svg/img2img.aa3e7184.svg') no-repeat center;
    mask: url('/dist/nai-svg/img2img.aa3e7184.svg') no-repeat center;
}
.nai-minus { 
    -webkit-mask: url('/dist/nai-svg/minus.3db8267d.svg') no-repeat center;
    mask: url('/dist/nai-svg/minus.3db8267d.svg') no-repeat center;
}
.nai-redo { 
    -webkit-mask: url('/dist/nai-svg/redo.c8b50748.svg') no-repeat center;
    mask: url('/dist/nai-svg/redo.c8b50748.svg') no-repeat center;
}
.nai-resize { 
    -webkit-mask: url('/dist/nai-svg/resize.9b598e1b.svg') no-repeat center;
    mask: url('/dist/nai-svg/resize.9b598e1b.svg') no-repeat center;
}
.nai-select { 
    -webkit-mask: url('/dist/nai-svg/select.429034b7.svg') no-repeat center;
    mask: url('/dist/nai-svg/select.429034b7.svg') no-repeat center;
}
.nai-undo { 
    -webkit-mask: url('/dist/nai-svg/undo.d181fecf.svg') no-repeat center;
    mask: url('/dist/nai-svg/undo.d181fecf.svg') no-repeat center;
}
.nai-unfold { 
    -webkit-mask: url('/dist/nai-svg/unfold.df1e363f.svg') no-repeat center;
    mask: url('/dist/nai-svg/unfold.df1e363f.svg') no-repeat center;
}
.nai-reload { 
    -webkit-mask: url('/dist/nai-svg/reload.bd9372a2.svg') no-repeat center;
    mask: url('/dist/nai-svg/reload.bd9372a2.svg') no-repeat center;
}

/* Make all nai-* icons display as inline-block with proper sizing and color inheritance */
[class^="nai-"] {
    display: inline-block;
    width: 1em;
    min-width: 1em;
    height: 1em;
    min-height: 1em;
    vertical-align: middle;
    background: currentColor;
    -webkit-mask-size: contain;
    mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
    color: inherit;
}

button#layer1SeedToggle {
    padding-left: 0px;
    padding-right: 0px;
}

/* Mask Bias Dropdown Styles */
.mask-bias-option-content {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
}

.mask-bias-grid {
    display: grid;
    gap: 0;
    width: 20px;
    height: 20px;
    border: 1px solid rgb(255 133 47 / 60%);
    border-radius: 4px;
    background: rgb(0 0 0 / 23%);
    flex-shrink: 0;
}

/* Portrait: 3 columns, 5 rows */
.mask-bias-grid[data-orientation="portrait"] {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(5, 1fr);
}

/* Landscape: 5 columns, 3 rows */
.mask-bias-grid[data-orientation="landscape"] {
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(3, 1fr);
}


/* Portrait: 3 columns, 5 rows */
.mask-bias-grid[data-bias="custom"][data-orientation="portrait"],
.mask-bias-grid[data-bias="custom"][data-orientation="landscape"] {
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
}

.mask-bias-grid .grid-cell {
    background: var(--glass-layer-2);
    border-radius: 1px;
    transition: all var(--transition-normal);
}

/* Portrait Layout (3 columns, 5 rows) - highlight rows for each bias */
.mask-bias-grid[data-orientation="portrait"][data-bias="0"] .grid-cell:nth-child(-n+3) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="1"] .grid-cell:nth-child(n+4):nth-child(-n+6) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="2"] .grid-cell:nth-child(n+7):nth-child(-n+9) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="3"] .grid-cell:nth-child(n+10):nth-child(-n+12) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="portrait"][data-bias="4"] .grid-cell:nth-child(n+13):nth-child(-n+15) {
    background: rgb(228 94 0 / 80%);
}

/* Landscape Layout (5 columns, 3 rows) */
/* Bias 0: Left - first column */
.mask-bias-grid[data-orientation="landscape"][data-bias="0"] .grid-cell:nth-child(1),
.mask-bias-grid[data-orientation="landscape"][data-bias="0"] .grid-cell:nth-child(6),
.mask-bias-grid[data-orientation="landscape"][data-bias="0"] .grid-cell:nth-child(11) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 1: Left-Mid - second column */
.mask-bias-grid[data-orientation="landscape"][data-bias="1"] .grid-cell:nth-child(2),
.mask-bias-grid[data-orientation="landscape"][data-bias="1"] .grid-cell:nth-child(7),
.mask-bias-grid[data-orientation="landscape"][data-bias="1"] .grid-cell:nth-child(12) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 2: Center - third column */
.mask-bias-grid[data-orientation="landscape"][data-bias="2"] .grid-cell:nth-child(3),
.mask-bias-grid[data-orientation="landscape"][data-bias="2"] .grid-cell:nth-child(8),
.mask-bias-grid[data-orientation="landscape"][data-bias="2"] .grid-cell:nth-child(13) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 3: Right-Mid - fourth column */
.mask-bias-grid[data-orientation="landscape"][data-bias="3"] .grid-cell:nth-child(4),
.mask-bias-grid[data-orientation="landscape"][data-bias="3"] .grid-cell:nth-child(9),
.mask-bias-grid[data-orientation="landscape"][data-bias="3"] .grid-cell:nth-child(14) {
    background: rgb(228 94 0 / 80%);
}

/* Bias 4: Right - fifth column */
.mask-bias-grid[data-orientation="landscape"][data-bias="4"] .grid-cell:nth-child(5),
.mask-bias-grid[data-orientation="landscape"][data-bias="4"] .grid-cell:nth-child(10),
.mask-bias-grid[data-orientation="landscape"][data-bias="4"] .grid-cell:nth-child(15) {
    background: rgb(228 94 0 / 80%);
}
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(1),
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(6),
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(11),
.mask-bias-grid[data-orientation="landscape"][data-bias="custom"] .grid-cell:nth-child(16) {
    background: rgb(228 94 0 / 80%);
}

.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(4),
.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(7),
.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(10),
.mask-bias-grid[data-orientation="portrait"][data-bias="custom"] .grid-cell:nth-child(13) {
    background: rgb(228 94 0 / 80%);
}


.mask-bias-label {
    flex-grow: 1;
}

.mask-bias-button-content {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
}

.mask-bias-button-content .mask-bias-grid {
    width: 20px;
    height: 20px;
}

.custom-dropdown-option.selected .mask-bias-grid {
    border-color: rgb(255 133 47 / 60%);
    background: var(--glass-layer-2);
}

/* Mask Editor Styles */
.mask-editor-content {
    max-width: 1200px;
    max-height: 90vh;
    width: 90vw;
    background: var(--glass-windows-bg, var(--glass-layer-4));
    backdrop-filter: var(--glass-blur-4, none);
    border: 1px solid var(--glass-border-4);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-4);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.mask-editor-body {
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: var(--spacing-lg);
}

.mask-editor-tools {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    flex-wrap: wrap;
    padding: var(--spacing-md);
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
}

.brush-size-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-right: auto;
}

.brush-size-control label {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin: 0;
}

.brush-size-control input[type="range"] {
    width: 100px;
    margin: 0;
}

.brush-size-control span {
    font-size: 0.9rem;
    color: var(--text-primary);
    font-weight: 600;
    min-width: 30px;
    text-align: center;
}

.mask-editor-canvas-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 400px;
    position: relative;
    background: #0000005c;
}

.mask-editor-canvas-inner {
    border-radius: var(--border-radius-lg);
    position: relative;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-height: 60vh;
    aspect-ratio: var(--background-aspect-ratio, auto);
    /* Container will contain both canvases regardless of their size */
    contain: layout;
}

.mask-editor-canvas-inner::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-image: var(--background-image, none);
    background-size: var(--background-size, contain);
    background-repeat: no-repeat;
    background-position: center;
    opacity: 1;
    pointer-events: none;
    z-index: 1;
    width: var(--background-width, 100%);
    height: var(--background-height, 100%);
    aspect-ratio: var(--background-aspect-ratio, auto);
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

#maskCanvas,
#maskBrushPreviewCanvas {
    cursor: none;
    background: transparent;
    width: 100%;
    height: 100%;
    max-width: 90%;
    max-height: 90%;
    position: relative;
    z-index: 2;
    opacity: 0.75;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    object-fit: contain;
}


#maskBrushPreviewCanvas {
    position: absolute;
    pointer-events: none;
    z-index: 3;
}

#maskCanvas {
    opacity: 0.95;
}

.mask-editor-actions {
    display: flex;
    gap: var(--spacing-md);
    justify-content: flex-end;
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--glass-border-2);
}

/* Responsive adjustments for mask editor */
@media (max-width: 768px) {
    .mask-editor-content {
        width: 95vw;
        max-height: 95vh;
    }
    
    .brush-size-control {
        margin-left: 0;
        justify-content: center;
    }
    
    .mask-editor-canvas-container {
        min-height: 300px;
    }
}

/* No Images Styles */
.no-images {
    grid-column: 1 / -1;
    text-align: center;
    padding: 50px;
    color: #c5c5c5;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    flex-direction: column;
    gap: var(--spacing-xxl);
}

.no-images i {
    font-size: 4rem;
}

/* Upscale Button Styles */
.upscale-btn {
    font-size: 0.9rem;
    padding: 8px 16px;
}

/* Glass style slider row Styles */
.slider-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Glass style slider Styles */
.modal-content .glass-slider:focus,
.modal-content .glass-slider:active,
.glass-slider {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 0px;
  background: transparent;
  border-radius: var(--border-radius-md);
  box-shadow: none;
  outline: none;
  border: none;
  position: relative;
  min-height: 20px;
  padding: 0;
}
.glass-slider::-webkit-slider-runnable-track {
  height: 0px;
  background: transparent;
  border-radius: var(--border-radius-md);
  box-shadow: none;
}
.glass-slider::-ms-fill-lower,
.glass-slider::-ms-fill-upper {
  background: transparent;
  border-radius: var(--border-radius-md);
  box-shadow: none;
}
.glass-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 22px;
  height: 20px;
  background: var(--glass-layer-3);
  border: 1.5px solid var(--glass-border-3);
  border-radius: var(--border-radius-md);
  box-shadow: var(--glass-shadow-3);
  margin-top: -10px;
  cursor: pointer;
  transition: none;
}
.glass-slider::-ms-thumb {
  width: 22px;
  height: 20px;
  background: var(--glass-layer-3);
  border: 1.5px solid var(--glass-border-3);
  border-radius: var(--border-radius-md);
  box-shadow: var(--glass-shadow-3);
  cursor: pointer;
  margin-top: -10px;
  transition: none;
}
/* Remove default outline for Firefox */
.glass-slider::-moz-focus-outer {
  border: 0;
}

/* Value input for slider */
.slider-value-input {
  text-align: left;
  font-size: 1em;
  font-family: var(--font-secondary);
  color: #ffcfbd;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--border-radius-md);
  transition: all var(--transition-normal);
  box-shadow: none;
  min-width: 48px;
  padding: 0.35em 0.6em;
}
.slider-value-input:hover, .slider-value-input:focus {
  background: var(--glass-layer-3);
  border: 1px solid var(--glass-border-3);
  box-shadow: var(--glass-shadow-3);
  outline: none;
}

/* Character Prompt Collapse/Expand Styles */
.character-prompt-item {
    position: relative;
    transition: all var(--transition-normal);
}

.character-prompt-item.collapsed .gallery-toggle-group,
.character-prompt-item.collapsed .tab-content {
    display: none !important;
}

.character-prompt-item.collapsed .character-prompt-controls {
    display: flex !important;
}

.character-prompt-collapse-toggle {
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    color: var(--text-primary);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.8rem;
    font-weight: 600;
    z-index: var(--z-layer-3);
    box-shadow: var(--glass-shadow-3);
}

.character-prompt-collapse-toggle:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    color: var(--text-primary);
    z-index: var(--z-layer-4);
}

.character-prompt-collapse-toggle i {
    transition: transform var(--transition-normal);
}

.character-prompt-item.collapsed .character-prompt-collapse-toggle i {
    transform: rotate(180deg);
}

.character-prompt-preview {
    display: none;
    margin: 0px;
    min-height: 32px;
    padding: 0em 0.6em;
    background: var(--glass-layer-2);
    color: var(--text-primary);
    border: 1px solid var(--glass-border-3);
    box-shadow: inset 0 2px 4px rgb(62 24 0 / 58%), inset 0 0 8px rgb(83 38 0 / 19%), 0 0 0 1px rgb(0 0 0 / 32%);
    border-radius: var(--border-radius-md);
    box-shadow: var(--glass-shadow-2);
    cursor: pointer;
    transition: all var(--transition-normal);
    flex: 1 0 auto;
}

.character-prompt-item.collapsed .character-prompt-preview {
    display: inline-flex;
}


.character-prompt-preview:hover:not(:disabled) {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-4);
    z-index: var(--z-layer-4);
    box-shadow: 0 8px 20px rgb(255 255 255 / 12%);
    transition: all var(--transition-normal);
}

.character-prompt-preview input:focus,
.character-prompt-preview input {
    width: 100%;
    resize: none;
    background: transparent;
    border: none;
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 0.9em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: pointer;
    outline: none;
    padding: 0;
}

.character-prompt-preview input::placeholder {
    color: var(--text-muted);
    font-style: italic;
}

/* Ensure the character name is always visible in collapsed state */
.character-prompt-item.collapsed .character-name-editable {
    display: flex !important;
}

/* Hide tab buttons in collapsed state */
.character-prompt-item.collapsed .tab-buttons {
    display: none !important;
}

/* Show character name in collapsed state */
.character-prompt-item.collapsed .tab-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
}

/* Adjust spacing for collapsed state */
.character-prompt-item.collapsed .tab-header {
    margin-bottom: 0;
}

/* Animation for smooth collapse/expand */
.character-prompt-tabs {
    transition: all var(--transition-normal);
}

.character-prompt-item.collapsed .character-prompt-tabs {
    min-height: auto;
}

/* Manual Modal Loading Overlay Styles */
.manual-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-layer-10);
    border-radius: var(--border-radius-xl);
    backdrop-filter: var(--glass-blur-2, brightness(0.75)) saturate(0.15);
    opacity: 1;
    transition: all var(--transition-normal);
    will-change: backdrop-filter, opacity;
    transform: translateZ(0);
    pointer-events: auto;
}

html.disable-blur .manual-loading-overlay {
    background: var(--glass-layer-5);
}

.manual-loading-overlay.return {
    backdrop-filter: var(--glass-blur-0) saturate(1.0);
    opacity: 0;
    transition: all var(--transition-fast);
    will-change: backdrop-filter, opacity;
    transform: translateZ(0);
    pointer-events: none;
}

/* Manual Preview Navigation Loading Overlay Styles */
.manual-preview-navigation-loading {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: var(--z-layer-10);
    border-radius: var(--border-radius-xl);
    opacity: 1;
    transition: all var(--transition-normal);
    will-change: opacity;
    transform: translateZ(0);
    pointer-events: auto;
}

.manual-preview-navigation-loading-content {
    text-align: center;
    padding: 20px;
    width: 90%;
    font-size: 4.5em;
    color: var(--active-tab-bg);
}

.manual-loading-content {
    text-align: center;
    color: var(--text-primary);
    background: var(--glass-layer-dark-3);
    padding: 30px;
    border-radius: var(--border-radius-lg);
    border: 1px solid var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
}

.manual-loading-content p {
    margin: 15px 0 0 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-muted);
}

.manual-loading-content .spinner {
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

.left-controls {
    display: flex;
    gap: var(--spacing-md);
}

.page-background {
    height: 100vh;
    width: 100vw;
    position: fixed;
    top: 0;
    left: 0;
    transform: translateZ(0);
    backface-visibility: hidden;
    transition: opacity 3s ease-in-out, background-color 3s ease-in-out;
    z-index: -2;
    will-change: opacity, background-color, background-image;
}


.header-left, .header-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: 0;;
}

.footer-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    flex: auto;
}

/* Cache Browser Modal */
.cache-browser-content {
    width: 90%;
    max-width: 1200px;
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.cache-browser-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    background: var(--glass-layer-alt-3, var(--glass-layer-2));
    border-bottom: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
    flex-shrink: 0;
}

.cache-browser-header h3 {
    color: var(--text-primary);
    margin: 0;
    font-size: 1.2em;
}

.cache-browser-header-right {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-sm);
}

.cache-browser-body {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.cache-gallery {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xxl);
    padding: var(--spacing-lg);
    overflow-y: auto;
    overflow-x: hidden;
}

.workspace-reference-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: var(--spacing-md);
    flex: 1;
    align-content: start;
    min-height: 0;
}

.workspace-reference-header {
    font-size: 24pt;
    text-transform: uppercase;
    font-weight: 100;
    font-variation-settings: "wght" 100;
    margin-bottom: var(--spacing-sm);
}

.modal-body .cache-gallery {
    max-height: 55vh;
}

/* Custom scrollbar for cache gallery */
.cache-gallery::-webkit-scrollbar {
    width: 8px;
}

.cache-gallery::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.cache-gallery::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.cache-gallery::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

/* Stretch items when there are few items */
.cache-gallery.few-items {
    align-content: stretch;
}

.cache-gallery.few-items .cache-gallery-item {
    height: auto;
}

.cache-gallery-item {
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: all var(--transition-normal);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    background: var(--glass-layer-2);
    box-shadow: var(--glass-shadow-2);
    z-index: var(--z-layer-2);
}

.cache-gallery-item:hover {
    border-color: var(--glass-border-4);
    box-shadow: var(--glass-shadow-4);
    background: var(--glass-layer-4);
    z-index: var(--z-layer-4);
}

.cache-gallery-item img {
    width: 100%;
    height: 100%;
    aspect-ratio: 1/1;
    object-fit: cover;
    object-position: center top;
    display: block;
}

.cache-gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.8));
    color: var(--text-primary);
    padding: 12px;
    opacity: 0;
    transition: opacity var(--transition-normal);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.cache-gallery-item:hover .cache-gallery-item-overlay {
    opacity: 1;
}

.cache-gallery-item-info {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin-top: auto;
}

.cache-delete-btn {
    background: rgba(220, 53, 69, 0.9);
    color: white;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s ease;
    flex-shrink: 0;
    position: absolute;
    top: 8px;
    right: 8px;
}

.cache-delete-btn:hover {
    background: rgba(220, 53, 69, 1);
}

.cache-delete-btn i {
    font-size: 14px;
}
/* Cache Browser Badges */
.cache-badges {
    position: absolute;
    top: 8px;
    left: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    z-index: 2;
    flex-wrap: wrap;
    max-height: calc(100% - 12px);
}

.vibe-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.cache-browser-tabs .tab-buttons {
    display: flex;
    gap: var(--spacing-sm);
}

.cache-browser-tabs .tab-btn {
    background: var(--glass-layer-3);
    color: #ffffff;
    border: 1px solid var(--glass-border-3);
    box-shadow: var(--glass-shadow-3);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 0.9rem;
}

.cache-browser-tabs .tab-btn:hover {
    background: var(--glass-layer-2);
    color: var(--text-primary);
}

.cache-browser-tabs .tab-btn.active {
    background: var(--primary-color);
    color: white;
    border-bottom: 2px solid var(--accent-color);
}

.cache-browser-tabs .tab-btn i {
    font-size: 1rem;
}

.cache-browser-body .tab-pane {
    display: none;
    overflow-y: auto;
}

.cache-browser-body .tab-pane.active {
    display: block;
}

.transforms-container { 
    min-height: 210px;
    height: 210px;
    gap: var(--spacing-sm);
}

/* Vibe References Header */
.vibe-references-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-md);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--border-secondary);
}

.vibe-references-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
}

.vibe-references-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

/* Vibe References Container */
.vibe-references-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: ". .";
    width: 100%;
    gap: var(--spacing-sm);
    height: 100%;
}

.vibe-reference-item {
    display: flex;
    flex-direction: column;
    position: relative;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    overflow: hidden;
    transition: all var(--transition-normal);
}

.vibe-reference-preview-container {
    display: flex;
    position: relative;
    width: 100%;
    flex: 1;
    align-items: flex-start;
    justify-content: center;
    max-height: -webkit-fill-available;
}

.vibe-reference-preview {
    max-width: -webkit-fill-available;
    max-height: -webkit-fill-available;
    object-fit: cover;
    display: block;
    position: absolute;
}

.overlay-icon-container {
    position: absolute;
    left: 0;
    bottom: 0;
    margin: var(--spacing-sm);
    display: flex;
    gap: 0.6em;
    opacity: 0.9;
    color: var(--text-secondary);
    padding: var(--spacing-sm);
    background: var(--primary-color);
    border-radius: var(--spacing-xs);
    z-index: 2;
}

.vibe-reference-controls {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    gap: 4px;
    justify-content: space-between;
    width: calc(100% - calc(2 * 8px));
}
.vibe-reference-controls-bottom {
    position: absolute;
    bottom: 8px;
    right: 8px;
    display: flex;
    gap: 4px;
}

.vibe-reference-delete-btn {
    background: rgba(220, 53, 69, 0.9);
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s ease;
    font-size: 12px;
}

.vibe-reference-delete-btn:hover {
    background: rgba(220, 53, 69, 1);
}

.vibe-reference-info {
    padding: var(--spacing-sm);
    display: flex;
    flex-direction: row;
    gap: var(--spacing-xs);
    justify-content: space-between;
}

.vibe-reference-ie-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    flex: 1;
}

.vibe-reference-ratio-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.vibe-reference-ratio-input {
    flex: 1;
    font-size: 0.8rem;
    padding: 2px 6px;
    text-align: center;
}

/* Remove spinner buttons from number inputs */
input.vibe-reference-ratio-input::-webkit-outer-spin-button,
input.vibe-reference-ratio-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

input.vibe-reference-ratio-input[type=number] {
    appearance: textfield;
    -webkit-appearance: textfield;
}

/* Disabled vibe reference items */
.cache-gallery-item.disabled {
    opacity: 0.5;
    filter: grayscale(0.5);
    pointer-events: none;
}

.cache-gallery-item.disabled .cache-gallery-item-overlay {
    background: rgba(0, 0, 0, 0.3);
}

.cache-gallery-item.disabled .cache-delete-btn {
    opacity: 0.3;
    cursor: not-allowed;
}

/* Cache Browser Container (Desktop Only) */
.cache-browser-container {
    background: var(--glass-layer-alt-5, var(--glass-layer-3));
    backdrop-filter: var(--glass-blur-3, none);
    border-bottom: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg);
    display: none;
    flex-direction: column;
    z-index: var(--z-layer-5);
    height: 100%;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.cache-gallery-item-buttons {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: var(--spacing-sm);
}

.cache-gallery-item-action-buttons {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-sm);
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.cache-gallery-item:hover .cache-gallery-item-action-buttons {
    opacity: 1;
}

.cache-gallery-item:hover .cache-badges {
    opacity: 0;
    transition: opacity 0.2s ease;
}

/* Cache Manager Gallery Item Action Buttons */
.cache-manager-gallery-item {
    position: relative;
}

.cache-manager-gallery-item .cache-gallery-item-action-buttons {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.cache-manager-gallery-item:hover .cache-gallery-item-action-buttons {
    opacity: 1;
}

.cache-manager-gallery-item:hover .cache-manager-badges {
    opacity: 0;
    transition: opacity 0.2s ease;
}

.cache-gallery-item-action-buttons button {
    font-size: 1.5em;
}

.modal-actions {
    margin-top: var(--spacing-xxl);
}

/* Panel management using data-active-panel attribute */
.manual-modal-preview-section[data-active-panel="cache-browser"] .manual-preview-container {
    display: none !important;
}

.manual-modal-preview-section[data-active-panel="cache-browser"] .cache-browser-container {
    display: flex !important;
}

/* Default state - show manual preview, hide cache browser */
.manual-modal-preview-section:not([data-active-panel]) .cache-browser-container {
    display: none !important;
}

.cache-browser-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xxl);
    min-height: 250px;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 2;
    width: 100%;
    height: 100%;
    background: #7c7c7cf5;
    border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
    gap: var(--spacing-lg);
}

img.loading {
    height: 128px;
    width: 128px;
}

.cache-browser-loading .spinner {
    margin-bottom: var(--spacing-lg);
}

.cache-browser-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Image Bias Adjustment Modal Styles */
.image-bias-adjustment-content {
    max-width: 1200px;
    width: 90vw;
    height: 80vh;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: var(--glass-blur-4, none);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.image-bias-adjustment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.image-bias-adjustment-header h3 {
    margin: 0;
    color: #fff;
    font-size: 1.5rem;
    font-weight: 600;
}

.image-bias-adjustment-body {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    gap: 24px;
}

.bias-controls-section {
    flex: none;
    display: flex;
    flex-direction: row;
    gap: 20px;
    align-items: center;
}
.bias-controls-section.main-controls {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
    flex-wrap: wrap;
    padding: var(--spacing-md);
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
}

.bias-controls-grid {
    display: flex;
    flex-direction: row;
    gap: 16px;
    align-items: end;
    justify-content: space-between;
    flex: 1
}

.bias-control-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.bias-control-group label {
    color: #ccc;
    font-size: 0.9rem;
    font-weight: 500;
}

.bias-test-section {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.bias-test-results {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 16px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.test-result-item {
    display: flex;
    align-items: center;
    gap: 12px;
}

.test-label {
    color: #ccc;
    font-size: 0.85rem;
    font-weight: 500;
    min-width: 80px;
}

.test-result-item img {
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.image-preview-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 0;
}



.client-preview-image {
    position: absolute;
    top: 2em;
    left: 2em;
    width: calc(100% - 4em);
    height: calc(100% - 4em);
    object-fit: contain;
    pointer-events: none;
}

.image-preview-container {
    flex: 1;
    position: relative;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    min-height: 400px;
    padding: 2em;
}

.target-area-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 10;
}

.target-area-border {
    border: 2px dotted rgba(255, 255, 255, 0.6);
    border-radius: 4px;
}

.bias-adjustment-image {
    object-fit: cover;
    cursor: grab;
    transition: transform 0.1s ease;
    user-select: none;
    -webkit-user-drag: none;
    -webkit-user-select: none;
    -webkit-user-modify: none;
    -webkit-user-select: none;
    position: absolute;
    top: 0;
    left: 0;
    transform-origin: top left;
}

.bias-adjustment-image-wrapper {
    position: absolute;
    top: 2em;
    left: 2em;
    transform-origin: top left;
}

.bias-adjustment-image:active {
    cursor: grabbing;
}

.image-info {
    display: flex;
    gap: 24px;
    padding: 16px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.info-label {
    color: #ccc;
    font-size: 0.8rem;
    font-weight: 500;
}

.info-item span:last-child {
    color: #fff;
    font-size: 0.9rem;
    font-weight: 600;
}

.image-bias-adjustment-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    padding: 20px 0 0 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

/* Responsive Design */
@media (max-width: 768px) {
    .image-bias-adjustment-content {
        width: 95vw;
        max-height: 95vh;
    }
    
    .image-bias-adjustment-body {
        gap: 16px;
    }
    
    .bias-controls-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }
    
    .bias-control-group:last-child {
        grid-column: 1 / -1;
    }
}

@media (max-width: 480px) {
    .bias-controls-grid {
        grid-template-columns: 1fr;
    }
    
    .image-preview-container {
        min-height: 250px;
    }
}

/* Bias Adjustment Confirmation Dialog */
.bias-confirm-content {
    max-width: 800px;
    width: 90%;
    height: min-content;
    max-height: 90vh;
    overflow-y: auto;
    background: var(--glass-layer-3);
    backdrop-filter: var(--glass-blur-3, none);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-3);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.bias-confirm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    border-bottom: 1px solid var(--border-secondary);
}

.bias-confirm-header h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--text-primary);
}

.bias-confirm-body {
    padding: var(--spacing-lg);
}

.bias-confirm-body p {
    margin-bottom: var(--spacing-lg);
    color: var(--text-secondary);
    font-size: 1rem;
}

.bias-confirm-previews {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
}

.preview-section {
    text-align: center;
}

.preview-section h4 {
    margin-bottom: var(--spacing-md);
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 500;
}

.preview-image-container {
    background: var(--bg-secondary);
    border: 1px solid var(--border-secondary);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-md);
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.preview-image-container img {
    max-width: 100%;
    max-height: 180px;
    object-fit: contain;
    border-radius: var(--border-radius-md);
}

.bias-confirm-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-md);
    padding: var(--spacing-lg);
    border-top: 1px solid var(--border-secondary);
}

@media (max-width: 768px) {
    .bias-confirm-content {
        width: 95%;
        max-height: 95vh;
    }
    
    .bias-confirm-previews {
        grid-template-columns: 1fr;
        gap: var(--spacing-md);
    }
}

/* Mask Adjustment Modal Styles */
.mask-adjustment-content {
    max-width: 500px;
    width: 90%;
}

.mask-adjustment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    border-bottom: 1px solid var(--glass-border-2);
}

.mask-adjustment-header h3 {
    margin: 0;
    color: var(--text-primary);
}

.mask-adjustment-body {
    padding: var(--spacing-lg);
}

.mask-adjustment-body p {
    margin-bottom: var(--spacing-md);
    color: var(--text-secondary);
    line-height: 1.4;
}

.mask-adjustment-options {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    margin-top: var(--spacing-lg);
}

.mask-adjustment-options button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md) var(--spacing-lg);
    border: none;
    border-radius: var(--border-radius-md);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.mask-adjustment-options button i {
    font-size: 16px;
}

.mask-adjustment-options .btn-primary {
    background: var(--primary-color);
    color: white;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .mask-adjustment-options .btn-primary:hover:not(:disabled) {
        background: var(--primary-hover);
    }

    .mask-adjustment-options .btn-secondary:hover:not(:disabled) {
        background: var(--glass-bg-3);
        border-color: var(--glass-border-3);
    }
}

/* Responsive adjustments for mask adjustment modal */
@media (max-width: 768px) {
    .mask-adjustment-content {
        width: 95%;
        margin: 10px;
    }
    
    .mask-adjustment-options {
        gap: var(--spacing-sm);
    }
    
    .mask-adjustment-options button {
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: 13px;
    }
}

/* Modal Alert Theme - Red theme for alerts */
.modal.alert-theme {
    background: rgb(0 0 0 / 87%); /* Darker backdrop */
}

.modal.alert-theme .modal-content {
    background: linear-gradient(135deg, rgb(49 1 6 / 95%), rgb(95 0 9 / 90%));
    backdrop-filter: none;
    border: 1px solid rgb(96 0 8);
    box-shadow: 0 8px 32px rgba(220, 53, 69, 0.25), 0 0 0 1px rgba(220, 53, 69, 0.18);
    animation: modalAlertSlideIn 0.3s ease-out;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal.alert-theme .modal-content h2,
.modal.alert-theme .modal-content h3 {
    color: #ffffff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.modal.alert-theme .modal-content p {
    color: rgba(255, 255, 255, 0.9);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.alert-theme .modal-content .btn-primary:hover:not(:disabled) {
        background: linear-gradient(135deg, #c82333, #bd2130);
        border: 1px solid #c82333;
        box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
    }
}

.modal.alert-theme .modal-content .btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #ffffff;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.alert-theme .modal-content .btn-secondary:hover:not(:disabled) {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.4);
    }
}

.modal.alert-theme .modal-content .btn-danger {
    background: linear-gradient(135deg, #dc3545, #c82333);
    border: 1px solid #dc3545;
    color: #ffffff;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.alert-theme .modal-content .btn-danger:hover:not(:disabled) {
        background: linear-gradient(135deg, #c82333, #bd2130);
        border: 1px solid #c82333;
        box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
    }
}

.modal.alert-theme .modal-content .close-dialog {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.alert-theme .modal-content .close-dialog:hover {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }
}

/* Alert animation */
@keyframes modalAlertSlideIn {
    0% {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* Modal Warning Theme - Orange theme for warnings */
.modal.warning-theme {
    background: rgba(0, 0, 0, 0.8); /* Slightly darker backdrop */
}

.modal.warning-theme .modal-content {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.95), rgba(255, 165, 0, 0.95));
    backdrop-filter: var(--glass-blur-5, none);
    border: 2px solid rgba(255, 193, 7, 0.8);
    box-shadow: 0 8px 32px rgba(255, 193, 7, 0.4), 0 0 0 1px rgba(255, 193, 7, 0.2);
    animation: modalWarningSlideIn 0.3s ease-out;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal.warning-theme .modal-content h2,
.modal.warning-theme .modal-content h3 {
    color: #000000;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
}

.modal.warning-theme .modal-content p {
    color: rgba(0, 0, 0, 0.8);
}

.modal.warning-theme .modal-content .btn-primary {
    background: linear-gradient(135deg, #ffc107, #e0a800);
    border: 1px solid #ffc107;
    color: #000000;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.warning-theme .modal-content .btn-primary:hover:not(:disabled) {
        background: linear-gradient(135deg, #e0a800, #d39e00);
        border: 1px solid #e0a800;
        box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
    }
}

.modal.warning-theme .modal-content .btn-secondary {
    background: rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.3);
    color: #000000;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.warning-theme .modal-content .btn-secondary:hover:not(:disabled) {
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(0, 0, 0, 0.4);
    }
}

.modal.warning-theme .modal-content .close-dialog {
    color: #000000;
    background: rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.2);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.warning-theme .modal-content .close-dialog:hover {
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(0, 0, 0, 0.3);
    }
}

/* Warning animation */
@keyframes modalWarningSlideIn {
    0% {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* Modal Success Theme - Green theme for success */
.modal.success-theme {
    background: rgba(0, 0, 0, 0.75); /* Standard backdrop */
}

.modal.success-theme .modal-content {
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.95), rgba(28, 200, 138, 0.95));
    backdrop-filter: var(--glass-blur-5, none);
    border: 2px solid rgba(40, 167, 69, 0.8);
    box-shadow: 0 8px 32px rgba(40, 167, 69, 0.4), 0 0 0 1px rgba(40, 167, 69, 0.2);
    animation: modalSuccessSlideIn 0.3s ease-out;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.modal.success-theme .modal-content h2,
.modal.success-theme .modal-content h3 {
    color: #ffffff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.modal.success-theme .modal-content p {
    color: rgba(255, 255, 255, 0.9);
}

.modal.success-theme .modal-content .btn-primary {
    background: linear-gradient(135deg, #28a745, #20c997);
    border: 1px solid #28a745;
    color: #ffffff;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.success-theme .modal-content .btn-primary:hover:not(:disabled) {
        background: linear-gradient(135deg, #20c997, #1ea085);
        border: 1px solid #20c997;
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
    }
}

.modal.success-theme .modal-content .btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #ffffff;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.success-theme .modal-content .btn-secondary:hover:not(:disabled) {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.4);
    }
}

.modal.success-theme .modal-content .close-dialog {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal.success-theme .modal-content .close-dialog:hover {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }
}

/* Success animation */
@keyframes modalSuccessSlideIn {
    0% {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.mini-toolbar {
    position: absolute;
    bottom: 6px;
    left: 6px;
    right: 6px;
    display: flex;
    flex-direction: row;
    gap: 6px;
    justify-content: center;
    align-items: center;
    background: rgba(0,0,0,0.7);
    border-radius: 8px;
    padding: 4px 6px;
    z-index: 10;
    opacity: 0.95;
}
.mini-toolbar .btn-small {
    min-width: 28px;
    min-height: 28px;
    font-size: 14px;
    padding: 2px 12px;
    border-radius: 6px;
    background: var(--glass-layer-4);
    color: #fff;
    border: 1px solid var(--glass-border-4);
    box-shadow: var(--glass-shadow-2);
    display: flex;
    align-items: center;
    justify-content: center;
}
@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .mini-toolbar .btn-small:hover {
        background: var(--glass-layer-5);
        color: #fff;
        border-color: var(--glass-border-5);
    }
}

body:not(.editor-open):not(.initializing) .gallery-container {
    scale: 1.0;
    opacity: 1.0;
    transition: opacity var(--transition-normal), scale var(--transition-normal);
}

body.initializing .gallery-container,
body.editor-open .gallery-container {
    scale: 0.85;
    opacity: 0;
    transition: opacity 4.9s, scale var(--transition-normal);
}

.gallery-placeholder {
    background: rgba(255,255,255,0.04);
    border: 1px dashed #444;
    border-radius: 18px;
    min-height: 150px;
    min-width: initial;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.3;
    pointer-events: none;
    user-select: none;
    /* Responsive adjustments */
    max-height: 400px;
    transition: all var(--transition-normal);
    visibility: hidden;
}

/* Responsive gallery placeholder adjustments */
@media (max-width: 768px) {
    .gallery-placeholder {
        min-height: 120px;
        max-height: 300px;
    }
}

.mini-toolbar-active .gallery-item-info-container,
.mini-toolbar-active .gallery-actions {
    display: none;
}

/* Workspace Color Indicators */
.workspace-color-indicator {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.3);
    flex-shrink: 0;
}

.workspace-option-content {
    display: flex;
    align-items: center;
    flex: 1;
}

.workspace-name {
    font-weight: 500;
    margin-right: auto;
}

.workspace-counts {
    font-size: 0.85rem;
    margin-left: auto;
}
div#workspaceDropdownMenu {
    min-width: 300px;
}

.workspace-manage-list {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    gap: var(--spacing-sm);
}

/* Workspace Management Styles */
.workspace-manage-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px;
    gap: var(--spacing-md);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    background: var(--glass-layer-2);
    transition: all var(--transition-normal);
    position: relative;
}

.workspace-manage-item:hover {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
}

.workspace-manage-info {
    flex: 1;
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    min-width: 0;
}
.workspace-manage-counts {
    font-size: 0.75rem;
    color: var(--text-secondary);
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    justify-content: center;
}

.workspace-manage-counts-files,
.workspace-manage-counts-references {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-xs);
    font-weight: 800;
    font-variation-settings: "wght" 800;
}

.workspace-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    flex: 1;
    min-width: 0;
}

.workspace-header h5 {
    margin: 0;
    font-size: 1rem;
    font-weight: 500;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
}

.workspace-manage-actions {
    display: flex;
    align-items: center;
}
/* Workspace Drag and Drop Styles */
.workspace-drag-handle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    cursor: grab;
    color: var(--text-secondary);
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    flex-shrink: 0;
    user-select: none;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .workspace-drag-handle:hover {
        color: var(--text-primary);
        background: var(--glass-layer-3);
    }
}

.workspace-drag-handle:active {
    cursor: grabbing;
}

.workspace-drag-handle i {
    font-size: 14px;
}

.workspace-manage-item.dragging {
    opacity: 0.8;
    transform: rotate(2deg);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
    transition: none;
    z-index: 1000;
    position: relative;
}

.workspace-manage-item.drag-placeholder {
    border: 2px dashed var(--primary-color);
    background: var(--glass-layer-1);
    opacity: 0.5;
    margin: 4px 0;
}

.workspace-manage-item.drag-over {
    border-color: var(--primary-color);
    background: var(--glass-layer-3);
    transform: translateY(2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.workspace-manage-item.drag-over::before {
    content: '';
    position: absolute;
    top: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--primary-color);
    border-radius: var(--border-radius-sm);
}

/* Workspace Edit Modal Styles */
#workspaceColorInput,
#workspaceBackgroundColorInput {
    width: 64px;
    padding: 4px 8px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    color: var(--text-primary);
    font-size: 1rem;
    height: 33px;
}

#workspaceColorInput:focus,
#workspaceBackgroundColorInput:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 69, 0, 0.2);
}

/* Workspace Settings Form Styles */


.modal-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1em;
}

.modal-footer {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-end;
    padding-top: 1em;
    gap: var(--spacing-lg);
    width: 100%;
}

/* Gallery Move Modal Styles */
.gallery-move-modal-content {
    flex-direction: row;
    max-width: 900px;
    width: 95vw;
    max-height: 85vh;
    display: flex;
    padding: 0;
    overflow: visible;
}

.gallery-move-left-header {
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    gap: var(--spacing-sm);
    width: 100%;
}

.gallery-move-left-panel .gallery-move-left-header {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 3;
    padding: var(--spacing-lg);
    border-top-left-radius: var(--border-radius-xl);
}

.gallery-move-left-panel {
    flex: 1;
    position: relative;
    display: flex;
    flex-direction: column;
    min-height: 450px;
    border-radius: var(--border-radius-xl);
    max-width: 350px;
}

.gallery-move-background-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: 50% 50%;
    z-index: 1;
    border-radius: var(--border-radius-xl) 0 0 var(--border-radius-xl);
    animation: image-pan 60s ease-in-out infinite;
}

@keyframes image-pan {
    0%, 100% {
        object-position: 0% 0%;
    }
    50% {
        object-position: 100% 100%;
    }
}

.gallery-move-overlay {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    height: 100%;
    background: linear-gradient(
        to bottom,
        rgba(0, 0, 0, 0.7) 0%,
        rgba(0, 0, 0, 0.3) 30%,
        rgba(0, 0, 0, 0.1) 70%,
        rgba(0, 0, 0, 0.8) 100%
    );
    border-radius: var(--border-radius-xl) 0 0 var(--border-radius-xl);
}

.gallery-move-header {
    gap: var(--spacing-sm);
    background: transparent;
    border-bottom: none;
    color: white;
    margin-bottom: 0;
}

.gallery-move-image-info-overlay {
    margin: auto var(--spacing-lg) var(--spacing-lg) var(--spacing-lg);
    background: var(--glass-layer-2);
    backdrop-filter: var(--glass-blur-2, none);
    border: 1px solid var(--glass-border-2);
    padding: var(--spacing-lg);
    border-radius: var(--border-radius-xxl);
}

.gallery-move-image-info-overlay p {
    margin: 0 0 var(--spacing-sm) 0;
    font-size: 0.9rem;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
}

.gallery-move-image-info-overlay p:last-child {
    margin-bottom: 0;
}

.gallery-move-right-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: var(--spacing-lg);
    justify-content: flex-start;
    gap: var(--spacing-lg);
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur, none);
    border-left: 1px solid var(--glass-border);
    position: relative;
}

.gallery-move-right-panel-cover {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-md);
    z-index: 1000;
    border-radius: var(--border-radius-lg);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.gallery-move-right-panel-cover.show {
    opacity: 1;
    visibility: visible;
}

.gallery-move-right-panel-cover .cover-spinner {
    font-size: 2rem;
    color: var(--primary-color);
}

.gallery-move-right-panel-cover .cover-text {
    color: white;
    font-size: 1.1rem;
    font-weight: 500;
    text-align: center;
    max-width: 200px;
}

.gallery-move-instructions {
    text-align: center;
}

.gallery-move-instructions h4 {
    margin: 0 0 var(--spacing-sm) 0;
    font-size: 1.2rem;
    color: var(--text-primary);
}

.gallery-move-instructions p {
    margin: 0;
    color: var(--text-muted);
    font-size: 0.9rem;
}

.gallery-move-workspace-selector {
    display: flex;
    justify-content: center;
}

.gallery-move-workspace-selector .custom-dropdown {
    width: 100%;
    max-width: 300px;
}

.gallery-move-actions {
    display: flex;
    gap: var(--spacing-md);
    justify-content: flex-end;
    align-items: center;
}   

.gallery-move-actions > button {
    min-width: 100px;
}
.gallery-move-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    justify-content: flex-start;
    gap: var(--spacing-lg);
}

.workspace-option-content {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}
.cache-browser-container-inner {
    overflow: auto;
    position: relative;
    height: 100%;
    overscroll-behavior: contain;
}

#workspaceBackgroundImageInput:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 69, 0, 0.2);
}

.opacity-display {
    text-align: center;
    margin-top: 8px;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

.opacity-display span {
    background: var(--glass-layer-3);
    padding: 4px 8px;
    border-radius: var(--border-radius-sm);
    border: 1px solid var(--glass-border-2);
}

/* Badge Active */
.badge-active {
    background: var(--success-color);
    color: white;
    padding: 2px 6px;
    border-radius: var(--border-radius-sm);
    font-size: 0.75rem;
    font-weight: 500;
    margin-left: 8px;
}

/* Workspace Move Item Styles */
.workspace-move-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-lg);
    background: var(--glass-layer-2);
    margin-bottom: 8px;
    cursor: pointer;
    transition: all var(--transition-normal);
}

.workspace-move-item:hover {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
}

.workspace-move-info {
    display: flex;
    align-items: center;
    flex: 1;
}

.workspace-move-info .workspace-name {
    font-weight: 500;
    color: var(--text-primary);
}

.workspace-move-info .badge-active {
    margin-left: 8px;
}

/* File Upload Selector */
.file-upload-selector {
    display: flex;
    gap: 8px;
    align-items: stretch;
}

.file-upload-selector input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-2);
    color: var(--text-primary);
    font-size: 1rem;
    cursor: default;
}

.file-upload-selector input:focus {
    outline: none;
    border: none;
}


.background-image-loading .spinner {
    margin-bottom: 16px;
}

/* Infinite Scroll Loading */
.infinite-scroll-loading {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-md);
    margin-top: var(--spacing-xxl);
    padding: var(--spacing-xl);
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--glass-shadow-2);
    position: relative;
    z-index: var(--z-layer-2);
    /* Responsive adjustments */
    margin-left: auto;
    margin-right: auto;
    max-width: 90vw;
    width: fit-content;
}

.infinite-scroll-loading p {
    color: var(--text-primary);
    font-weight: 500;
    margin: 0;
    text-align: center;
    font-size: 0.9rem;
}

.infinite-scroll-loading .spinner {
    width: 24px;
    height: 24px;
    border: 2px solid var(--glass-border-2);
    border-top: 2px solid var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

.infinite-scroll-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Responsive adjustments for infinite scroll loading */
@media (max-width: 768px) {
    .infinite-scroll-loading {
        padding: var(--spacing-lg);
        margin-top: var(--spacing-xl);
        gap: var(--spacing-sm);
    }
    
    .infinite-scroll-loading p {
        font-size: 0.8rem;
    }
    
    .infinite-scroll-loading .spinner {
        width: 24px;
        height: 24px;
        border-width: 2px;
    }
}

@media (max-width: 480px) {
    .infinite-scroll-loading {
        padding: var(--spacing-md);
        margin-top: var(--spacing-lg);
    }
    
    .infinite-scroll-loading p {
        font-size: 0.75rem;
    }
}

/* Cache Manager Modal Styles */
.cache-manager-content {
    max-width: 1200px;
    width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background: var(--glass-windows-bg, rgba(255, 255, 255, 0.1));
    backdrop-filter: var(--glass-blur-4, none);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    box-sizing: border-box;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.cache-manager-controls {
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    box-shadow: var(--glass-shadow-3);
}

.cache-manager-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
}

.cache-manager-workspace-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
}

.cache-manager-workspace-selector label {
    color: #ccc;
    font-size: 0.9rem;
    font-weight: 500;
    white-space: nowrap;
}

.cache-manager-actions {
    display: flex;
    gap: 12px;
    flex-shrink: 0;
}

.cache-manager-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    padding: 10px;
    overflow: hidden;
    box-sizing: border-box;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
}

.cache-manager-gallery-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    height: 100%;
    width: 100%;
    overflow: hidden;
    position: relative;
}

.cache-manager-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 16px;
    padding: 10px;
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1;
    width: 100%;
    max-height: 60vh;
    min-height: 250px;
}

/* Custom scrollbar for cache manager gallery */
.cache-manager-gallery::-webkit-scrollbar {
    width: 8px;
}

.cache-manager-gallery::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.cache-manager-gallery::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.cache-manager-gallery::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

.cache-manager-gallery-item {
    position: relative;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
}

.cache-manager-gallery-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.3);
}

.cache-manager-gallery-item img {
    width: 100%;
    aspect-ratio: 1/1;
    object-fit: cover;
    object-position: center top;
    display: block;
}

.cache-manager-gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.7) 100%);
    opacity: 0;
    transition: opacity 0.2s ease;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: end;
    padding: 12px;
}

.cache-manager-gallery-item:hover .cache-manager-gallery-item-overlay {
    opacity: 1;
}

.cache-manager-gallery-item-info {
    color: #fff;
    font-size: 0.8rem;
    line-height: 1.4;
}

.cache-manager-gallery-item-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    align-items: flex-end;
}

.cache-manager-gallery-item.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
}

.cache-manager-gallery.selection-mode .cache-manager-gallery-item {
    cursor: default;
}

.cache-manager-gallery.selection-mode .cache-manager-gallery-item:not(.selected):not(:hover) {
    opacity: 0.7;
}

.cache-manager-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px;
    color: #ccc;
    min-height: 200px;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2;
    border-radius: var(--border-radius-lg);
    gap: var(--spacing-lg);
    background: #7c7c7cf5;
    border: 1px solid var(--glass-border-1);
}

.cache-manager-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 16px;
}

.cache-manager-loading p {
    margin: 0;
    font-size: 0.9rem;
}

/* Cache Manager Badges */
.cache-manager-badges {
    position: absolute;
    top: 8px;
    left: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    z-index: 2;
    flex-wrap: wrap;
    max-height: -webkit-fill-available;
}

.cache-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    gap: 4px;
    color: white;
    width: fit-content;
    box-shadow: 0 0 17px 0px #ffffffc4;
}

.cache-badge.base-image {
    background: linear-gradient(135deg, #28672acc, #003624cc);
    color: #e9ffe9;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 17px 0px #002901cf;
}

.cache-badge.encoding {
    background: linear-gradient(135deg, #d921f3cc, #1995d2cc);
    display: flex;
    font-weight: bold;
    padding: 0 0 0 8px;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 0 17px 0px #6821f3cf;
}

.cache-badge.encoding.encoding-c {
    background: linear-gradient(135deg, #ee9535cc, #c32a89cc);
    box-shadow: 0 0 17px 0px #ee9535cf;
}

.cache-badge.encoding .badge-ie {
    padding: 4px 8px;
    border-radius: 12px;
    font-weight: normal;
    background: rgba(255, 255, 255, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
}

.cache-badge.encoding .badge-model {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    text-transform: none;
}


.default-workspace-badge {
    background: rgba(255, 255, 255, 0.8);
    color: #000000;
    font-weight: bold;
    z-index: 10;
    pointer-events: none;
    display: flex;
    align-items: center;
    box-shadow: 0 0 17px 0px #ffffffc4;
}
.workspace-badge {
    background: #ac4300;
    font-weight: bold;
    z-index: 10;
    pointer-events: none;
    display: flex;
    align-items: center; 
    box-shadow: 0 0 17px 0px #ac4300c4;
}
.novelai-badge {
    background: #1b0167db;
    color: #dbcfff;
    font-weight: bold;
    z-index: 10;
    pointer-events: none;
    display: flex;
    align-items: center;
    box-shadow: 0 0 17px 0px #1b0167c4;
}

.locked-badge {
    background: linear-gradient(135deg, #860000, #d01717);
    color: white;
    z-index: 10;
    pointer-events: none;
    display: flex;
    align-items: center;
    box-shadow: 0 0 17px 0px #860000c4;
}


/* Upload Progress Styles */
.upload-progress {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 8px;
}

.progress-bar {
    flex: 1;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--primary-color);
    border-radius: 4px;
    transition: width 0.3s ease;
    width: 0%;
}

div#cacheManagerMoveModal, #workspaceEditModal {
    background: #00000085;
}

/* Responsive Design */
@media (max-width: 768px) {
    .cache-manager-content {
        width: 95vw;
        max-height: 95vh;
    }
    
    .cache-manager-header {
        align-items: stretch;
        gap: 16px;
    }
    
    .cache-manager-workspace-selector {
        justify-content: center;
    }
    
    .cache-manager-actions {
        justify-content: center;
    }
    
    .cache-manager-gallery {
        gap: 12px;
    }
}

@keyframes slideUpFromBottom {
    from {
        opacity: 0;
        transform: translateY(10px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes slideDownFromTop {
    from {
        opacity: 0;
        transform: translateY(-10px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.search-results-info {
    margin-top: 4px;
    font-size: 12px;
    color: var(--text-muted);
    text-align: center;
    padding: 2px 8px;
    background: var(--accent-color-alpha);
    border-radius: 10px;
    border: 1px solid var(--accent-color);
}

/* Search highlighting */
.search-highlight {
    background: var(--accent-color);
    color: var(--accent-text);
    padding: 2px 2px;
    border-radius: 2px;
    font-weight: 500;
}

/* Responsive adjustments */

/* File Search Autofill Styles - Now using main autocomplete CSS */
.suggestion-type-badge {
    background: var(--accent-color-alpha);
    color: var(--accent-color);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    margin-right: 8px;
    display: inline-block;
}

/* Weight dot styling for file search suggestions */
.character-autocomplete-item .weight-dot {
    border-color: hsl(120, 100%, 50%);
}

/* Preview Images Section - using same styling as spell check */
.preview-images-section {
    background: rgb(0 0 0 / 80%);
    border-bottom: 1px solid var(--glass-border-2);
    padding: 6px 8px;
    position: sticky;
    top: 0;
    z-index: 10;
    order: 99999;
}

.preview-images-header {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.8rem;
    color: #65afff;
    margin-bottom: 8px;
    font-weight: 500;
}

.preview-images-header i {
    color: #65afff;
}

.preview-images-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 4px;
}

.preview-image-item {
    position: relative;
    aspect-ratio: 1;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.2s ease;
    border: 1px solid var(--glass-border-1);
}

.preview-image-item:hover {
    transform: scale(1.05);
    border-color: var(--glass-border-3);
}

.preview-image-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.preview-image-fallback {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--glass-layer-dark-2);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
}

.preview-image-fallback i {
    font-size: 16px;
    opacity: 0.6;
}

.preview-image-rank {
    position: absolute;
    top: 4px;
    right: 4px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    font-size: 10px;
    font-weight: bold;
    padding: 2px 4px;
    border-radius: 4px;
    z-index: 1;
}

/* File search keyboard navigation */
.character-autocomplete-item.selected {
    background: var(--glass-layer-3);
    border-color: var(--glass-border-3);
}

.character-autocomplete-item.selected .character-name {
    color: var(--accent-color);
}

.character-autocomplete-item.more-indicator:hover {
    opacity: 1;
    background: var(--glass-layer-2);
}

/* Preview images functionality removed - using same layout as main autocomplete */

/* File Search Initialization Banner - Now using main search status styling */

/* Search Status Styles */
.search-status {
    display: flex;
    align-items: center;
    gap: 8px;
}

.search-status.searching {
    color: var(--accent-color);
}

.search-status.results {
    color: var(--success-color);
}

.search-status.no-results {
    color: var(--text-muted);
}

.search-status.error {
    color: var(--error-color);
}

.search-spinner {
    width: 16px;
    height: 16px;
    border: 2px solid var(--accent-color-alpha);
    border-top: 2px solid var(--accent-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Gallery Highlight Effect */
.gallery-item.highlighted {
    animation: highlight-pulse 2s ease-in-out;
}

@keyframes highlight-pulse {
    0%, 100% { 
        transform: scale(1);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    50% { 
        transform: scale(1.05);
        box-shadow: 0 4px 16px var(--accent-color-alpha);
    }
}

/* Search indicator styles */
.search-indicator {
    background: var(--accent-color-alpha);
    border: 1px solid var(--accent-color);
    border-radius: 8px;
    padding: 12px 16px;
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.search-indicator-content {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--accent-text);
    font-size: 14px;
}

.search-indicator i {
    color: var(--accent-color);
}

.clear-search-link {
    background: none;
    border: none;
    color: var(--accent-color);
    text-decoration: underline;
    cursor: pointer;
    padding: 0;
    font-size: 14px;
    margin-left: 8px;
}

.clear-search-link:hover {
    color: var(--accent-text);
    text-decoration: none;
}

/* Empty search results */
.empty-search-results {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
}

.empty-search-icon {
    font-size: 48px;
    color: var(--text-muted);
    margin-bottom: 20px;
}

.empty-search-results h3 {
    color: var(--text-primary);
    margin-bottom: 12px;
    font-size: 20px;
}

.empty-search-results p {
    margin-bottom: 8px;
    line-height: 1.5;
}

.empty-search-results strong {
    color: var(--text-primary);
}

.empty-search-results .btn-secondary {
    margin-top: 20px;
}

/* Search input focus state */
.search-input-wrapper.focused .file-search-input {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--accent-color-alpha);
}

/* Search input searching state */
.file-search-input.searching {
    background: var(--input-bg-focus);
    border-color: var(--accent-color);
}

/* Error state for search results info */
.search-results-info.error {
    background: rgba(220, 53, 69, 0.1);
    border-color: #dc3545;
    color: #dc3545;
}

@media (max-width: 480px) {
    .cache-manager-content {
        width: 100vw;
        height: 100vh;
        max-height: none;
        border-radius: 0;
    }
    
    .cache-manager-gallery {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 8px;
    }
    
    .cache-manager-gallery-item img {
        aspect-ratio: 1/1;
    }
}

/* Emphasis highlighting styles */
.emphasis-highlight {
    position: relative;
    display: inline;
    padding: 1px 2px;
    margin: 0 -2px;
    border-radius: 3px;
    transition: all 0.2s ease;
}

/* Emphasis highlighting overlay */
.emphasis-highlight-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 1;
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow: hidden;
    background: transparent;
}

.emphasis-highlight-overlay,
.search-highlight-overlay,
.search-highlight-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 1;
    font-family: var(--font-mono);
    font-size: 1em;
    line-height: 1.5;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow: hidden;
    padding: 0.6em;
    background: transparent;
    border: none;
    outline: none;
    resize: none;
    line-break: anywhere;
    color: transparent;
}

.prompt-textarea-container {
    position: relative;
}

.prompt-textarea-container .prompt-textarea, 
.prompt-textarea-container .prompt-textarea:hover,
.prompt-textarea-container .prompt-textarea:focus,
.prompt-textarea-container .prompt-textarea:active,
.character-prompt-textarea-container .character-prompt-textarea,
.character-prompt-textarea-container .character-prompt-textarea:hover,
.character-prompt-textarea-container .character-prompt-textarea:focus,
.character-prompt-textarea-container .character-prompt-textarea:active,
.character-prompt-tabs .tab-pane textarea,
.character-prompt-tabs .tab-pane textarea:hover,
.character-prompt-tabs .tab-pane textarea:focus,
.character-prompt-tabs .tab-pane textarea:active {
    display: block;
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
    backdrop-filter: none !important;
}

.emphasis-highlight-overlay {
    z-index: 1;
}
.search-highlight-overlay {
    z-index: 3;
}

/* Cache Manager Tabs */
.cache-manager-tabs {
    margin-bottom: var(--spacing-sm);
}


/* Vibe Manager Styles */

.vibe-manager-gallery-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    width: 100%;
    overflow: hidden;
}

.vibe-manager-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 16px;
    padding: 10px;
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1;
    width: 100%;
    max-height: 60vh;
    min-height: 200px;
}

/* Custom scrollbar for vibe manager gallery */
.vibe-manager-gallery::-webkit-scrollbar {
    width: 8px;
}

.vibe-manager-gallery::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.vibe-manager-gallery::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.vibe-manager-gallery::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-light);
}

/* Disabled vibe transfer elements during inpainting */
#vibeReferencesContainer[style*="opacity: 0.5"] {
    position: relative;
}

#vibeReferencesContainer[style*="opacity: 0.5"]::after {
    content: "Vibe transfers disabled during inpainting";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    z-index: 10;
    pointer-events: none;
}

.cache-browser-tabs .tab-btn[style*="opacity: 0.5"],
.cache-manager-tabs .tab-btn[style*="opacity: 0.5"] {
    position: relative;
    cursor: not-allowed;
}

.cache-browser-tabs .tab-btn[style*="opacity: 0.5"]::after,
.cache-manager-tabs .tab-btn[style*="opacity: 0.5"]::after {
    content: "âš ï¸";
    position: absolute;
    top: -5px;
    right: -5px;
    background: #ff6b6b;
    color: white;
    border-radius: 50%;
    width: 16px;
    height: 16px;
    font-size: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
}

.vibe-manager-gallery-item {
    position: relative;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.2s ease;
    cursor: pointer;
}

.vibe-manager-gallery-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.3);
}

.vibe-manager-gallery-item img {
    width: 100%;
    aspect-ratio: 1/1;
    object-fit: cover;
    object-position: center top;
    display: block;
}

.vibe-manager-gallery-item-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.7) 100%);
    opacity: 0;
    transition: opacity 0.2s ease;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 12px;
    z-index: 5;
}

.vibe-manager-gallery-item:hover .vibe-manager-gallery-item-overlay {
    opacity: 1;
}

.vibe-manager-gallery-item-info {
    color: #fff;
    font-size: 0.8rem;
    line-height: 1.4;
}

.vibe-manager-gallery-item-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}

.vibe-manager-gallery-item-encodings {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    max-width: 80px;
    z-index: 10;
}

.vibe-manager-encoding-badge {
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.vibe-manager-encoding-badge.no-encodings {
    background: rgba(255, 0, 0, 0.6);
    border-color: rgba(255, 0, 0, 0.8);
}

.vibe-manager-reference-preview {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 16px;
    text-align: center;
    margin-bottom: 16px;
}

.vibe-manager-reference-preview img {
    max-width: 100%;
    max-height: 200px;
    border-radius: 4px;
    object-fit: contain;
}

.vibe-manager-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px;
    color: #ccc;
    min-height: 200px;
}

.vibe-manager-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-top: 3px solid #fff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 16px;
}

.vibe-manager-loading p {
    margin: 0;
    font-size: 0.9rem;
    color: #ccc;
}

.vibe-manager-gallery-item.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-color);
}

.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item {
    cursor: pointer;
}

.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item:not(.selected):not(:hover) {
    opacity: 0.7;
}

.vibe-manager-gallery.selection-mode .vibe-manager-gallery-item:hover {
    opacity: 1;
}

/* Vibe delete items list styling */
.vibe-delete-items-list {
    max-height: 300px;
    overflow-y: auto;
    padding: 8px;
    border: 1px solid var(--glass-border-3);
    border-radius: 8px;
    background: var(--glass-inset-bg-3);
}

.vibe-delete-select-all {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-bottom: 1px solid var(--glass-border-2);
    background: var(--glass-layer-2);
    font-weight: 600;
    color: var(--text-primary);
}

.vibe-delete-select-all input[type="checkbox"] {
    display: none;
}

.vibe-delete-select-all .checkmark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
    cursor: pointer;
}

.vibe-delete-select-all input[type="checkbox"]:checked + .checkmark {
    background: var(--primary-color);
}

.vibe-delete-select-all input[type="checkbox"]:checked + .checkmark::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-primary);
    font-size: 12px;
    font-weight: bold;
}

.vibe-delete-select-all label {
    cursor: pointer;
    margin: 0;
    font-size: 1rem;
    color: var(--text-primary);
}

.vibe-delete-items {
    padding: 0.75rem;
}

.vibe-delete-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border: 1px solid var(--glass-border-1);
    border-radius: var(--border-radius-md);
    background: var(--glass-layer-1);
    margin-bottom: 0.5rem;
    transition: all var(--transition-normal);
}

.vibe-delete-item:hover {
    background: var(--glass-layer-2);
    border-color: var(--glass-border-2);
    box-shadow: var(--glass-shadow-1);
}

.vibe-delete-item:last-child {
    margin-bottom: 0;
}

.vibe-delete-item input[type="checkbox"] {
    display: none;
}

.vibe-delete-item .checkmark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    position: relative;
    transition: all var(--transition-normal);
    cursor: pointer;
    flex-shrink: 0;
}

.vibe-delete-item input[type="checkbox"]:checked + .checkmark {
    background: var(--primary-color);
}

.vibe-delete-item input[type="checkbox"]:checked + .checkmark::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-primary);
    font-size: 12px;
    font-weight: bold;
}

.vibe-delete-item label {
    cursor: pointer;
    flex: 1;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    color: var(--text-primary);
}

.vibe-delete-item .vibe-badge {
    flex-shrink: 0;
}

.overlay-buttons-container {
    display: flex;
    justify-content: space-between;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    padding: 10px;
    z-index: 2;
}
.overlay-buttons-container-bottom {
    display: flex;
    justify-content: flex-end;
    position: absolute;
    bottom: 0;
    right: 0;
    padding: 10px;
    z-index: 2;
}

.vibe-delete-item {
    cursor: pointer;
    padding: 12px;
    border: 1px solid var(--glass-border-3);
    border-radius: 8px;
    margin: 4px 0;
    background: var(--glass-layer-3);
    transition: all 0.2s ease;
    user-select: none;
}

.vibe-delete-item:hover {
    background: #ff000029;
    border-color: #a41111;
    transform: translateY(-1px);
    box-shadow: 0 2px 10px rgb(255 0 0 / 22%);
}

.vibe-delete-item.selected {
    background: #dc000069;
    border-color: #f32121;
    box-shadow: 0 2px 8px rgb(243 33 33 / 30%);
    color: var(--text-primary);
}

.vibe-delete-item-content {
    display: flex;
    align-items: center;
    gap: 12px;
    justify-content: space-between;
    width: 100%;
}

.vibe-delete-item-name {
    font-weight: 500;
    font-size: 14px;
}

.vibe-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.transformation-image-container {
    display: flex;
    flex-direction: column;
    position: relative;
    min-width: calc(33.3333333333333333% - var(--spacing-sm));
    max-width: calc(33.3333333333333333% - var(--spacing-sm));
    background: var(--glass-layer-2);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--glass-border-2);
    height: -webkit-fill-available;
}

.no-items {
    text-align: center;
    color: var(--text-secondary);
    font-style: italic;
    padding: 2rem;
}

/* Modal buttons styling */
.modal-buttons {
    display: flex;
    gap: 0.75rem;
    justify-content: flex-end;
}

.modal-buttons .btn-secondary,
.modal-buttons .btn-danger {
    padding: 0.5rem 1rem;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.2s ease;
}

.modal-buttons .btn-secondary {
    background: #6c757d;
    color: white;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal-buttons .btn-secondary:hover {
        background: #5a6268;
    }
}

.modal-buttons .btn-danger {
    background: #dc3545;
    color: white;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .modal-buttons .btn-danger:hover {
        background: #c82333;
    }
}
.delete-options {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.radio-option {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 4px;
    transition: background-color 0.2s;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .radio-option:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }
}

.radio-option input[type="radio"] {
    margin: 0;
}

.radio-label {
    font-weight: 500;
    color: #fff;
}

.delete-items-list {
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    padding: 0.5rem;
    background-color: rgba(0, 0, 0, 0.3);
}

.delete-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
    transition: background-color 0.2s;
}

.delete-item:last-child {
    border-bottom: none;
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .delete-item:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }
}

.delete-item input[type="checkbox"] {
    margin: 0;
}

.delete-item-label {
    flex: 1;
    font-size: 0.9rem;
    color: #fff;
}

.delete-item-badge {
    font-size: 0.8rem;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    background-color: #007bff;
    color: white;
}

/* Enhanced vibe image badges */
.vibe-image-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    margin-top: 0.5rem;
}

.vibe-badge {
    font-size: 0.75rem;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    color: white;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    position: relative;
    overflow: hidden;
}

.vibe-badge.split {
    background: transparent;
    padding: 0;
    display: flex;
    overflow: hidden;
    border-radius: 3px;
    gap: 0;
}

.vibe-badge.split .badge-text:first-child {
    background: #007bff;
    padding: 0.2rem 0.4rem;
    border-radius: 3px 0 0 3px;
}

.vibe-badge.split .badge-text:last-child {
    background: #28a745;
    padding: 0.2rem 0.4rem;
    border-radius: 0 3px 3px 3px;
}

.vibe-badge.vibe-only {
    background: #d00000;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
}

.vibe-badge .badge-icon {
    font-size: 0.7rem;
}

.vibe-badge .badge-text {
    font-size: 0.7rem;
    font-weight: 500;
}

.comment-dialog .modal-content {
    width: 90%;
}

.comment-dialog .comment-content {
    padding: 1rem 0;
}

/* Vibe Bundle Preview Styles */
.vibe-bundle-preview-container {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background: var(--background-secondary);
    max-height: 300px;
    overflow-y: auto;
}

.vibe-bundle-list {
    padding: 0.5rem;
    display: flex;
    flex-direction: column;
    gap: 1em;
}

.vibe-bundle-item {
    display: flex;
    align-items: center;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    gap: 1rem;
}

.vibe-bundle-item:last-child {
    margin-bottom: 0;
}

.vibe-bundle-item-image {
    width: 48px;
    height: 48px;
    border-radius: 4px;
    object-fit: cover;
    background: var(--background-secondary);
    flex-shrink: 0;
}

.vibe-bundle-item-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.vibe-bundle-item-name {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
}

.vibe-bundle-item-info {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;
}

/* Vibe bundle items now use the same badge structure as vibe manager - no custom styles needed */

.unified-upload-mode-selector.disabled {
    opacity: 0.5;
    pointer-events: none;
}

.unified-upload-mode-selector.disabled .mode-slider-btn {
    cursor: not-allowed;
}

.comment-dialog .comment-content p {
    margin: 0;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.vibes-comments-content {
    max-height: 400px;
    overflow-y: auto;
}

.vibe-comment-item {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.vibe-comment-item:last-child {
    border-bottom: none;
}

.vibe-comment-item h4 {
    margin: 0 0 0.5rem 0;
    color: var(--text-primary);
    font-size: 1rem;
}

.vibe-comment-item p {
    margin: 0;
    white-space: pre-wrap;
    word-wrap: break-word;
    line-height: 1.5;
    text-align: left;
    background: var(--glass-layer-dark-5);
    padding: var(--spacing-sm);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-lg);
    font-size: 14px;
}
#vibeManagerDeleteModal .modal-content {
    width: 350px;
}

.queue-status {
    font-weight: bold;
    color: var(--text-secondary);
    transition: color 0.2s;
}
.queue-status.notice {
    background: #f29d0024;
    color: #d8c8ab;
    border-color: rgb(255 202 136 / 20%);
}
.queue-status.warn {
    background: #904d007d;
    color: #ffd68a;
    border-color: rgb(255 214 136 / 20%);
}
.queue-status.bad {
    background: #7e121278;
    color: #ff9999;
    border-color: rgb(255 136 136 / 20%);
}
.queue-status.stopped {
    background: #61000078;
    color: #ff5959;
    border-color: rgb(255 136 136 / 20%);
}

body.scraps-grayscale::after {
    background: radial-gradient(hsl(0deg 0% 0% / 59%), hsl(0deg 0% 0%));
}

.gallery-item.initial-placeholder:not(.fade-in), .gallery-placeholder.initial-placeholder:not(.fade-in) {
    opacity: 0;
}

.gallery-item.fade-in, .gallery-placeholder.fade-in {
    opacity: 0;
    animation: galleryFadeIn 1s forwards;
}

@keyframes galleryFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.gallery-item.slide-in, .gallery-placeholder.slide-in {
    opacity: 0;
    transform: translateY(32px);
    animation: gallerySlideIn 2s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes gallerySlideIn {
    from {
        opacity: 0;
        transform: translateY(32px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* WebSocket Glass Toast Variants */
.glass-toast.glass-toast-success {
    color: #ecfff3;
    border-color: rgba(40, 167, 69, 0.3);
    background: rgb(0 119 27 / 84%);
    box-shadow: 0 8px 25px var(--shadow-success);
}

.glass-toast.glass-toast-error {
    color: #ffeeee;
    border-color: rgb(255 144 154 / 45%);
    background: rgb(135 4 16 / 87%);
    box-shadow: 0 8px 25px var(--shadow-error);
}

.glass-toast.glass-toast-warning {
    color: #ffd68a;
    border-color: rgb(255 214 136 / 20%);
    background: #753f00e6;
    box-shadow: 0 8px 25px var(--shadow-warning);
}

.glass-toast.glass-toast-info {
    color: #e1f7ff;
    border-color: rgb(55 191 255 / 20%);
    background: #104c60db;
    box-shadow: 0 8px 25px var(--shadow-info);
}

@keyframes glassToastSlideIn {
    from {
        transform: translateX(100%) scale(0.95);
        opacity: 0;
    }
    to {
        transform: translateX(0) scale(1);
        opacity: 1;
    }
}

@keyframes glassToastSlideOut {
    from {
        transform: translateX(0) scale(1);
        opacity: 1;
    }
    to {
        transform: translateX(100%) scale(0.95);
        opacity: 0;
    }
}

.search-highlight {
    background: rgba(0, 191, 255, 0.3);
    border: 1px solid rgba(0, 191, 255, 0.6);
    border-radius: 2px;
    padding: 0 1px;
}

/* Keyboard Shortcuts Overlay */
.shortcuts-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: flex-end;
    justify-content: flex-end;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease-in-out;
    pointer-events: none;
    z-index: 10000;
    padding: var(--spacing-xxl);
}

.shortcuts-overlay.visible {
    opacity: 1;
    visibility: visible;
}

.shortcuts-content {
    background: var(--glass-layer-dark-5);
    backdrop-filter: var(--glass-blur-4, none);
    border: 1px solid var(--glass-border-4);
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-md);
    box-shadow: var(--glass-shadow-4);
    max-width: 275px;
    width: 90%;
    transform: translateY(20px);
    transition: transform 0.2s ease-in-out;
}

.shortcuts-overlay.visible:hover {
    visibility: hidden;
}

.shortcuts-overlay.visible .shortcuts-content {
    transform: translateY(0);
}

.shortcuts-title {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-primary);
    text-align: center;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.shortcuts-grid {
    display: grid;
    gap: var(--spacing-sm);
}

.shortcut-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-xs) var(--spacing-md) var(--spacing-xs) var(--spacing-xs);
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    transition: all 0.2s ease;
}

.shortcut-item:hover {
    background: var(--glass-layer-4);
    border-color: var(--glass-border-3);
    transform: translateX(4px);
}

.shortcut-key {
    background: var(--primary-color-dark);
    color: var(--text-primary);
    padding: 3px 6px;
    border-radius: var(--border-radius-sm);
    font-family: var(--font-mono);
    font-size: 0.75rem;
    font-weight: 600;
    border: 1px solid var(--border-primary);
    min-width: 80px;
    text-align: center;
    text-transform: uppercase;
}

.shortcut-desc {
    color: var(--text-primary);
    font-size: 0.95rem;
    font-weight: 500;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    gap: var(--spacing-sm);
}

.search-highlight-selected {
    background: rgba(0, 191, 255, 0.6);
    border: 2px solid #00bfff;
    border-radius: 2px;
    padding: 0 1px;
    box-shadow: 0 0 4px rgba(0, 191, 255, 0.4);
}


/* Confirmation Dialog Styles */
.confirmation-dialog {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    padding: var(--spacing-sm);
    max-width: min(500px, 85vw);
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.confirmation-dialog-content {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.confirmation-message {
    font-size: 0.9rem;
    color: var(--text-primary);
    line-height: 1.4;
    text-align: center;
    padding: 8px 0;
}

/* Form groups inside confirmation dialog */
.confirmation-message .form-group {
    margin-bottom: var(--spacing-md);
    text-align: left;
    flex: auto;
}

.confirmation-message .form-group label {
    display: block;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    font-size: 0.85em;
}

.confirmation-message .meta-value {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-md);
    padding: var(--spacing-sm);
    font-family: monospace;
    word-break: break-all;
    font-size: 0.8em;
}

.confirmation-controls {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}

.confirmation-btn {
    padding: 8px 16px;
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-sm);
    background: var(--glass-layer-dark-3);
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 0.85rem;
    font-weight: 500;
    min-width: 80px;
}

.confirmation-btn:hover {
    background: var(--glass-layer-dark-4);
    border-color: var(--glass-border-3);
}

.confirmation-btn.confirmation-confirm:hover {
    background: #4ecdc4;
    border-color: #4ecdc4;
    color: white;
}

.confirmation-btn.confirmation-cancel:hover {
    background: #ff6b35;
    border-color: #ff6b35;
    color: white;
}

/* Credit Cost Dialog Styles */
.credit-cost-dialog {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: 9999999;
    padding: var(--spacing-sm);
    width: 350px;
    display: block;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.credit-cost-content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.credit-cost-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 600;
    color: var(--text-primary);
}

.credit-cost-header i {
    color: var(--accent-primary);
    font-size: 1.2em;
}

.credit-cost-message {
    color: var(--text-secondary);
    line-height: 1.5;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 5px;
}

.credit-cost-message .credit-cost-cost {
    color: var(--text-accent);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 5px;
}

.credit-cost-buttons {
    display: flex;
    gap: var(--spacing-sm);
    justify-content: flex-end;
}

/* Gallery Toolbar Styles */
.gallery-toolbar {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    padding: var(--spacing-sm);
    display: flex;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.gallery-toolbar-content {
    display: flex;
    align-items: center;
}

.gallery-toolbar-buttons {
    display: flex;
    gap: var(--spacing-xs);
    align-items: center;
}

/* Text Search Popup Styles */
.text-search-popup,
.dataset-tag-toolbar {
    position: absolute;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    padding: var(--spacing-sm);
    width: 350px;
    display: none;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.dataset-tag-toolbar {
    display: flex;
    width: unset;
}

.dataset-tag-dropdowns-container {
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    flex-wrap: nowrap;
    gap: 5px;
}

.text-search-popup-content,
.dataset-tag-toolbar-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.text-search-label,
.dataset-tag-label {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-weight: bold;
    text-transform: uppercase;
    white-space: nowrap;
}

.text-search-input-container,
.dataset-tag-dropdowns-container {
    flex: 1;
}

.text-search-input,
.dataset-tag-input {
    width: 100%;
    padding: 4px 8px;
    border: 1px solid var(--border-secondary);
    border-radius: var(--border-radius-sm);
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-size: 14px;
    transition: border-color 0.2s ease;
}

.text-search-input:focus {
    outline: none;
    border-color: #00bfff;
    box-shadow: 0 0 0 2px rgba(0, 191, 255, 0.2);
}

.text-search-match-count {
    font-family: var(--font-mono);
    font-size: 1.2rem;
    font-weight: bold;
    padding: 2px 8px;
    border-radius: var(--border-radius-sm);
    background: var(--glass-layer-dark-3);
    border: 1px solid var(--glass-border-2);
    min-width: 40px;
    text-align: center;
    color: #00bfff;
}

.text-search-controls,
.dataset-tag-controls {
    display: flex;
    gap: 5px;
    position: relative;
}

.text-search-btn,
.dataset-tag-btn {
    padding: 0.25em 0.5em;
    min-height: 30px;
    min-width: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--glass-layer-dark-3);
    border: 1px solid var(--glass-border-2);
    border-radius: var(--border-radius-sm);
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.text-search-btn:hover,
.dataset-tag-btn:hover {
    background: var(--glass-layer-dark-4);
    border-color: var(--glass-border-3);
}

.text-search-btn.text-search-btn.text-search-prev:hover,
.text-search-btn.text-search-next:hover {
    background: #00bfff;
    border-color: #00bfff;
    color: white;
}

.text-search-btn.text-search-close:hover,
.dataset-tag-btn.dataset-tag-close:hover {
    background: #ff6b35;
    border-color: #ff6b35;
    color: white;
}

.search-highlight {
    background: rgb(0 123 164 / 74%);
    border: 1px solid rgba(0, 191, 255, 0.6);
    color: #52dfff;
    padding: 2px 2px;
    border-radius: 2px;
    margin: 0 -3px;
    transition: all 0.2s ease;
}

.search-highlight-selected {
    background: rgba(0, 191, 255, 0.6);
    border: 2px solid #00bfff;
    border-radius: 2px;
    padding: 0;
    margin: 0 -2px;
    color: #ffffff;
    transition: all 0.2s ease;
}

.cache-manager-tabs, .cache-browser-tabs {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    flex-wrap: nowrap;
    flex-direction: row;
    gap: var(--spacing-md);
}
.cache-manager-tabs {
    margin-bottom: var(--spacing-sm);
}
.cache-browser-tabs .tab-text, .cache-manager-tabs .tab-text {
    font-size: 1.25em;
    color: #ffffffdb;
}

/* Cache Browser Tabs - Gallery Toggle Group Design */
#manualModal .cache-browser-tabs .gallery-toggle-group {
    background: rgb(59, 59, 59, 0.5);
    grid-template-columns: 1fr 1fr;
}

#manualModal .cache-browser-tabs .gallery-toggle-group .gallery-toggle-btn.active i {
    transform: scale(1.1);
}

#manualModal .cache-browser-tabs .gallery-toggle-group .gallery-toggle-slider {
    width: calc(50% - 3px);
}

#manualModal .cache-browser-tabs .gallery-toggle-group[data-active="vibe-references"] .gallery-toggle-slider {
    transform: translateX(calc(100% + 2px));
}

/* Cache Manager Tabs - Gallery Toggle Group Design */
.cache-manager-tabs .gallery-toggle-group {
    background: rgb(59, 59, 59, 0.5);
    grid-template-columns: 1fr 1fr;
}

.cache-manager-tabs .gallery-toggle-group .gallery-toggle-slider {
    width: calc(50% - 3px);
}

.cache-manager-tabs .gallery-toggle-group[data-active="vibe"] .gallery-toggle-slider {
    transform: translateX(calc(100% + 2px));
}

.dataset-tag-dropdown-wrapper .custom-dropdown-btn.hover-show:not(.active) {
    padding: 0.35em 0 0.35em 0;
    color: #ed9b7c;
    gap: 5px;
}

/* Category badge styles */
.tag-category-badge {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 2px 6px;
    border-radius: 8px;
    font-size: 0.7em;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-left: 6px;
    backdrop-filter: var(--glass-blur-1, none);
}

/* Dual match category badge - special color */
.tag-category-badge {
    background: rgba(255, 193, 7, 0.3);
    color: #ffc107;
    border: 1px solid rgba(255, 193, 7, 0.5);
}

/* Count dots styles */
.tag-count-dots {
    display: flex;
    align-items: center;
    gap: 3px;
    margin-left: 6px;
}

.tag-count-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.6);
    position: relative;
    cursor: help;
}

.tag-count-dot.n-count {
    background: rgba(255, 255, 255, 0.3);
}

.tag-count-dot.e-count {
    background: rgba(255, 255, 255, 0.3);
}

.tag-count-dot:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.7em;
    white-space: nowrap;
    z-index: 1000;
    margin-bottom: 4px;
}

.dataset-tag-option {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
    width: 100%;
}

.dataset-tag-option-container {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}
.dataset-tag-dropdown-wrapper .custom-dropdown-menu {
    max-width: unset;
    width: max-content;
}

.custom-dropdown-btn.hover-show.active {
    color: var(--text-primary);
    background: var(--hover-show-active-bg);
    padding: 0.35em 0.6em;
    outline: none;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
    border: 1px solid var(--hover-show-active-border);
    box-shadow: var(--hover-show-active-shadow);
    z-index: var(--z-layer-3);
}
span.dataset-button-text {
    gap: var(--spacing-sm);
}
.dataset-tag-name {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-start;
    gap: var(--spacing-sm);
}
.dataset-tag-name > i {
    min-width: 24px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}
#datasetTagSearchDropdown{
    background: #474747e0;
}
#datasetTagSearchDropdown .custom-dropdown-option.keyboard-selected {
    background: #6a210aa6 !important;
}

button#manualGenerateBtn {
    min-width: 200px;
}

/* Prompt Status Icons */
.prompt-status-icons {
    position: absolute;
    bottom: 8px;
    right: 8px;
    display: flex;
    gap: 6px;
    align-items: center;
    opacity: 0;
    transition: opacity var(--transition-normal);
    pointer-events: none;
    z-index: 1;
}

.prompt-textarea-container:not(.textarea-focused) .prompt-status-icons,
.character-prompt-textarea-container:not(.textarea-focused) .prompt-status-icons {
    opacity: 0.45;
}

.prompt-status-icon {
    height: 20px;
    min-width: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary-color-light);
}

/*.prompt-status-icon.quality-enabled {
    color: #fffadc;
}

.prompt-status-icon.dataset-enabled {
    color: #fffbe6;
}

.prompt-status-icon.uc-enabled {
    color: #ffe0e0;
}*/

/* UC level dots for UC status icon */
.uc-level-dots {
    display: flex;
    gap: 3px;
    align-items: center;
    justify-content: center;
}

.uc-level-dot {
    width: 10px;
    height: 10px;
    border-radius: 3px;
    background: currentColor;
    opacity: 0.3;
}

.uc-level-dot.active {
    opacity: 1;
}

/* Show appropriate dots based on UC level */
.prompt-status-icon.uc-enabled[data-uc-level="1"] .uc-level-dot:nth-child(1) {
    opacity: 1;
}

.prompt-status-icon.uc-enabled[data-uc-level="2"] .uc-level-dot:nth-child(1),
.prompt-status-icon.uc-enabled[data-uc-level="2"] .uc-level-dot:nth-child(2) {
    opacity: 1;
}

.prompt-status-icon.uc-enabled[data-uc-level="3"] .uc-level-dot:nth-child(1),
.prompt-status-icon.uc-enabled[data-uc-level="3"] .uc-level-dot:nth-child(2),
.prompt-status-icon.uc-enabled[data-uc-level="3"] .uc-level-dot:nth-child(3) {
    opacity: 1;
}

/* Hide status icons when toolbar is visible */
.prompt-textarea-container.textarea-focused .prompt-status-icons {
    opacity: 0;
}

/* Ensure icons don't interfere with textarea interaction */
.prompt-status-icons {
    pointer-events: none;
}

/* Show both mode - hide UC status icons on main prompt, hide quality/dataset on UC */
.prompt-tabs.show-both #prompt-tab .prompt-status-icon.uc-enabled {
    display: none !important;
}

.prompt-tabs.show-both #uc-tab .prompt-status-icon.quality-enabled,
.prompt-tabs.show-both #uc-tab .prompt-status-icon.dataset-enabled {
    display: none !important;
}

/* Responsive design for smaller screens */
@media (max-width: 768px) {
    .gallery-move-modal-content {
        flex-direction: column;
        max-height: 90vh;
    }
    
    .gallery-move-left-panel {
        min-height: 300px;
        border-bottom: 1px solid var(--glass-border);
    }
    
    .gallery-move-right-panel {
        border-left: none;
        border-top: 1px solid var(--glass-border);
    }
    
    .gallery-move-overlay {
        background: linear-gradient(
            to bottom,
            rgba(0, 0, 0, 0.8) 0%,
            rgba(0, 0, 0, 0.4) 50%,
            rgba(0, 0, 0, 0.9) 100%
        );
    }
}

/* Gallery Move Modal Styles - Shared by all move/encoding modals */

/* Additional styles for multi-select move modal cross-fade */
.gallery-move-background-image {
    transition: opacity 0.5s ease-in-out;
}

.gallery-move-background-image.fade-out {
    opacity: 0;
}

.gallery-move-background-image.fade-in {
    opacity: 1;
}

.mode-slider-container {
    position: relative;
    display: grid;
    grid-template-columns: 1fr 1fr;
    background: var(--glass-layer-1);
    border: 1px solid var(--glass-border-1);
    border-radius: var(--border-radius-lg);
    padding: 2px;
    box-shadow: inset 0 0 20px #000000a3;
    z-index: var(--z-layer-1);
    gap: 2px;
    transition: all var(--transition-normal);
}

.mode-slider-container.blueprint-enabled {
    grid-template-columns: 1fr 1fr 1fr;
}

.mode-slider-btn {
    position: relative;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 45px;
    z-index: var(--z-layer-2);
    gap: var(--spacing-sm);
}

.mode-slider-btn:hover {
    color: var(--text-primary);
}

.mode-slider-btn.active {
    color: var(--text-primary);
    background: transparent;
    border: none;
    box-shadow: none;
    z-index: var(--z-layer-3);
}

.mode-slider-track {
    position: absolute;
    top: 2px;
    left: 2px;
    width: calc(50% - 2px);
    height: calc(100% - 4px);
    background: var(--glass-layer-3);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--border-radius-md);
    box-shadow: var(--glass-shadow-3);
    transition: transform var(--transition-normal), background var(--transition-slow), border-color var(--transition-slow);
    z-index: var(--z-layer-2);
    pointer-events: none;
}

.mode-slider-container.blueprint-enabled .mode-slider-track {
    width: calc(33.333% - 3px);
}

.mode-slider-container[data-active="reference"] .mode-slider-track {
    transform: translateX(0);
    background: rgb(3 126 202 / 55%);
    border-color: rgb(77 190 255 / 45%);
}

.mode-slider-container[data-active="reference"].blueprint-enabled .mode-slider-track {
    transform: translateX(calc(100% + 3px));
}

.mode-slider-container[data-active="reference"] .mode-slider-btn.active {
    color: #c6ecff;
}

.mode-slider-container[data-active="vibe"] .mode-slider-track {
    transform: translateX(calc(100% + 1px));
    background: rgb(185 98 8 / 55%);
    border-color: rgb(255 97 0 / 44%);
}

.mode-slider-container[data-active="vibe"].blueprint-enabled .mode-slider-track {
    transform: translateX(calc(200% + 5px));
}

.mode-slider-container[data-active="vibe"] .mode-slider-btn.active {
    color: #ffc6c6;
}

.mode-slider-container[data-active="blueprint"].blueprint-enabled .mode-slider-track {
    transform: translateX(0);
    background: rgb(142 34 243 / 56%);
    border-color: rgb(188 115 255 / 32%);
}

.mode-slider-container[data-active="blueprint"] .mode-slider-btn.active {
    color: #e6c6ff;
}

/* Blueprint mode button styling */
.blueprint-mode-btn {
    display: none;
}

.mode-slider-container.blueprint-enabled .blueprint-mode-btn {
    display: flex;
}

/* Navigation Controls */
.navigation-controls {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    gap: 8px;
    flex: 1 0 auto;
}

.navigation-info {
    font-size: 0.9rem;
    color: var(--text-primary);
    text-align: center;
}

.warning-container {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background-color: var(--status-warning-bg);
    border-radius: 4px;
    margin-bottom: 0.75em;
    border: 1px solid var(--status-warning-border);
}

.warning-container i {
    color: var(--warning-color);
    font-size: 1.2rem;
}

.warning-message {
    color: var(--text-color);
    font-size: 0.9rem;
    line-height: 1.4;
    flex: 1;
}

.blueprint-info {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.meta-value {
    font-family: var(--font-mono);
    color: var(--hover-show-colored-text);
    gap: 6px;
    display: inline-flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: flex-start;
    align-items: center;
}

.meta-value.space-between {
    justify-content: space-between;
}

.forgedata-badge {
    border-radius: 3px;
    text-transform: none;
    background: var(--glass-layer-2);
    box-shadow: none;
    border: 1px solid var(--glass-border-2);
    letter-spacing: normal;
    display: inline-flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
    flex-direction: row;
    gap: 5px;
    font-size: 10pt;
    font-family: var(--font-secondary);
    padding: 2px 5px;
}

/* Vibe Controls Animation */
#unifiedUploadVibeControls {
    transition: all 0.3s ease;
}

#unifiedUploadVibeControls.show {
    display: block !important;
    animation: slideDown 0.3s ease;
}

#unifiedUploadVibeControls.hide {
    display: none !important;
    animation: slideUp 0.3s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        max-height: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        max-height: 200px;
        transform: translateY(0);
    }
}

@keyframes slideUp {
    from {
        opacity: 1;
        max-height: 200px;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        max-height: 0;
        transform: translateY(-10px);
    }
}

/* Favorites dialog styles */
.favorites-dialog .modal-content {
    max-width: 400px;
}

.favorites-dialog .form-group {
    margin-bottom: 15px;
}

.favorites-dialog label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
    font-size: 14px;
}

/* Text Replacement Dialog (Popup Style) */
.favorites-text-replacement-dialog {
    position: fixed;
    background: var(--glass-layer-dark-5);
    border: 1px solid var(--glass-border-3);
    box-shadow: 0 8px 25px var(--shadow-secondary);
    backdrop-filter: var(--glass-blur-2, none);
    border-radius: var(--border-radius-lg);
    z-index: var(--z-dialog);
    padding: var(--spacing-sm);
    width: min(450px, 85vw);
    display: none;
    transform: translateZ(0);
    will-change: backdrop-filter;
}

.favorites-text-replacement-dialog .confirmation-dialog-content {
    display: flex;
    flex-direction: column;
    gap: 12px;
    min-width: 350px;
    max-width: 450px;
}

.favorites-text-replacement-dialog .confirmation-message {
    font-size: 0.9rem;
    color: var(--text-primary);
    line-height: 1.4;
    text-align: left;
    padding: 8px 0;
}

.favorites-text-replacement-dialog .confirmation-controls {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}


#unifiedUploadModal .form-group.auto-width {
    flex: 0 1 auto;
    min-width: 10%;
}

#unifiedUploadModal .gallery-move-header .mode-slider-btn {
    padding: 6px var(--spacing-md);
}

#unifiedUploadModal .gallery-move-header .unified-upload-mode-selector.hide {
    width: 0;
    visibility: hidden;
    pointer-events: none;
}

.upload-options-container-info {
    font-size: 10pt;
    color: var(--text-muted);
    font-family: var(--font-secondary);
    font-weight: 500;
    font-variation-settings: "wght" 500;
    text-align: center;
}

/* Upload Options Container */
.upload-options-container {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 20px 0;
    height: 100%;
    justify-content: center;
    align-items: center;
}

.upload-options-container-inner {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-xl);
}

.upload-options-container-inner .btn-large {
    width: 100%;
    max-width: 300px;
    padding: 16px 24px;
    font-size: 16px;
    gap: var(--spacing-lg);
}

.upload-option-btn {
    min-width: 25%;
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    justify-content: center;
    align-items: center;
}

.upload-option-btn i {
    font-size: 32pt;
}

/* File Info Overlay */
#unifiedUploadFileInfo {
    text-align: center;
}

/* URL Preview Styles */
.url-display {
    word-break: break-all;
    font-family: var(--font-mono);
    font-size: 0.9rem;
    background: var(--background-secondary);
    padding: var(--spacing-sm);
    border-radius: var(--border-radius-sm);
    border: 1px solid var(--glass-border-2);
}

.form-group.full-width {
    width: 100%;
}

/* URL Preview specific styling for main content area */
#unifiedUploadUrlPreview {
    margin-bottom: var(--spacing-lg);
}

/* Site Domain Display in Footer */
.site-domain-display {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    color: var(--text-muted);
    font-size: 0.9rem;
    margin-right: auto;
}

.site-domain-display i {
    color: var(--accent-secondary);
}

.site-domain-display span {
    font-weight: 500;
}

#unifiedUploadSiteDomainText {
    display: inline-flex;
    align-items: center;
    justify-content: flex-start;
    flex-wrap: nowrap;
    flex-direction: row;
    border: 1px solid var(--glass-border-3);
    background: var(--glass-layer-3);
    padding: 4px 8px;
    gap: 8px;
    border-radius: 5px;
    font-size: 10pt;
}

#unifiedUploadUrlPreviewContent {
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    gap: var(--spacing-md);
}

.selected-text-preview {
    font-size: 0.9rem;
    color: var(--text-muted);
    background: var(--background-secondary);
    padding: 0.5rem;
    border-radius: 4px;
    margin-top: 0.5rem;
    word-break: break-word;
    border-left: 3px solid var(--accent-secondary);
}

.text-replacement-form {
    margin: 1rem 0;
}

.form-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.form-hint {
    font-size: 0.8rem;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.form-hint i {
    color: var(--accent-secondary);
}

#namePreview {
    font-family: var(--font-mono);
    color: var(--accent-primary);
    font-weight: 500;
}

/* TEXT REPLACEMENT MANAGER */
.text-replacement-manager-content {
    max-width: 900px;
    width: 90vw;
    height: 95vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.text-replacement-manager-content .modal-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

.text-replacement-manager-content .modal-header,
.text-replacement-manager-content .modal-footer {
    flex-shrink: 0;
}

.text-replacement-search {
    position: relative;
    margin-bottom: 1rem;
    flex-shrink: 0;
}

.text-replacement-search input {
    padding-right: 2.5rem;
}

.text-replacement-search i {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    pointer-events: none;
}

.text-replacement-list-container {
    flex: 1;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background: var(--glass-inset-bg-5);
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

.text-replacement-list {
    padding: 0.5rem;
    flex: 1;
    overflow-y: auto;
    gap: var(--spacing-md);
    display: flex;
    flex-direction: column;
}

.text-replacement-pagination {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding: 0;
    gap: var(--spacing-sm);
    flex-shrink: 0;
    margin-right: auto;
}

.pagination-btn {
    padding: 0.5rem 0.75rem;
    min-width: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.pagination-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.page-info {
    font-size: 0.9rem;
    color: var(--text-muted);
    font-weight: 500;
    min-width: 6rem;
    text-align: center;
}

.text-replacement-item {
    background: var(--glass-layer-2);
    border: 1px solid var(--glass-border-3);
    border-radius: var(--spacing-xs);
    padding: var(--spacing-sm);
    gap: var(--spacing-sm);
    display: flex;
    flex-direction: column;
    transition: all 0.2s ease;
}

.text-replacement-item.editing {
    border-color: var(--border-focus);
}

.text-replacement-item.modified {
    border-left: 4px solid var(--accent-warning);
}

.text-replacement-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-sm);
}

.text-replacement-name {
    font-family: var(--font-mono);
    font-weight: bold;
    color: var(--accent-primary);
    font-size: 1.1rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
    min-width: 0;
}

.text-replacement-type {
    font-size: 0.8rem;
    color: var(--badge-text);
    background: #834707e6;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    border: 1px solid #df8136;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: flex-end;
    gap: var(--spacing-xs);
    white-space: pre;
    text-transform: uppercase;
}

.text-replacement-type.random {
    background: #0b7abdc2;
    border-color: #2aafffe6;
}

.text-replacement-actions {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.text-replacement-content {
    margin-bottom: 0;
}

.text-replacement-value-container textarea,
.text-replacement-value-container input {
    width: 100%;
}


.text-replacement-array-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.text-replacement-array-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.text-replacement-array-item .remove-array-item {
    flex-shrink: 0;
    padding: 0.5rem;
    min-width: 2.5rem;
    height: -webkit-fill-available;
}

.text-replacement-item:not(.editing) .text-replacement-array-items .text-replacement-add-item,
.text-replacement-item:not(.editing) .text-replacement-array-items .remove-array-item {
    display: none;
}

.text-replacement-add-item {
    margin-top: 0.5rem;
}

.text-replacement-add-item button {
    width: 100%;
    justify-content: center;
}

/* Create modal specific styles */
.text-replacement-array-item .character-prompt-textarea-container {
    width: 100%;
}

/* Simple display mode styling for text replacement values */
.text-replacement-value-display {
    padding: 6px 8px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid var(--glass-inset-bg-5);
    border-radius: var(--border-radius-md);
    display: flex;
    align-items: center;
    width: 100%;
}

.text-replacement-value-display .text-replacement-text {
    font-family: var(--font-mono);
    color: var(--text-primary);
    font-size: 0.9rem;
    line-height: 1.4;
    word-break: break-word;
    white-space: pre-wrap;
}

.text-replacement-array-item:last-child {
    margin-bottom: 0;
}

/* Ensure text replacement array items can position search highlights */
.text-replacement-array-item {
    position: relative;
}

.text-replacement-item.new-item {
    border-color: var(--accent-success);
    border-left: 4px solid var(--accent-success);
}

.text-replacement-empty {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    color: var(--text-muted);
    font-style: italic;
}

.text-replacement-empty i {
    margin-right: 0.5rem;
    opacity: 0.7;
}

/* Unavailable IE Badges */
.cache-badge.encoding.unavailable {
    opacity: 0.8;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 17px 0px #ffffff38;
}

.cache-badge.encoding.unavailable .badge-model,
.cache-badge.encoding.unavailable .badge-ie {
    color: rgba(255, 255, 255, 0.6);
}

/* Missing IE Dropdown Option */
.custom-dropdown-option.missing-ie {
    color: #d70000;
    font-weight: bold;
}

.custom-dropdown-option.missing-ie:hover {
    background: rgba(255, 107, 107, 0.3);
    color: #d70000;
}

.custom-dropdown-option.missing-ie i {
    margin-right: 6px;
}

.generating-effect {
    cursor: progress;
    background: linear-gradient(90deg, 
    rgb(255 40 40 / 66%), 
    rgb(255 181 60 / 66%), 
    rgb(165 255 116 / 68%), 
    rgb(91 236 255 / 69%), 
    rgb(126 137 255 / 72%), 
    rgb(165 90 255 / 72%), 
    rgb(255 64 185 / 66%), 
    rgb(255 40 40 / 66%)) 0% 0% / 1000% 100%;
    animation: rainbowShift 25s linear infinite;
}
/* Ensure generating effect overrides all disabled button styles */
.generating-effect:disabled.btn-primary, 
.generating-effect:hover.btn-primary {
    background: linear-gradient(90deg, 
    rgb(255 40 40 / 66%), 
    rgb(255 181 60 / 66%), 
    rgb(165 255 116 / 68%), 
    rgb(91 236 255 / 69%), 
    rgb(126 137 255 / 72%), 
    rgb(165 90 255 / 72%), 
    rgb(255 64 185 / 66%), 
    rgb(255 40 40 / 66%)) 0% 0% / 1000% 100%;
    animation: rainbowShift 25s linear infinite;
    opacity: 1 !important;
    cursor: not-allowed;
    transform: none;
    border-color: var(--primary-color) !important;
    color: #ffffff !important;
}

/* Rainbow animation for manualGenerateBtn when generating */
@keyframes rainbowShift {
    0% {
        background-position: 0% 50%;
    }
    100% {
        background-position: 200% 50%;
    }
}

/* Generate button hover popover */
.generate-button-popover {
    position: fixed;
    z-index: 10000;
    background: var(--glass-layer-4);
    border: 1px solid var(--glass-border-4);
    border-radius: 8px;
    box-shadow: var(--glass-shadow-4), 0 8px 32px rgba(0, 0, 0, 0.3);
    backdrop-filter: var(--glass-blur-4, none);
    color: var(--text-primary);
    font-size: 14px;
    min-width: 200px;
    pointer-events: none;
    animation: popoverFadeIn 0.2s ease-out;
}

.generate-button-popover .popover-content {
    padding: 12px 16px;
}

.generate-button-popover .popover-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-primary);
    font-size: 13px;
}

.generate-button-popover .popover-header i {
    color: var(--accent-primary);
    font-size: 12px;
}

.generate-button-popover .popover-body {
    text-align: center;
}

.generate-button-popover .counter-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--accent-primary);
    margin-bottom: 4px;
}

.generate-button-popover .counter-label {
    font-size: 12px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.generate-button-popover .popover-arrow {
    position: absolute;
    bottom: -6px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid var(--glass-layer-4);
}

.generate-button-popover .popover-arrow::before {
    content: '';
    position: absolute;
    bottom: 1px;
    left: -6px;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid var(--glass-border-4);
}

/* Arrow when popover is below button */
.generate-button-popover.below .popover-arrow {
    bottom: auto;
    top: -6px;
    border-top: none;
    border-bottom: 6px solid var(--glass-layer-4);
}

.generate-button-popover.below .popover-arrow::before {
    bottom: auto;
    top: 1px;
    border-top: none;
    border-bottom: 6px solid var(--glass-border-4);
}

@keyframes popoverFadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

html:not(.disable-blur) {
    /* Glass Blur Circles */
    --glass-blur-circle-0: blur(0.04px);
    --glass-blur-circle-1: blur(0.08px);
    --glass-blur-circle-2: blur(0.12px);
    --glass-blur-circle-3: blur(0.16px);
    --glass-blur-circle-4: blur(0.2px);
    --glass-blur-circle-5: blur(0.24px);
    
    /* Glass Blur Levels */
    --glass-blur-0: blur(0px);
    --glass-blur-1: blur(5px);
    --glass-blur-2: blur(10px);
    --glass-blur-3: blur(15px);
    --glass-blur-4: blur(20px);
    --glass-blur-5: blur(25px);
}

.justify-end {
    justify-content: flex-end;
}
.justify-center {
    justify-content: center;
}
.justify-start {
    justify-content: flex-start;
}

.auto-flex {
    flex: 1 0 auto;
}

/* Percentage Input Styles */
.percentage-input-container {
    position: relative;
    display: inline-block;
    min-height: 32px;
}

.percentage-input-container .form-control {
    position: relative;
    z-index: 2;
    background: transparent;
    border: none;
    outline: none;
    padding: 0;
    margin: 0;
    backdrop-filter: none;
    box-shadow: none;
    min-height: 0px;
    box-sizing: border-box;
    border-radius: 0;
    width: 100%;
    height: 100%;
}

.percentage-input-container input {
    border: none !important;
    flex: none;
    line-height: 0;
}

.percentage-input-container:focus-within .form-control {
    background: transparent;
    color: var(--text-primary);
}

.percentage-input-container:not(:focus-within) .form-control {
    color: transparent;
    caret-color: transparent;
}

.percentage-input-overlay {
    position: absolute;
    top: 0;
    display: inline-flex;
    align-items: center;
    pointer-events: none;
    z-index: 4;
    min-height: 0px;
    height: 100%;
}

.percentage-input-container:focus-within .percentage-input-overlay {
    display: none;
}

.percentage-input-container:not(:focus-within) .percentage-input-overlay {
    display: flex;
}

/* Ensure percentage input containers work properly within form groups */
.form-group .percentage-input-container {
    display: inline-block;
    width: auto;
}

.form-group .percentage-input-container .form-control {
    width: auto;
}


.percentage-input-container.hover-show.negative-value {
    color: #ff6666;
}

/* URL Preview Warning Section Styles */
.warning-section {
    margin-top: 1rem;
}

.warning-section .warning-message {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background-color: var(--status-warning-bg);
    border: 1px solid var(--status-warning-border);
    border-radius: 6px;
    color: var(--status-warning-text);
    font-size: 0.9rem;
    line-height: 1.4;
}

.warning-section .warning-message.info {
    background-color: var(--status-info-bg);
    border-color: var(--status-info-border);
    color: var(--status-info-text);
}

.warning-section .warning-message i {
    font-size: 1.1rem;
    margin-top: 0.1rem;
    flex-shrink: 0;
}

.warning-section .warning-message strong {
    font-weight: 600;
    margin-right: 0.25rem;
}

.main-menu-row .btn-primary, .main-menu-row .btn-secondary, .main-menu-row .btn-danger {
    font-weight: 300;
    font-variation-settings: "wght" 300;
}

/* Preview Animation Container */
.manual-preview-container {
    position: relative;
    overflow: hidden;
}

/* Stars Layer */
.preview-stars {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    opacity: 0;
    transition: opacity 0.25s ease-in-out;
}

.preview-star {
    position: absolute;
    width: 4px;
    height: 4px;
    background: #fff;
    border-radius: 50%;
    animation: previewTwinkle 4s infinite;
}

.preview-star:nth-child(odd) { animation-delay: 0s; }
.preview-star:nth-child(even) { animation-delay: 1.5s; }
.preview-star:nth-child(3n) { animation-delay: 0.75s; }
.preview-star:nth-child(4n) { animation-delay: 2.25s; }

@keyframes previewTwinkle {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.5); }
}

/* Star positions using percentages */
.preview-star:nth-child(1) { top: 10%; left: 15%; }
.preview-star:nth-child(2) { top: 20%; left: 85%; }
.preview-star:nth-child(3) { top: 30%; left: 25%; }
.preview-star:nth-child(4) { top: 40%; left: 75%; }
.preview-star:nth-child(5) { top: 50%; left: 10%; }
.preview-star:nth-child(6) { top: 60%; left: 90%; }
.preview-star:nth-child(7) { top: 70%; left: 35%; }
.preview-star:nth-child(8) { top: 80%; left: 65%; }
.preview-star:nth-child(9) { top: 15%; left: 50%; }
.preview-star:nth-child(10) { top: 25%; left: 5%; }
.preview-star:nth-child(11) { top: 35%; left: 95%; }
.preview-star:nth-child(12) { top: 45%; left: 45%; }
.preview-star:nth-child(13) { top: 55%; left: 20%; }
.preview-star:nth-child(14) { top: 65%; left: 80%; }
.preview-star:nth-child(15) { top: 75%; left: 30%; }
.preview-star:nth-child(16) { top: 85%; left: 70%; }
.preview-star:nth-child(17) { top: 5%; left: 40%; }
.preview-star:nth-child(18) { top: 90%; left: 15%; }
.preview-star:nth-child(19) { top: 95%; left: 55%; }
.preview-star:nth-child(20) { top: 8%; left: 70%; }
/* Additional 15 stars positioned at top, bottom, and edges */
.preview-star:nth-child(21) { top: 2%; left: 5%; }
.preview-star:nth-child(22) { top: 2%; left: 95%; }
.preview-star:nth-child(23) { top: 5%; left: 10%; }
.preview-star:nth-child(24) { top: 5%; left: 90%; }
.preview-star:nth-child(25) { top: 8%; left: 20%; }
.preview-star:nth-child(26) { top: 8%; left: 80%; }
.preview-star:nth-child(27) { top: 12%; left: 2%; }
.preview-star:nth-child(28) { top: 12%; left: 98%; }
.preview-star:nth-child(29) { top: 98%; left: 5%; }
.preview-star:nth-child(30) { top: 98%; left: 95%; }
.preview-star:nth-child(31) { top: 95%; left: 10%; }
.preview-star:nth-child(32) { top: 95%; left: 90%; }
.preview-star:nth-child(33) { top: 92%; left: 20%; }
.preview-star:nth-child(34) { top: 92%; left: 80%; }
.preview-star:nth-child(35) { top: 88%; left: 2%; }

/* Lines Layer */
.preview-lines-layer {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    cursor: progress;
}

.preview-lines-background {
    z-index: 0;
    pointer-events: none;
}

.preview-lines-foreground {
    z-index: 1;
}

.preview-line {
    position: absolute;
    bottom: -310px;
    width: 10px;
    height: 300px;
    background: rgba(255, 255, 255, 0.8);
    animation: previewRiseUp 1.5s linear infinite;
    opacity: 0;
    visibility: hidden;
}

.preview-lines-background .preview-line {
    background: var(--active-tab-bg, rgba(100, 150, 255, 1));
    width: 5px;
    height: 175px;
    box-shadow: 0 0 15px var(--active-tab-border, rgba(100, 150, 255, 0.8));
    animation: previewRiseUp 4s linear infinite;
}

.preview-lines-foreground .preview-line {
    background: var(--primary-color-light, rgba(255, 100, 150, 0.9));
}

/* Line positions using percentages */
.preview-line:nth-child(1) { left: 8%; animation-delay: 0s; }
.preview-line:nth-child(2) { left: 23%; animation-delay: 0.8s; }
.preview-line:nth-child(3) { left: 67%; animation-delay: 1.6s; }
.preview-line:nth-child(4) { left: 41%; animation-delay: 2.4s; }
.preview-line:nth-child(5) { left: 89%; animation-delay: 3.2s; }
.preview-line:nth-child(6) { left: 15%; animation-delay: 4s; }
.preview-line:nth-child(7) { left: 73%; animation-delay: 4.8s; }
.preview-line:nth-child(8) { left: 34%; animation-delay: 5.6s; }
.preview-line:nth-child(9) { left: 56%; animation-delay: 6.4s; }
.preview-line:nth-child(10) { left: 92%; animation-delay: 7.2s; }
.preview-line:nth-child(11) { left: 28%; animation-delay: 8s; }
.preview-line:nth-child(12) { left: 81%; animation-delay: 8.8s; }
.preview-line:nth-child(13) { left: 47%; animation-delay: 9.6s; }
.preview-line:nth-child(14) { left: 19%; animation-delay: 10.4s; }
.preview-line:nth-child(15) { left: 75%; animation-delay: 11.2s; }

/* Height variations using viewport units for responsive sizing */
.preview-line:nth-child(3n) { height: 110px; }
.preview-line:nth-child(5n) { height: 90px; }
.preview-line:nth-child(7n) { height: 130px; }
.preview-line:nth-child(11n) { height: 95px; }

/* Background lines - make them even more prominent */
.preview-lines-background .preview-line:nth-child(3n) { height: 140px; }
.preview-lines-background .preview-line:nth-child(5n) { height: 160px; }
.preview-lines-background .preview-line:nth-child(7n) { height: 130px; }
.preview-lines-background .preview-line:nth-child(11n) { height: 150px; }

@keyframes previewRiseUp {
    0% {
        transform: translateY(0);
        opacity: 0;
    }
    5% {
        opacity: 1;
    }
    95% {
        opacity: 1;
    }
    100% {
        transform: translateY(-100vh);
        opacity: 0;
    }
}

/* Animation states */
.preview-animation-active .preview-stars {
    opacity: 1;
}

/* Fade out animations */
.preview-fade-out .preview-line {
    animation-play-state: paused;
}

.preview-fade-out .preview-stars {
    transition: opacity 3s ease-out;
}

/* Container fade out animation */
.preview-lines-layer.fadeOut {
    animation: fadeOutContainer 0.8s ease-out forwards;
}

@keyframes fadeOutContainer {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}

/* Preset-specific elements that extend text-replacement structure */
.preset-details {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
    margin-top: var(--spacing-sm);
}

/* Ensure prompt preview text is properly ellipsized */
#presetList .text-replacement-text {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 6;
    -webkit-box-orient: vertical;
    word-break: break-word;
    white-space: pre;
}

.preset-model,
.preset-resolution,
.preset-workspace,
.preset-guidance,
.preset-steps {
    font-size: 0.8rem;
    color: var(--badge-text);
    background: var(--glass-layer-3);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    border: 1px solid var(--glass-border-3);
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.preset-icons {
    display: flex;
    gap: 0.3rem;
    margin-left: auto;
}

.preset-icons i {
    font-size: 0.9rem;
    color: var(--text-secondary);
    opacity: 1;
    min-width: 1.25rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}
#updatePresetWorkspaceDropdownBtn .workspace-option-content {
    justify-content: flex-start;
}
.preset-icons .uc-box {
    height: 10px;
    width: 10px;
    box-shadow: none !important;
}
.preset-icons .uc-boxes[data-uc-level="1"] .uc-box[data-level="1"],
.preset-icons .uc-boxes[data-uc-level="2"] .uc-box[data-level="1"],
.preset-icons .uc-boxes[data-uc-level="2"] .uc-box[data-level="2"],
.preset-icons .uc-boxes[data-uc-level="3"] .uc-box[data-level="1"],
.preset-icons .uc-boxes[data-uc-level="3"] .uc-box[data-level="2"],
.preset-icons .uc-boxes[data-uc-level="3"] .uc-box[data-level="3"] {
    background-color: var(--text-secondary);
}
div#customPresetDropdownMenu {
    max-height: min(80vh, 600px);
    min-width: min(425px, calc(100vw - 250px));
    max-width: 80vw;
}
span#customPresetSelected {
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 175px;
}

/* Banner Container */
.banner-container {
    position: fixed;
    top: env(safe-area-inset-top, 0);
    left: 0;
    right: 0;
    z-index: 1000000000;
    pointer-events: none;
    display: flex;
    flex-direction: column;
    gap: 1px;
    pointer-events: none;
}



/* Update Banner Styles - Uses same design as status banner */
.update-banner {
    width: 100%;
    height: 0;
    overflow: hidden;
    transition: height 0.3s ease;
    pointer-events: auto;
    /* Override toast positioning and styling */
    position: static;
    margin: 0;
    border-radius: 0;
    border: none;
    border-bottom: 1px solid var(--glass-border-2);
    box-shadow: none;
    transform: none;
    z-index: 1000000000;
}

@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
}

@supports not ((-webkit-touch-callout: none) or (hover: hover)) {
    .floating-bar-right:hover .main-menu-bar-overlay,
    .floating-bar-left:hover .main-menu-bar-overlay {
        opacity: 1;
    }    
    #main-controls-bar:hover .main-menu-bar-overlay .balanceDisplay {
        opacity: 1;
    }
}
@supports (-webkit-touch-callout: none) or (hover: hover) {
    .gallery-item {
        animation: none;
    }
    .gallery-item-overlay {
        opacity: 1;
        background: none;
        transition: none;
    }
    .gallery-item:hover .gallery-item-overlay {
        opacity: 1;
        background: transparent;
    }
    .gallery-item-info-container {
        opacity: 0;
    }
    .gallery-actions {
        opacity: 1;
    }
}

.pswp__custom-bottom-bar:has(.pswp__custom-bottom-bar) {
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: center;
    z-index: 11;
    pointer-events: none !important;
    opacity: 1;
    transition: opacity var(--transition-slow);
}
.pswp--zoomed-in .pswp__custom-bottom-bar:has(.pswp__custom-bottom-bar),
.pswp--zoomed-in .pswp__button--arrow--prev,
.pswp--zoomed-in .pswp__button--arrow--next {
    opacity: 0;
}

.pswp__custom-bottom-bar:has(.pswp__custom-bottom-bar) .pswp__custom-bottom-bar {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    gap: 8px;
    padding: var(--spacing-lg);
    margin-bottom: env(safe-area-inset-bottom);
    flex-wrap: wrap;
}

.pswp__custom-bottom-bar:has(.pswp__custom-bottom-bar) .pswp__custom-bottom-bar .pswp__button--custom {
    pointer-events: auto !important;
}

/* Logo Options Popup Styles */
#logoOptionsModal .modal-content {
    max-width: 450px;
    width: 90vw;
}

.logo-options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-md);
    padding-bottom: var(--spacing-md);
}

.anlas-subscription-section {
    display: flex;
    flex-direction: column;
    padding-top: var(--spacing-md);
    gap: var(--spacing-sm);
}

.anlas-subscription-value {
    font-family: 'Oxanium';
    line-height: 1;
    margin-bottom: -0.15em;
}



.price-list-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    width: 100%;
    gap: var(--spacing-sm);
}

.price-list-label {
    text-transform: uppercase;
    font-family: 'Kanit';
    font-size: 0.75em;
}

.price-list-fixed, 
.price-list-paid {
    line-height: 1;
    display: inline-flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-xs);
}

.balance-list {
    color: var(--glass-layer-5-opaque);
    border-color: #ffeaad3d;
    padding: var(--spacing-sm) var(--spacing-md);
}

.logo-options-row {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-sm);
}
.logo-options-grid .logo-option-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-lg);
    cursor: pointer;
    min-height: 100px;
    gap: var(--spacing-sm);
}

.logo-options-row .logo-option-btn {
    flex: 1 0 auto;
}

.logo-options-grid .logo-option-btn i {
    font-size: 1.25rem;
    margin-bottom: var(--spacing-xs);
}

.logo-options-grid .logo-option-btn span {
    font-size: 0.9rem;
    font-weight: 500;
    text-align: center;
}

.logo-options-row .logo-option-btn span {
    display: none;
}

.logo-options-grid #uploadBtn.logo-option-btn {
    grid-column: span 2;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    min-height: auto;
}
.logo-options-grid #uploadBtn.logo-option-btn i {
    margin-bottom: 0;
}

@media (max-width: 1024px) {
    
    .preset-details {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .preset-details .icons-row {
        align-self: flex-end;
    }
}
@media (max-width: 576px) {
    #maskBrushBtn > span,
    #maskEraserBtn > span,
    #clearMaskBtn > span {
        display: none;
    }
    #openGenEditorBtn,
    .pswp__button--reroll-edit-button,
    .hide-mobile {
        display: none;
    }
}
@media (min-width: 765px) and (max-width: 1024px) {
    .floating-bar-right::after {
        display: none;
    }
    .floating-bar-left::after {
        content: '';
        position: absolute;
        top: calc(-1 * calc(var(--spacing-xxl) + 50%));
        left: calc(-1 * var(--spacing-xxl));
        width: 100vw;
        height: calc(150% + calc(2 * var(--spacing-xxl)));
        background: linear-gradient(transparent, #000000b0);
        z-index: -1;
        pointer-events: none;
        mask-image: none;
    }
}
@media (max-width: 800px) {
    .menu-section.no-mobile {
        display: none;
    }
}

@media (max-width: 768px) {
    .character-prompt-preview {
        display: none;
    }
    button#manualGenerateBtn {
        min-width: 0;
    }
    .text-replacement-actions button {
        flex: 1 0 auto;
    } 
    .container {
        margin-top: calc(var(--menubar-height, 8.5em) + env(safe-area-inset-top, 0));
    }
    .floating-bar-top-left {
        display: none;
    }
    .editor-open .floating-bar-left,
    .initializing .floating-bar-left {
        left: 0;
        top: -800px;
    }
    .toast-container {
        top: calc(140px + env(safe-area-inset-top, 0)) !important;
        right: 0;
    }
    .toast-container .glass-toast {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
        border-right: none;
    }
    #main-menu-bar {
        flex-direction: column-reverse;
        align-items: center;
        bottom: unset;
        top: env(safe-area-inset-top, 0);
        width: calc(100% - calc(2 * var(--spacing-xxl)));
    }
    
    .mobile-only {
        display: flex;
    }
    .no-mobile {
        display: none!important;
    }
    
    .floating-bar-left.mobile-only {
        bottom: 0;
        top: unset;
        flex-direction: column;
        align-items: flex-start;
        width: auto;
    }
    
    #main-menu-bar::after {
        top: calc(-1 * calc(var(--spacing-xxl) + env(safe-area-inset-top, 0)));
        left: calc(-1 * var(--spacing-xxl));
        width: 100vw;
        height: calc(150% + env(safe-area-inset-top, 0));
        background: linear-gradient(0deg, transparent, #00000085, #000000de);
        mask-image: none;
    }
    @supports (padding-top: env(safe-area-inset-top)) {
        .floating-bar-left {
            margin-top: max(
                calc(var(--spacing-xxl) - env(safe-area-inset-top, 0)),
                calc(0px + var(--spacing-md))
            );
        }
    }

    .update-progress-container {
        display: none!important;
    }

    #workspaceDropdown.custom-dropdown.dropup .custom-dropdown-menu {
        position: fixed;
        top: env(safe-area-inset-top, 0);
        left: 50%;
        bottom: auto;
        font-size: 24px;
        margin-top: initial;
        width: calc(100% - var(--spacing-xxl));
        max-height: calc(max-content - var(--spacing-xxl));
        transform: translateX(-50%);
    }
    #workspaceDropdown .custom-dropdown-option {
        justify-content: center;
    }
    #workspaceDropdown .workspace-option-content {
        max-width: 350px;
    }
    #workspaceDropdown .workspace-color-indicator {
        width: 20px;
        height: 20px;
    }

    .manual-modal-content {
        margin: 2% auto;
        width: 95%;
    }
    
    /* Stack all form rows on mobile */
    .form-row {
        gap: 15px;
    }
    
    .resolution-group .form-control,
    .seed-input-group .form-control {
        width: 100%;
    }
    
    .form-actions {
        flex-wrap: nowrap;
        align-items: center;
    }
    
    .form-actions button {
        max-width: 200px;
    }

    /* Mobile-specific manualPresetToggleBtn - always show icon, never show text */
    #manualPresetToggleBtn {
        justify-content: center !important;
    }
    
    #manualPresetToggleBtn #manualPresetToggleText {
        display: none !important;
    }
    
    #manualPresetToggleBtn #manualPresetToggleIcon {
        display: inline-block !important;
        margin: 0 !important;
        font-size: 1.2em !important;
    }

    /* Mobile-specific fileSearchAutofill - drop down instead of drop up */
    #fileSearchAutofill {
        position: fixed;
        z-index: 1000;
        overflow: hidden;
        transition: all 0.2s ease;
        min-width: 300px;
        max-width: 400px;
        max-height: 80vh;
    }
    
    #fileSearchAutofill .character-autocomplete-list {
        /* Ensure proper mobile layout */
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: var(--glass-border-2) transparent;
        flex-direction: column;
    }
    
    /* Mobile touch improvements */
    #fileSearchAutofill .character-autocomplete-item {
        min-height: 44px; /* Touch-friendly minimum height */
        padding: 0.5em 0.8em;
    }

    #fileSearchAutofill .character-autocomplete-list {
        flex-direction: column!important;
    }
    
    #fileSearchAutofillList .character-autocomplete-item.more-indicator {
        order: unset!important;
    }
    #fileSearchAutofillList .character-autocomplete-item.search-status-display  {
        order: unset!important;
    }
    #fileSearchAutofillList .preview-images-section {
        order: unset!important;
    }
    .file-search-input {
        width: min(800px, calc(100vw - 250px));
        font-size: 13px;
    }
    .preset-option-row-2 {
        justify-content: space-between;
        align-items: flex-start;
        flex-direction: column;
    }
    .text-replacement-header {
        align-items: center;
        flex-wrap: wrap;
        justify-content: flex-start;
        gap: var(--spacing-md);
    }
    .text-replacement-actions {
        width: 100%;
        justify-content: space-between;
        flex-wrap: wrap;
    }
}

@media (max-width: 480px) {
    #manageButtonGroup, #uploadBtn {
        display: none;
    }
    #sortOrderToggleBtn {
        display: none;
    }
    #mobileSortOrderToggleBtn {
        display: inline-block;
    }
    .logo-options-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-md);
        padding: var(--spacing-md) 0;
    }
    .logo-options-row .logo-option-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-lg);
        cursor: pointer;
        min-height: 100px;
        gap: var(--spacing-sm);
    }
    
    .logo-options-row .logo-option-btn i {
        font-size: 1.25rem;
        margin-bottom: 0
    }
    
    .logo-options-row .logo-option-btn span {
        font-size: 0.9rem;
        font-weight: 500;
        text-align: center;
        display: inline-block;
    }
    .manual-modal-content {
        margin: 1% auto;
    }
    
    .form-group label {
        font-size: 0.9rem;
    }

    .container {
        padding: calc(var(--spacing-xl) + env(safe-area-inset-top, 0)) 0 calc(var(--spacing-xl) + env(safe-area-inset-bottom, 0)) 0;
    }
    .gallery {
        flex-direction: column;
        display: flex;
        justify-content: flex-start;
        flex-wrap: nowrap;
        gap: 0px;
    }
    .gallery-item, 
    .gallery-placeholder {
        border-radius: 0;
        border-left: none;
        border-right: none;
        border-top: none;
        border-bottom: 3px solid black;
        min-height: min(100vw, 100vh);
        max-height: min(100vw, 100vh);
    }
    .gallery-toolbar-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-lg);
        padding: var(--spacing-sm);
    }
    .gallery-item .gallery-actions {
        width: auto;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        align-items: flex-end;
        justify-content: flex-start;
    }
    .gallery-item .gallery-actions button {
        background: transparent;
        border: none;
        box-shadow: none;
        border-radius: 0;
    }
    .gallery-item .gallery-actions button i {
        filter: drop-shadow(0px 0px 2px black);
    }
}

/* iOS-specific infinite scroll fixes */
@supports (-webkit-touch-callout: none) or (hover: hover) {
}

/* Rules for hiding elements and overrides, this must be located at the end of the stylesheet always and no other rules should come after this */
.hidden {
    display: none !important;
    animation-play-state: paused !important;
}

@media (min-width: 769px) {
    #title-bar.hidden {
        display: flex!important;
        animation-play-state: running!important;
        opacity: 0!important;
    }
}